<!doctype html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link href=https://docs.openssl.org/master/man7/ossl-guide-tls-client-block/ rel=canonical><link href=../ossl-guide-quic-multi-stream/ rel=prev><link href=../ossl-guide-tls-client-non-block/ rel=next><link rel=icon href=../../images/favicon.ico><meta name=generator content="mkdocs-1.6.0, mkdocs-material-9.5.27"><title>ossl-guide-tls-client-block - OpenSSL Documentation</title><link rel=stylesheet href=../../assets/stylesheets/main.6543a935.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../stylesheets/extra.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>
  function __md_analytics() {

    var script = document.createElement("script")
    script.async = true
    script.src = "https://api.transpond.io/tracker?am=MzgyOTE%3D"

    var container = document.getElementById("__analytics")
    container.insertAdjacentElement("afterEnd", script)

  }
</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script></head><body dir=ltr data-md-color-scheme=openssl data-md-color-primary=indigo data-md-color-accent=indigo><input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off><input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off><label class=md-overlay for=__drawer></label><div data-md-component=skip><a href=#ossl-guide-tls-client-block class=md-skip> Skip to content </a></div><div data-md-component=announce></div><div data-md-color-scheme=default data-md-component=outdated hidden></div><header class="md-header md-header--shadow md-header--lifted" data-md-component=header><nav class="md-header__inner md-grid" aria-label=Header><a href=../.. title="OpenSSL Documentation" class="md-header__button md-logo" aria-label="OpenSSL Documentation" data-md-component=logo><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg></a><label class="md-header__button md-icon" for=__drawer><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg></label><div class=md-header__title data-md-component=header-title><div class=md-header__ellipsis><div class=md-header__topic><span class=md-ellipsis> OpenSSL Documentation </span></div><div class=md-header__topic data-md-component=header-topic><span class=md-ellipsis> ossl-guide-tls-client-block </span></div></div></div><form class=md-header__option data-md-component=palette><input class=md-option data-md-color-media data-md-color-scheme=openssl data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0><label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg></label><input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=black data-md-color-accent=light-blue aria-label="Switch to light mode" type=radio name=__palette id=__palette_1><label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg></label></form><script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script><label class="md-header__button md-icon" for=__search><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg></label><div class=md-search data-md-component=search role=dialog><label class=md-search__overlay for=__search></label><div class=md-search__inner role=search><form class=md-search__form name=search><input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required><label class="md-search__icon md-icon" for=__search><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg></label><nav class=md-search__options aria-label=Search><button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg></button></nav><div class=md-search__suggest data-md-component=search-suggest></div></form><div class=md-search__output><div class=md-search__scrollwrap tabindex=0 data-md-scrollfix><div class=md-search-result data-md-component=search-result><div class=md-search-result__meta> Initializing search </div><ol class=md-search-result__list role=presentation></ol></div></div></div></div></div><div class=md-header__source><a href=https://github.com/openssl/openssl title="Go to repository" class=md-source data-md-component=source><div class="md-source__icon md-icon"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg></div><div class=md-source__repository> GitHub </div></a></div></nav><nav class=md-tabs aria-label=Tabs data-md-component=tabs><div class=md-grid><ul class=md-tabs__list><li class=md-tabs__item><a href=../.. class=md-tabs__link> Home </a></li><li class=md-tabs__item><a href=../../fips/ class=md-tabs__link> FIPS-140 </a></li><li class=md-tabs__item><a href=../../man1/ class=md-tabs__link> Commands </a></li><li class=md-tabs__item><a href=../../man3/ class=md-tabs__link> Libraries </a></li><li class=md-tabs__item><a href=../../man5/ class=md-tabs__link> File Formats </a></li><li class="md-tabs__item md-tabs__item--active"><a href=../ class=md-tabs__link> Overviews </a></li></ul></div></nav></header><div class=md-container data-md-component=container><main class=md-main data-md-component=main><div class="md-main__inner md-grid"><div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation><div class=md-sidebar__scrollwrap><div class=md-sidebar__inner><nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0><label class=md-nav__title for=__drawer><a href=../.. title="OpenSSL Documentation" class="md-nav__button md-logo" aria-label="OpenSSL Documentation" data-md-component=logo><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg></a> OpenSSL Documentation </label><div class=md-nav__source><a href=https://github.com/openssl/openssl title="Go to repository" class=md-source data-md-component=source><div class="md-source__icon md-icon"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg></div><div class=md-source__repository> GitHub </div></a></div><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a href=../.. class=md-nav__link title=Home><span class=md-ellipsis-custom> Home </span></a></li><li class=md-nav__item><a href=../../fips/ class=md-nav__link title=FIPS-140><span class=md-ellipsis-custom> FIPS-140 </span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a href=../../man1/ class=md-nav__link><span class=md-ellipsis-custom> Commands </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a href=../../man3/ class=md-nav__link><span class=md-ellipsis-custom> Libraries </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a href=../../man5/ class=md-nav__link><span class=md-ellipsis-custom> File Formats </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6 checked><div class="md-nav__link md-nav__container"><a href=../ class="md-nav__link "><span class=md-ellipsis-custom> Overviews </span></a><label class="md-nav__link " for=__nav_6 id=__nav_6_label tabindex><span class="md-nav__icon md-icon"></span></label></div><nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=true><label class=md-nav__title for=__nav_6><span class="md-nav__icon md-icon"></span> Overviews </label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a href=../EVP_ASYM_CIPHER-RSA/ class=md-nav__link title=EVP_ASYM_CIPHER-RSA><span class=md-ellipsis-custom> EVP_ASYM_CIPHER-RSA </span></a></li><li class=md-nav__item><a href=../EVP_ASYM_CIPHER-SM2/ class=md-nav__link title=EVP_ASYM_CIPHER-SM2><span class=md-ellipsis-custom> EVP_ASYM_CIPHER-SM2 </span></a></li><li class=md-nav__item><a href=../EVP_CIPHER-AES/ class=md-nav__link title=EVP_CIPHER-AES><span class=md-ellipsis-custom> EVP_CIPHER-AES </span></a></li><li class=md-nav__item><a href=../EVP_CIPHER-ARIA/ class=md-nav__link title=EVP_CIPHER-ARIA><span class=md-ellipsis-custom> EVP_CIPHER-ARIA </span></a></li><li class=md-nav__item><a href=../EVP_CIPHER-BLOWFISH/ class=md-nav__link title=EVP_CIPHER-BLOWFISH><span class=md-ellipsis-custom> EVP_CIPHER-BLOWFISH </span></a></li><li class=md-nav__item><a href=../EVP_CIPHER-CAMELLIA/ class=md-nav__link title=EVP_CIPHER-CAMELLIA><span class=md-ellipsis-custom> EVP_CIPHER-CAMELLIA </span></a></li><li class=md-nav__item><a href=../EVP_CIPHER-CAST/ class=md-nav__link title=EVP_CIPHER-CAST><span class=md-ellipsis-custom> EVP_CIPHER-CAST </span></a></li><li class=md-nav__item><a href=../EVP_CIPHER-CHACHA/ class=md-nav__link title=EVP_CIPHER-CHACHA><span class=md-ellipsis-custom> EVP_CIPHER-CHACHA </span></a></li><li class=md-nav__item><a href=../EVP_CIPHER-DES/ class=md-nav__link title=EVP_CIPHER-DES><span class=md-ellipsis-custom> EVP_CIPHER-DES </span></a></li><li class=md-nav__item><a href=../EVP_CIPHER-IDEA/ class=md-nav__link title=EVP_CIPHER-IDEA><span class=md-ellipsis-custom> EVP_CIPHER-IDEA </span></a></li><li class=md-nav__item><a href=../EVP_CIPHER-NULL/ class=md-nav__link title=EVP_CIPHER-NULL><span class=md-ellipsis-custom> EVP_CIPHER-NULL </span></a></li><li class=md-nav__item><a href=../EVP_CIPHER-RC2/ class=md-nav__link title=EVP_CIPHER-RC2><span class=md-ellipsis-custom> EVP_CIPHER-RC2 </span></a></li><li class=md-nav__item><a href=../EVP_CIPHER-RC4/ class=md-nav__link title=EVP_CIPHER-RC4><span class=md-ellipsis-custom> EVP_CIPHER-RC4 </span></a></li><li class=md-nav__item><a href=../EVP_CIPHER-RC5/ class=md-nav__link title=EVP_CIPHER-RC5><span class=md-ellipsis-custom> EVP_CIPHER-RC5 </span></a></li><li class=md-nav__item><a href=../EVP_CIPHER-SEED/ class=md-nav__link title=EVP_CIPHER-SEED><span class=md-ellipsis-custom> EVP_CIPHER-SEED </span></a></li><li class=md-nav__item><a href=../EVP_CIPHER-SM4/ class=md-nav__link title=EVP_CIPHER-SM4><span class=md-ellipsis-custom> EVP_CIPHER-SM4 </span></a></li><li class=md-nav__item><a href=../EVP_KDF-ARGON2/ class=md-nav__link title=EVP_KDF-ARGON2><span class=md-ellipsis-custom> EVP_KDF-ARGON2 </span></a></li><li class=md-nav__item><a href=../EVP_KDF-HKDF/ class=md-nav__link title=EVP_KDF-HKDF><span class=md-ellipsis-custom> EVP_KDF-HKDF </span></a></li><li class=md-nav__item><a href=../EVP_KDF-HMAC-DRBG/ class=md-nav__link title=EVP_KDF-HMAC-DRBG><span class=md-ellipsis-custom> EVP_KDF-HMAC-DRBG </span></a></li><li class=md-nav__item><a href=../EVP_KDF-KB/ class=md-nav__link title=EVP_KDF-KB><span class=md-ellipsis-custom> EVP_KDF-KB </span></a></li><li class=md-nav__item><a href=../EVP_KDF-KRB5KDF/ class=md-nav__link title=EVP_KDF-KRB5KDF><span class=md-ellipsis-custom> EVP_KDF-KRB5KDF </span></a></li><li class=md-nav__item><a href=../EVP_KDF-PBKDF1/ class=md-nav__link title=EVP_KDF-PBKDF1><span class=md-ellipsis-custom> EVP_KDF-PBKDF1 </span></a></li><li class=md-nav__item><a href=../EVP_KDF-PBKDF2/ class=md-nav__link title=EVP_KDF-PBKDF2><span class=md-ellipsis-custom> EVP_KDF-PBKDF2 </span></a></li><li class=md-nav__item><a href=../EVP_KDF-PKCS12KDF/ class=md-nav__link title=EVP_KDF-PKCS12KDF><span class=md-ellipsis-custom> EVP_KDF-PKCS12KDF </span></a></li><li class=md-nav__item><a href=../EVP_KDF-PVKKDF/ class=md-nav__link title=EVP_KDF-PVKKDF><span class=md-ellipsis-custom> EVP_KDF-PVKKDF </span></a></li><li class=md-nav__item><a href=../EVP_KDF-SCRYPT/ class=md-nav__link title=EVP_KDF-SCRYPT><span class=md-ellipsis-custom> EVP_KDF-SCRYPT </span></a></li><li class=md-nav__item><a href=../EVP_KDF-SS/ class=md-nav__link title=EVP_KDF-SS><span class=md-ellipsis-custom> EVP_KDF-SS </span></a></li><li class=md-nav__item><a href=../EVP_KDF-SSHKDF/ class=md-nav__link title=EVP_KDF-SSHKDF><span class=md-ellipsis-custom> EVP_KDF-SSHKDF </span></a></li><li class=md-nav__item><a href=../EVP_KDF-TLS13_KDF/ class=md-nav__link title=EVP_KDF-TLS13_KDF><span class=md-ellipsis-custom> EVP_KDF-TLS13_KDF </span></a></li><li class=md-nav__item><a href=../EVP_KDF-TLS1_PRF/ class=md-nav__link title=EVP_KDF-TLS1_PRF><span class=md-ellipsis-custom> EVP_KDF-TLS1_PRF </span></a></li><li class=md-nav__item><a href=../EVP_KDF-X942-ASN1/ class=md-nav__link title=EVP_KDF-X942-ASN1><span class=md-ellipsis-custom> EVP_KDF-X942-ASN1 </span></a></li><li class=md-nav__item><a href=../EVP_KDF-X942-CONCAT/ class=md-nav__link title=EVP_KDF-X942-CONCAT><span class=md-ellipsis-custom> EVP_KDF-X942-CONCAT </span></a></li><li class=md-nav__item><a href=../EVP_KDF-X963/ class=md-nav__link title=EVP_KDF-X963><span class=md-ellipsis-custom> EVP_KDF-X963 </span></a></li><li class=md-nav__item><a href=../EVP_KEM-EC/ class=md-nav__link title=EVP_KEM-EC><span class=md-ellipsis-custom> EVP_KEM-EC </span></a></li><li class=md-nav__item><a href=../EVP_KEM-ML-KEM/ class=md-nav__link title=EVP_KEM-ML-KEM><span class=md-ellipsis-custom> EVP_KEM-ML-KEM </span></a></li><li class=md-nav__item><a href=../EVP_KEM-ML-KEM class=md-nav__link title=EVP_KEM-ML-KEM-1024><span class=md-ellipsis-custom> EVP_KEM-ML-KEM-1024 </span></a></li><li class=md-nav__item><a href=../EVP_KEM-ML-KEM class=md-nav__link title=EVP_KEM-ML-KEM-512><span class=md-ellipsis-custom> EVP_KEM-ML-KEM-512 </span></a></li><li class=md-nav__item><a href=../EVP_KEM-ML-KEM class=md-nav__link title=EVP_KEM-ML-KEM-768><span class=md-ellipsis-custom> EVP_KEM-ML-KEM-768 </span></a></li><li class=md-nav__item><a href=../EVP_KEM-RSA/ class=md-nav__link title=EVP_KEM-RSA><span class=md-ellipsis-custom> EVP_KEM-RSA </span></a></li><li class=md-nav__item><a href=../EVP_KEM-X25519/ class=md-nav__link title=EVP_KEM-X25519><span class=md-ellipsis-custom> EVP_KEM-X25519 </span></a></li><li class=md-nav__item><a href=../EVP_KEM-X25519 class=md-nav__link title=EVP_KEM-X448><span class=md-ellipsis-custom> EVP_KEM-X448 </span></a></li><li class=md-nav__item><a href=../EVP_KEYEXCH-DH/ class=md-nav__link title=EVP_KEYEXCH-DH><span class=md-ellipsis-custom> EVP_KEYEXCH-DH </span></a></li><li class=md-nav__item><a href=../EVP_KEYEXCH-ECDH/ class=md-nav__link title=EVP_KEYEXCH-ECDH><span class=md-ellipsis-custom> EVP_KEYEXCH-ECDH </span></a></li><li class=md-nav__item><a href=../EVP_KEYEXCH-X25519/ class=md-nav__link title=EVP_KEYEXCH-X25519><span class=md-ellipsis-custom> EVP_KEYEXCH-X25519 </span></a></li><li class=md-nav__item><a href=../EVP_KEYEXCH-X25519 class=md-nav__link title=EVP_KEYEXCH-X448><span class=md-ellipsis-custom> EVP_KEYEXCH-X448 </span></a></li><li class=md-nav__item><a href=../EVP_PKEY-HMAC class=md-nav__link title=EVP_KEYMGMT-CMAC><span class=md-ellipsis-custom> EVP_KEYMGMT-CMAC </span></a></li><li class=md-nav__item><a href=../EVP_PKEY-DH class=md-nav__link title=EVP_KEYMGMT-DH><span class=md-ellipsis-custom> EVP_KEYMGMT-DH </span></a></li><li class=md-nav__item><a href=../EVP_PKEY-DH class=md-nav__link title=EVP_KEYMGMT-DHX><span class=md-ellipsis-custom> EVP_KEYMGMT-DHX </span></a></li><li class=md-nav__item><a href=../EVP_PKEY-DSA class=md-nav__link title=EVP_KEYMGMT-DSA><span class=md-ellipsis-custom> EVP_KEYMGMT-DSA </span></a></li><li class=md-nav__item><a href=../EVP_PKEY-EC class=md-nav__link title=EVP_KEYMGMT-EC><span class=md-ellipsis-custom> EVP_KEYMGMT-EC </span></a></li><li class=md-nav__item><a href=../EVP_PKEY-X25519 class=md-nav__link title=EVP_KEYMGMT-ED25519><span class=md-ellipsis-custom> EVP_KEYMGMT-ED25519 </span></a></li><li class=md-nav__item><a href=../EVP_PKEY-X25519 class=md-nav__link title=EVP_KEYMGMT-ED448><span class=md-ellipsis-custom> EVP_KEYMGMT-ED448 </span></a></li><li class=md-nav__item><a href=../EVP_PKEY-HMAC class=md-nav__link title=EVP_KEYMGMT-HMAC><span class=md-ellipsis-custom> EVP_KEYMGMT-HMAC </span></a></li><li class=md-nav__item><a href=../EVP_PKEY-ML-DSA class=md-nav__link title=EVP_KEYMGMT-ML-DSA><span class=md-ellipsis-custom> EVP_KEYMGMT-ML-DSA </span></a></li><li class=md-nav__item><a href=../EVP_PKEY-ML-KEM class=md-nav__link title=EVP_KEYMGMT-ML-KEM><span class=md-ellipsis-custom> EVP_KEYMGMT-ML-KEM </span></a></li><li class=md-nav__item><a href=../EVP_PKEY-ML-KEM class=md-nav__link title=EVP_KEYMGMT-ML-KEM-1024><span class=md-ellipsis-custom> EVP_KEYMGMT-ML-KEM-1024 </span></a></li><li class=md-nav__item><a href=../EVP_PKEY-ML-KEM class=md-nav__link title=EVP_KEYMGMT-ML-KEM-512><span class=md-ellipsis-custom> EVP_KEYMGMT-ML-KEM-512 </span></a></li><li class=md-nav__item><a href=../EVP_PKEY-ML-KEM class=md-nav__link title=EVP_KEYMGMT-ML-KEM-768><span class=md-ellipsis-custom> EVP_KEYMGMT-ML-KEM-768 </span></a></li><li class=md-nav__item><a href=../EVP_PKEY-HMAC class=md-nav__link title=EVP_KEYMGMT-Poly1305><span class=md-ellipsis-custom> EVP_KEYMGMT-Poly1305 </span></a></li><li class=md-nav__item><a href=../EVP_PKEY-RSA class=md-nav__link title=EVP_KEYMGMT-RSA><span class=md-ellipsis-custom> EVP_KEYMGMT-RSA </span></a></li><li class=md-nav__item><a href=../EVP_PKEY-SM2 class=md-nav__link title=EVP_KEYMGMT-SM2><span class=md-ellipsis-custom> EVP_KEYMGMT-SM2 </span></a></li><li class=md-nav__item><a href=../EVP_PKEY-HMAC class=md-nav__link title=EVP_KEYMGMT-Siphash><span class=md-ellipsis-custom> EVP_KEYMGMT-Siphash </span></a></li><li class=md-nav__item><a href=../EVP_PKEY-X25519 class=md-nav__link title=EVP_KEYMGMT-X25519><span class=md-ellipsis-custom> EVP_KEYMGMT-X25519 </span></a></li><li class=md-nav__item><a href=../EVP_PKEY-X25519 class=md-nav__link title=EVP_KEYMGMT-X448><span class=md-ellipsis-custom> EVP_KEYMGMT-X448 </span></a></li><li class=md-nav__item><a href=../EVP_MAC-BLAKE2/ class=md-nav__link title=EVP_MAC-BLAKE2><span class=md-ellipsis-custom> EVP_MAC-BLAKE2 </span></a></li><li class=md-nav__item><a href=../EVP_MAC-BLAKE2 class=md-nav__link title=EVP_MAC-BLAKE2BMAC><span class=md-ellipsis-custom> EVP_MAC-BLAKE2BMAC </span></a></li><li class=md-nav__item><a href=../EVP_MAC-BLAKE2 class=md-nav__link title=EVP_MAC-BLAKE2SMAC><span class=md-ellipsis-custom> EVP_MAC-BLAKE2SMAC </span></a></li><li class=md-nav__item><a href=../EVP_MAC-CMAC/ class=md-nav__link title=EVP_MAC-CMAC><span class=md-ellipsis-custom> EVP_MAC-CMAC </span></a></li><li class=md-nav__item><a href=../EVP_MAC-GMAC/ class=md-nav__link title=EVP_MAC-GMAC><span class=md-ellipsis-custom> EVP_MAC-GMAC </span></a></li><li class=md-nav__item><a href=../EVP_MAC-HMAC/ class=md-nav__link title=EVP_MAC-HMAC><span class=md-ellipsis-custom> EVP_MAC-HMAC </span></a></li><li class=md-nav__item><a href=../EVP_MAC-KMAC/ class=md-nav__link title=EVP_MAC-KMAC><span class=md-ellipsis-custom> EVP_MAC-KMAC </span></a></li><li class=md-nav__item><a href=../EVP_MAC-KMAC class=md-nav__link title=EVP_MAC-KMAC128><span class=md-ellipsis-custom> EVP_MAC-KMAC128 </span></a></li><li class=md-nav__item><a href=../EVP_MAC-KMAC class=md-nav__link title=EVP_MAC-KMAC256><span class=md-ellipsis-custom> EVP_MAC-KMAC256 </span></a></li><li class=md-nav__item><a href=../EVP_MAC-Poly1305/ class=md-nav__link title=EVP_MAC-Poly1305><span class=md-ellipsis-custom> EVP_MAC-Poly1305 </span></a></li><li class=md-nav__item><a href=../EVP_MAC-Siphash/ class=md-nav__link title=EVP_MAC-Siphash><span class=md-ellipsis-custom> EVP_MAC-Siphash </span></a></li><li class=md-nav__item><a href=../EVP_MD-BLAKE2/ class=md-nav__link title=EVP_MD-BLAKE2><span class=md-ellipsis-custom> EVP_MD-BLAKE2 </span></a></li><li class=md-nav__item><a href=../EVP_MD-KECCAK/ class=md-nav__link title=EVP_MD-KECCAK><span class=md-ellipsis-custom> EVP_MD-KECCAK </span></a></li><li class=md-nav__item><a href=../EVP_MD-SHAKE class=md-nav__link title=EVP_MD-KECCAK-KMAC><span class=md-ellipsis-custom> EVP_MD-KECCAK-KMAC </span></a></li><li class=md-nav__item><a href=../EVP_MD-MD2/ class=md-nav__link title=EVP_MD-MD2><span class=md-ellipsis-custom> EVP_MD-MD2 </span></a></li><li class=md-nav__item><a href=../EVP_MD-MD4/ class=md-nav__link title=EVP_MD-MD4><span class=md-ellipsis-custom> EVP_MD-MD4 </span></a></li><li class=md-nav__item><a href=../EVP_MD-MD5/ class=md-nav__link title=EVP_MD-MD5><span class=md-ellipsis-custom> EVP_MD-MD5 </span></a></li><li class=md-nav__item><a href=../EVP_MD-MD5-SHA1/ class=md-nav__link title=EVP_MD-MD5-SHA1><span class=md-ellipsis-custom> EVP_MD-MD5-SHA1 </span></a></li><li class=md-nav__item><a href=../EVP_MD-MDC2/ class=md-nav__link title=EVP_MD-MDC2><span class=md-ellipsis-custom> EVP_MD-MDC2 </span></a></li><li class=md-nav__item><a href=../EVP_MD-NULL/ class=md-nav__link title=EVP_MD-NULL><span class=md-ellipsis-custom> EVP_MD-NULL </span></a></li><li class=md-nav__item><a href=../EVP_MD-RIPEMD160/ class=md-nav__link title=EVP_MD-RIPEMD160><span class=md-ellipsis-custom> EVP_MD-RIPEMD160 </span></a></li><li class=md-nav__item><a href=../EVP_MD-SHA1/ class=md-nav__link title=EVP_MD-SHA1><span class=md-ellipsis-custom> EVP_MD-SHA1 </span></a></li><li class=md-nav__item><a href=../EVP_MD-SHA2/ class=md-nav__link title=EVP_MD-SHA2><span class=md-ellipsis-custom> EVP_MD-SHA2 </span></a></li><li class=md-nav__item><a href=../EVP_MD-SHA3/ class=md-nav__link title=EVP_MD-SHA3><span class=md-ellipsis-custom> EVP_MD-SHA3 </span></a></li><li class=md-nav__item><a href=../EVP_MD-SHAKE/ class=md-nav__link title=EVP_MD-SHAKE><span class=md-ellipsis-custom> EVP_MD-SHAKE </span></a></li><li class=md-nav__item><a href=../EVP_MD-SM3/ class=md-nav__link title=EVP_MD-SM3><span class=md-ellipsis-custom> EVP_MD-SM3 </span></a></li><li class=md-nav__item><a href=../EVP_MD-WHIRLPOOL/ class=md-nav__link title=EVP_MD-WHIRLPOOL><span class=md-ellipsis-custom> EVP_MD-WHIRLPOOL </span></a></li><li class=md-nav__item><a href=../EVP_MD-common/ class=md-nav__link title=EVP_MD-common><span class=md-ellipsis-custom> EVP_MD-common </span></a></li><li class=md-nav__item><a href=../EVP_PKEY-HMAC class=md-nav__link title=EVP_PKEY-CMAC><span class=md-ellipsis-custom> EVP_PKEY-CMAC </span></a></li><li class=md-nav__item><a href=../EVP_PKEY-DH/ class=md-nav__link title=EVP_PKEY-DH><span class=md-ellipsis-custom> EVP_PKEY-DH </span></a></li><li class=md-nav__item><a href=../EVP_PKEY-DH class=md-nav__link title=EVP_PKEY-DHX><span class=md-ellipsis-custom> EVP_PKEY-DHX </span></a></li><li class=md-nav__item><a href=../EVP_PKEY-DSA/ class=md-nav__link title=EVP_PKEY-DSA><span class=md-ellipsis-custom> EVP_PKEY-DSA </span></a></li><li class=md-nav__item><a href=../EVP_PKEY-EC/ class=md-nav__link title=EVP_PKEY-EC><span class=md-ellipsis-custom> EVP_PKEY-EC </span></a></li><li class=md-nav__item><a href=../EVP_PKEY-X25519 class=md-nav__link title=EVP_PKEY-ED25519><span class=md-ellipsis-custom> EVP_PKEY-ED25519 </span></a></li><li class=md-nav__item><a href=../EVP_PKEY-X25519 class=md-nav__link title=EVP_PKEY-ED448><span class=md-ellipsis-custom> EVP_PKEY-ED448 </span></a></li><li class=md-nav__item><a href=../EVP_PKEY-FFC/ class=md-nav__link title=EVP_PKEY-FFC><span class=md-ellipsis-custom> EVP_PKEY-FFC </span></a></li><li class=md-nav__item><a href=../EVP_PKEY-HMAC/ class=md-nav__link title=EVP_PKEY-HMAC><span class=md-ellipsis-custom> EVP_PKEY-HMAC </span></a></li><li class=md-nav__item><a href=../EVP_PKEY-ML-DSA/ class=md-nav__link title=EVP_PKEY-ML-DSA><span class=md-ellipsis-custom> EVP_PKEY-ML-DSA </span></a></li><li class=md-nav__item><a href=../EVP_PKEY-ML-DSA class=md-nav__link title=EVP_PKEY-ML-DSA-44><span class=md-ellipsis-custom> EVP_PKEY-ML-DSA-44 </span></a></li><li class=md-nav__item><a href=../EVP_PKEY-ML-DSA class=md-nav__link title=EVP_PKEY-ML-DSA-65><span class=md-ellipsis-custom> EVP_PKEY-ML-DSA-65 </span></a></li><li class=md-nav__item><a href=../EVP_PKEY-ML-DSA class=md-nav__link title=EVP_PKEY-ML-DSA-87><span class=md-ellipsis-custom> EVP_PKEY-ML-DSA-87 </span></a></li><li class=md-nav__item><a href=../EVP_PKEY-ML-KEM/ class=md-nav__link title=EVP_PKEY-ML-KEM><span class=md-ellipsis-custom> EVP_PKEY-ML-KEM </span></a></li><li class=md-nav__item><a href=../EVP_PKEY-ML-KEM class=md-nav__link title=EVP_PKEY-ML-KEM-1024><span class=md-ellipsis-custom> EVP_PKEY-ML-KEM-1024 </span></a></li><li class=md-nav__item><a href=../EVP_PKEY-ML-KEM class=md-nav__link title=EVP_PKEY-ML-KEM-512><span class=md-ellipsis-custom> EVP_PKEY-ML-KEM-512 </span></a></li><li class=md-nav__item><a href=../EVP_PKEY-ML-KEM class=md-nav__link title=EVP_PKEY-ML-KEM-768><span class=md-ellipsis-custom> EVP_PKEY-ML-KEM-768 </span></a></li><li class=md-nav__item><a href=../EVP_PKEY-HMAC class=md-nav__link title=EVP_PKEY-Poly1305><span class=md-ellipsis-custom> EVP_PKEY-Poly1305 </span></a></li><li class=md-nav__item><a href=../EVP_PKEY-RSA/ class=md-nav__link title=EVP_PKEY-RSA><span class=md-ellipsis-custom> EVP_PKEY-RSA </span></a></li><li class=md-nav__item><a href=../EVP_PKEY-SM2/ class=md-nav__link title=EVP_PKEY-SM2><span class=md-ellipsis-custom> EVP_PKEY-SM2 </span></a></li><li class=md-nav__item><a href=../EVP_PKEY-HMAC class=md-nav__link title=EVP_PKEY-Siphash><span class=md-ellipsis-custom> EVP_PKEY-Siphash </span></a></li><li class=md-nav__item><a href=../EVP_PKEY-X25519/ class=md-nav__link title=EVP_PKEY-X25519><span class=md-ellipsis-custom> EVP_PKEY-X25519 </span></a></li><li class=md-nav__item><a href=../EVP_PKEY-X25519 class=md-nav__link title=EVP_PKEY-X448><span class=md-ellipsis-custom> EVP_PKEY-X448 </span></a></li><li class=md-nav__item><a href=../EVP_RAND/ class=md-nav__link title=EVP_RAND><span class=md-ellipsis-custom> EVP_RAND </span></a></li><li class=md-nav__item><a href=../EVP_RAND-CRNG-TEST/ class=md-nav__link title=EVP_RAND-CRNG-TEST><span class=md-ellipsis-custom> EVP_RAND-CRNG-TEST </span></a></li><li class=md-nav__item><a href=../EVP_RAND-CTR-DRBG/ class=md-nav__link title=EVP_RAND-CTR-DRBG><span class=md-ellipsis-custom> EVP_RAND-CTR-DRBG </span></a></li><li class=md-nav__item><a href=../EVP_RAND-HASH-DRBG/ class=md-nav__link title=EVP_RAND-HASH-DRBG><span class=md-ellipsis-custom> EVP_RAND-HASH-DRBG </span></a></li><li class=md-nav__item><a href=../EVP_RAND-HMAC-DRBG/ class=md-nav__link title=EVP_RAND-HMAC-DRBG><span class=md-ellipsis-custom> EVP_RAND-HMAC-DRBG </span></a></li><li class=md-nav__item><a href=../EVP_RAND-JITTER/ class=md-nav__link title=EVP_RAND-JITTER><span class=md-ellipsis-custom> EVP_RAND-JITTER </span></a></li><li class=md-nav__item><a href=../EVP_RAND-SEED-SRC/ class=md-nav__link title=EVP_RAND-SEED-SRC><span class=md-ellipsis-custom> EVP_RAND-SEED-SRC </span></a></li><li class=md-nav__item><a href=../EVP_RAND-TEST-RAND/ class=md-nav__link title=EVP_RAND-TEST-RAND><span class=md-ellipsis-custom> EVP_RAND-TEST-RAND </span></a></li><li class=md-nav__item><a href=../EVP_SIGNATURE-HMAC class=md-nav__link title=EVP_SIGNATURE-CMAC><span class=md-ellipsis-custom> EVP_SIGNATURE-CMAC </span></a></li><li class=md-nav__item><a href=../EVP_SIGNATURE-DSA/ class=md-nav__link title=EVP_SIGNATURE-DSA><span class=md-ellipsis-custom> EVP_SIGNATURE-DSA </span></a></li><li class=md-nav__item><a href=../EVP_SIGNATURE-ECDSA/ class=md-nav__link title=EVP_SIGNATURE-ECDSA><span class=md-ellipsis-custom> EVP_SIGNATURE-ECDSA </span></a></li><li class=md-nav__item><a href=../EVP_SIGNATURE-ED25519/ class=md-nav__link title=EVP_SIGNATURE-ED25519><span class=md-ellipsis-custom> EVP_SIGNATURE-ED25519 </span></a></li><li class=md-nav__item><a href=../EVP_SIGNATURE-ED25519 class=md-nav__link title=EVP_SIGNATURE-ED448><span class=md-ellipsis-custom> EVP_SIGNATURE-ED448 </span></a></li><li class=md-nav__item><a href=../EVP_SIGNATURE-HMAC/ class=md-nav__link title=EVP_SIGNATURE-HMAC><span class=md-ellipsis-custom> EVP_SIGNATURE-HMAC </span></a></li><li class=md-nav__item><a href=../EVP_SIGNATURE-ML-DSA/ class=md-nav__link title=EVP_SIGNATURE-ML-DSA><span class=md-ellipsis-custom> EVP_SIGNATURE-ML-DSA </span></a></li><li class=md-nav__item><a href=../EVP_SIGNATURE-ML-DSA class=md-nav__link title=EVP_SIGNATURE-ML-DSA-44><span class=md-ellipsis-custom> EVP_SIGNATURE-ML-DSA-44 </span></a></li><li class=md-nav__item><a href=../EVP_SIGNATURE-ML-DSA class=md-nav__link title=EVP_SIGNATURE-ML-DSA-65><span class=md-ellipsis-custom> EVP_SIGNATURE-ML-DSA-65 </span></a></li><li class=md-nav__item><a href=../EVP_SIGNATURE-ML-DSA class=md-nav__link title=EVP_SIGNATURE-ML-DSA-87><span class=md-ellipsis-custom> EVP_SIGNATURE-ML-DSA-87 </span></a></li><li class=md-nav__item><a href=../EVP_SIGNATURE-HMAC class=md-nav__link title=EVP_SIGNATURE-Poly1305><span class=md-ellipsis-custom> EVP_SIGNATURE-Poly1305 </span></a></li><li class=md-nav__item><a href=../EVP_SIGNATURE-RSA/ class=md-nav__link title=EVP_SIGNATURE-RSA><span class=md-ellipsis-custom> EVP_SIGNATURE-RSA </span></a></li><li class=md-nav__item><a href=../EVP_SIGNATURE-HMAC class=md-nav__link title=EVP_SIGNATURE-Siphash><span class=md-ellipsis-custom> EVP_SIGNATURE-Siphash </span></a></li><li class=md-nav__item><a href=../EVP_SIGNATURE-ED25519 class=md-nav__link title=Ed25519><span class=md-ellipsis-custom> Ed25519 </span></a></li><li class=md-nav__item><a href=../EVP_SIGNATURE-ED25519 class=md-nav__link title=Ed448><span class=md-ellipsis-custom> Ed448 </span></a></li><li class=md-nav__item><a href=../openssl_user_macros class=md-nav__link title=OPENSSL_API_COMPAT><span class=md-ellipsis-custom> OPENSSL_API_COMPAT </span></a></li><li class=md-nav__item><a href=../openssl_user_macros class=md-nav__link title=OPENSSL_NO_DEPRECATED><span class=md-ellipsis-custom> OPENSSL_NO_DEPRECATED </span></a></li><li class=md-nav__item><a href=../OSSL_PROVIDER-FIPS/ class=md-nav__link title=OSSL_PROVIDER-FIPS><span class=md-ellipsis-custom> OSSL_PROVIDER-FIPS </span></a></li><li class=md-nav__item><a href=../OSSL_PROVIDER-base/ class=md-nav__link title=OSSL_PROVIDER-base><span class=md-ellipsis-custom> OSSL_PROVIDER-base </span></a></li><li class=md-nav__item><a href=../OSSL_PROVIDER-default/ class=md-nav__link title=OSSL_PROVIDER-default><span class=md-ellipsis-custom> OSSL_PROVIDER-default </span></a></li><li class=md-nav__item><a href=../OSSL_PROVIDER-legacy/ class=md-nav__link title=OSSL_PROVIDER-legacy><span class=md-ellipsis-custom> OSSL_PROVIDER-legacy </span></a></li><li class=md-nav__item><a href=../OSSL_PROVIDER-null/ class=md-nav__link title=OSSL_PROVIDER-null><span class=md-ellipsis-custom> OSSL_PROVIDER-null </span></a></li><li class=md-nav__item><a href=../OSSL_STORE-winstore/ class=md-nav__link title=OSSL_STORE-winstore><span class=md-ellipsis-custom> OSSL_STORE-winstore </span></a></li><li class=md-nav__item><a href=../RAND/ class=md-nav__link title=RAND><span class=md-ellipsis-custom> RAND </span></a></li><li class=md-nav__item><a href=../EVP_PKEY-RSA class=md-nav__link title=RSA><span class=md-ellipsis-custom> RSA </span></a></li><li class=md-nav__item><a href=../RSA-PSS/ class=md-nav__link title=RSA-PSS><span class=md-ellipsis-custom> RSA-PSS </span></a></li><li class=md-nav__item><a href=../EVP_PKEY-SM2 class=md-nav__link title=SM2><span class=md-ellipsis-custom> SM2 </span></a></li><li class=md-nav__item><a href=../X25519/ class=md-nav__link title=X25519><span class=md-ellipsis-custom> X25519 </span></a></li><li class=md-nav__item><a href=../X25519 class=md-nav__link title=X448><span class=md-ellipsis-custom> X448 </span></a></li><li class=md-nav__item><a href=../bio/ class=md-nav__link title=bio><span class=md-ellipsis-custom> bio </span></a></li><li class=md-nav__item><a href=../ossl-guide-libcrypto-introduction class=md-nav__link title=crypto><span class=md-ellipsis-custom> crypto </span></a></li><li class=md-nav__item><a href=../ct/ class=md-nav__link title=ct><span class=md-ellipsis-custom> ct </span></a></li><li class=md-nav__item><a href=../des_modes/ class=md-nav__link title=des_modes><span class=md-ellipsis-custom> des_modes </span></a></li><li class=md-nav__item><a href=../evp/ class=md-nav__link title=evp><span class=md-ellipsis-custom> evp </span></a></li><li class=md-nav__item><a href=../fips_module/ class=md-nav__link title=fips_module><span class=md-ellipsis-custom> fips_module </span></a></li><li class=md-nav__item><a href=../life_cycle-cipher/ class=md-nav__link title=life_cycle-cipher><span class=md-ellipsis-custom> life_cycle-cipher </span></a></li><li class=md-nav__item><a href=../life_cycle-digest/ class=md-nav__link title=life_cycle-digest><span class=md-ellipsis-custom> life_cycle-digest </span></a></li><li class=md-nav__item><a href=../life_cycle-kdf/ class=md-nav__link title=life_cycle-kdf><span class=md-ellipsis-custom> life_cycle-kdf </span></a></li><li class=md-nav__item><a href=../life_cycle-mac/ class=md-nav__link title=life_cycle-mac><span class=md-ellipsis-custom> life_cycle-mac </span></a></li><li class=md-nav__item><a href=../life_cycle-pkey/ class=md-nav__link title=life_cycle-pkey><span class=md-ellipsis-custom> life_cycle-pkey </span></a></li><li class=md-nav__item><a href=../life_cycle-rand/ class=md-nav__link title=life_cycle-rand><span class=md-ellipsis-custom> life_cycle-rand </span></a></li><li class=md-nav__item><a href=../ossl-guide-migration class=md-nav__link title=migration_guide><span class=md-ellipsis-custom> migration_guide </span></a></li><li class=md-nav__item><a href=../openssl-core.h/ class=md-nav__link title=openssl-core.h><span class=md-ellipsis-custom> openssl-core.h </span></a></li><li class=md-nav__item><a href=../openssl-core_dispatch.h/ class=md-nav__link title=openssl-core_dispatch.h><span class=md-ellipsis-custom> openssl-core_dispatch.h </span></a></li><li class=md-nav__item><a href=../openssl-core_names.h/ class=md-nav__link title=openssl-core_names.h><span class=md-ellipsis-custom> openssl-core_names.h </span></a></li><li class=md-nav__item><a href=../openssl-env/ class=md-nav__link title=openssl-env><span class=md-ellipsis-custom> openssl-env </span></a></li><li class=md-nav__item><a href=../openssl-glossary/ class=md-nav__link title=openssl-glossary><span class=md-ellipsis-custom> openssl-glossary </span></a></li><li class=md-nav__item><a href=../openssl-qlog/ class=md-nav__link title=openssl-qlog><span class=md-ellipsis-custom> openssl-qlog </span></a></li><li class=md-nav__item><a href=../openssl-quic/ class=md-nav__link title=openssl-quic><span class=md-ellipsis-custom> openssl-quic </span></a></li><li class=md-nav__item><a href=../openssl-threads/ class=md-nav__link title=openssl-threads><span class=md-ellipsis-custom> openssl-threads </span></a></li><li class=md-nav__item><a href=../openssl_user_macros/ class=md-nav__link title=openssl_user_macros><span class=md-ellipsis-custom> openssl_user_macros </span></a></li><li class=md-nav__item><a href=../ossl-guide-introduction/ class=md-nav__link title=ossl-guide-introduction><span class=md-ellipsis-custom> ossl-guide-introduction </span></a></li><li class=md-nav__item><a href=../ossl-guide-libcrypto-introduction/ class=md-nav__link title=ossl-guide-libcrypto-introduction><span class=md-ellipsis-custom> ossl-guide-libcrypto-introduction </span></a></li><li class=md-nav__item><a href=../ossl-guide-libraries-introduction/ class=md-nav__link title=ossl-guide-libraries-introduction><span class=md-ellipsis-custom> ossl-guide-libraries-introduction </span></a></li><li class=md-nav__item><a href=../ossl-guide-libssl-introduction/ class=md-nav__link title=ossl-guide-libssl-introduction><span class=md-ellipsis-custom> ossl-guide-libssl-introduction </span></a></li><li class=md-nav__item><a href=../ossl-guide-migration/ class=md-nav__link title=ossl-guide-migration><span class=md-ellipsis-custom> ossl-guide-migration </span></a></li><li class=md-nav__item><a href=../ossl-guide-quic-client-block/ class=md-nav__link title=ossl-guide-quic-client-block><span class=md-ellipsis-custom> ossl-guide-quic-client-block </span></a></li><li class=md-nav__item><a href=../ossl-guide-quic-client-non-block/ class=md-nav__link title=ossl-guide-quic-client-non-block><span class=md-ellipsis-custom> ossl-guide-quic-client-non-block </span></a></li><li class=md-nav__item><a href=../ossl-guide-quic-introduction/ class=md-nav__link title=ossl-guide-quic-introduction><span class=md-ellipsis-custom> ossl-guide-quic-introduction </span></a></li><li class=md-nav__item><a href=../ossl-guide-quic-multi-stream/ class=md-nav__link title=ossl-guide-quic-multi-stream><span class=md-ellipsis-custom> ossl-guide-quic-multi-stream </span></a></li><li class="md-nav__item md-nav__item--active"><input class="md-nav__toggle md-toggle" type=checkbox id=__toc><label class="md-nav__link md-nav__link--active" for=__toc><span class=md-ellipsis-custom> ossl-guide-tls-client-block </span><span class="md-nav__icon md-icon"></span></label><a href=./ class="md-nav__link md-nav__link--active"><span class=md-ellipsis-custom> ossl-guide-tls-client-block </span></a><nav class="md-nav md-nav--secondary" aria-label="Table of contents"><label class=md-nav__title for=__toc><span class="md-nav__icon md-icon"></span> Table of contents </label><ul class=md-nav__list data-md-component=toc data-md-scrollfix><li class=md-nav__item><a href=#name class=md-nav__link><span class=md-ellipsis> NAME </span></a></li><li class=md-nav__item><a href=#simple-blocking-tls-client-example class=md-nav__link><span class=md-ellipsis> SIMPLE BLOCKING TLS CLIENT EXAMPLE </span></a><nav class=md-nav aria-label="SIMPLE BLOCKING TLS CLIENT EXAMPLE"><ul class=md-nav__list><li class=md-nav__item><a href=#creating-the-ssl_ctx-and-ssl-objects class=md-nav__link><span class=md-ellipsis> Creating the SSL_CTX and SSL objects </span></a></li><li class=md-nav__item><a href=#creating-the-socket-and-bio class=md-nav__link><span class=md-ellipsis> Creating the socket and BIO </span></a></li><li class=md-nav__item><a href=#setting-the-servers-hostname class=md-nav__link><span class=md-ellipsis> Setting the server&#39;s hostname </span></a></li><li class=md-nav__item><a href=#performing-the-handshake class=md-nav__link><span class=md-ellipsis> Performing the handshake </span></a></li><li class=md-nav__item><a href=#sending-and-receiving-data class=md-nav__link><span class=md-ellipsis> Sending and receiving data </span></a></li><li class=md-nav__item><a href=#shutting-down-the-connection class=md-nav__link><span class=md-ellipsis> Shutting down the connection </span></a></li><li class=md-nav__item><a href=#final-clean-up class=md-nav__link><span class=md-ellipsis> Final clean up </span></a></li></ul></nav></li><li class=md-nav__item><a href=#troubleshooting class=md-nav__link><span class=md-ellipsis> TROUBLESHOOTING </span></a><nav class=md-nav aria-label=TROUBLESHOOTING><ul class=md-nav__list><li class=md-nav__item><a href=#failure-to-connect-the-underlying-socket class=md-nav__link><span class=md-ellipsis> Failure to connect the underlying socket </span></a></li><li class=md-nav__item><a href=#verification-failure-of-the-server-certificate class=md-nav__link><span class=md-ellipsis> Verification failure of the server certificate </span></a></li></ul></nav></li><li class=md-nav__item><a href=#further-reading class=md-nav__link><span class=md-ellipsis> FURTHER READING </span></a></li><li class=md-nav__item><a href=#see-also class=md-nav__link><span class=md-ellipsis> SEE ALSO </span></a></li><li class=md-nav__item><a href=#copyright class=md-nav__link><span class=md-ellipsis> COPYRIGHT </span></a></li></ul></nav></li><li class=md-nav__item><a href=../ossl-guide-tls-client-non-block/ class=md-nav__link title=ossl-guide-tls-client-non-block><span class=md-ellipsis-custom> ossl-guide-tls-client-non-block </span></a></li><li class=md-nav__item><a href=../ossl-guide-tls-introduction/ class=md-nav__link title=ossl-guide-tls-introduction><span class=md-ellipsis-custom> ossl-guide-tls-introduction </span></a></li><li class=md-nav__item><a href=../ossl-guide-tls-server-block/ class=md-nav__link title=ossl-guide-tls-server-block><span class=md-ellipsis-custom> ossl-guide-tls-server-block </span></a></li><li class=md-nav__item><a href=../ossl_store/ class=md-nav__link title=ossl_store><span class=md-ellipsis-custom> ossl_store </span></a></li><li class=md-nav__item><a href=../ossl_store-file/ class=md-nav__link title=ossl_store-file><span class=md-ellipsis-custom> ossl_store-file </span></a></li><li class=md-nav__item><a href=../passphrase-encoding/ class=md-nav__link title=passphrase-encoding><span class=md-ellipsis-custom> passphrase-encoding </span></a></li><li class=md-nav__item><a href=../property/ class=md-nav__link title=property><span class=md-ellipsis-custom> property </span></a></li><li class=md-nav__item><a href=../provider/ class=md-nav__link title=provider><span class=md-ellipsis-custom> provider </span></a></li><li class=md-nav__item><a href=../provider-asym_cipher/ class=md-nav__link title=provider-asym_cipher><span class=md-ellipsis-custom> provider-asym_cipher </span></a></li><li class=md-nav__item><a href=../provider-base/ class=md-nav__link title=provider-base><span class=md-ellipsis-custom> provider-base </span></a></li><li class=md-nav__item><a href=../provider-cipher/ class=md-nav__link title=provider-cipher><span class=md-ellipsis-custom> provider-cipher </span></a></li><li class=md-nav__item><a href=../provider-decoder/ class=md-nav__link title=provider-decoder><span class=md-ellipsis-custom> provider-decoder </span></a></li><li class=md-nav__item><a href=../provider-digest/ class=md-nav__link title=provider-digest><span class=md-ellipsis-custom> provider-digest </span></a></li><li class=md-nav__item><a href=../provider-encoder/ class=md-nav__link title=provider-encoder><span class=md-ellipsis-custom> provider-encoder </span></a></li><li class=md-nav__item><a href=../provider-kdf/ class=md-nav__link title=provider-kdf><span class=md-ellipsis-custom> provider-kdf </span></a></li><li class=md-nav__item><a href=../provider-kem/ class=md-nav__link title=provider-kem><span class=md-ellipsis-custom> provider-kem </span></a></li><li class=md-nav__item><a href=../provider-keyexch/ class=md-nav__link title=provider-keyexch><span class=md-ellipsis-custom> provider-keyexch </span></a></li><li class=md-nav__item><a href=../provider-keymgmt/ class=md-nav__link title=provider-keymgmt><span class=md-ellipsis-custom> provider-keymgmt </span></a></li><li class=md-nav__item><a href=../provider-mac/ class=md-nav__link title=provider-mac><span class=md-ellipsis-custom> provider-mac </span></a></li><li class=md-nav__item><a href=../provider-object/ class=md-nav__link title=provider-object><span class=md-ellipsis-custom> provider-object </span></a></li><li class=md-nav__item><a href=../provider-rand/ class=md-nav__link title=provider-rand><span class=md-ellipsis-custom> provider-rand </span></a></li><li class=md-nav__item><a href=../provider-signature/ class=md-nav__link title=provider-signature><span class=md-ellipsis-custom> provider-signature </span></a></li><li class=md-nav__item><a href=../provider-storemgmt/ class=md-nav__link title=provider-storemgmt><span class=md-ellipsis-custom> provider-storemgmt </span></a></li><li class=md-nav__item><a href=../proxy-certificates/ class=md-nav__link title=proxy-certificates><span class=md-ellipsis-custom> proxy-certificates </span></a></li><li class=md-nav__item><a href=../ossl-guide-libssl-introduction class=md-nav__link title=ssl><span class=md-ellipsis-custom> ssl </span></a></li><li class=md-nav__item><a href=../x509/ class=md-nav__link title=x509><span class=md-ellipsis-custom> x509 </span></a></li></ul></nav></li></ul></nav></div></div></div><div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc><div class=md-sidebar__scrollwrap><div class=md-sidebar__inner><nav class="md-nav md-nav--secondary" aria-label="Table of contents"><label class=md-nav__title for=__toc><span class="md-nav__icon md-icon"></span> Table of contents </label><ul class=md-nav__list data-md-component=toc data-md-scrollfix><li class=md-nav__item><a href=#name class=md-nav__link><span class=md-ellipsis> NAME </span></a></li><li class=md-nav__item><a href=#simple-blocking-tls-client-example class=md-nav__link><span class=md-ellipsis> SIMPLE BLOCKING TLS CLIENT EXAMPLE </span></a><nav class=md-nav aria-label="SIMPLE BLOCKING TLS CLIENT EXAMPLE"><ul class=md-nav__list><li class=md-nav__item><a href=#creating-the-ssl_ctx-and-ssl-objects class=md-nav__link><span class=md-ellipsis> Creating the SSL_CTX and SSL objects </span></a></li><li class=md-nav__item><a href=#creating-the-socket-and-bio class=md-nav__link><span class=md-ellipsis> Creating the socket and BIO </span></a></li><li class=md-nav__item><a href=#setting-the-servers-hostname class=md-nav__link><span class=md-ellipsis> Setting the server&#39;s hostname </span></a></li><li class=md-nav__item><a href=#performing-the-handshake class=md-nav__link><span class=md-ellipsis> Performing the handshake </span></a></li><li class=md-nav__item><a href=#sending-and-receiving-data class=md-nav__link><span class=md-ellipsis> Sending and receiving data </span></a></li><li class=md-nav__item><a href=#shutting-down-the-connection class=md-nav__link><span class=md-ellipsis> Shutting down the connection </span></a></li><li class=md-nav__item><a href=#final-clean-up class=md-nav__link><span class=md-ellipsis> Final clean up </span></a></li></ul></nav></li><li class=md-nav__item><a href=#troubleshooting class=md-nav__link><span class=md-ellipsis> TROUBLESHOOTING </span></a><nav class=md-nav aria-label=TROUBLESHOOTING><ul class=md-nav__list><li class=md-nav__item><a href=#failure-to-connect-the-underlying-socket class=md-nav__link><span class=md-ellipsis> Failure to connect the underlying socket </span></a></li><li class=md-nav__item><a href=#verification-failure-of-the-server-certificate class=md-nav__link><span class=md-ellipsis> Verification failure of the server certificate </span></a></li></ul></nav></li><li class=md-nav__item><a href=#further-reading class=md-nav__link><span class=md-ellipsis> FURTHER READING </span></a></li><li class=md-nav__item><a href=#see-also class=md-nav__link><span class=md-ellipsis> SEE ALSO </span></a></li><li class=md-nav__item><a href=#copyright class=md-nav__link><span class=md-ellipsis> COPYRIGHT </span></a></li></ul></nav></div></div></div><div class=md-content data-md-component=content><article class="md-content__inner md-typeset"><h1 id=ossl-guide-tls-client-block>ossl-guide-tls-client-block<a class=headerlink href=#ossl-guide-tls-client-block title="Permanent link">&para;</a></h1><h2 id=name>NAME<a class=headerlink href=#name title="Permanent link">&para;</a></h2><p>ossl-guide-tls-client-block - OpenSSL Guide: Writing a simple blocking TLS client</p><h2 id=simple-blocking-tls-client-example>SIMPLE BLOCKING TLS CLIENT EXAMPLE<a class=headerlink href=#simple-blocking-tls-client-example title="Permanent link">&para;</a></h2><p>This page will present various source code samples demonstrating how to write a simple TLS client application which connects to a server, sends an HTTP/1.0 request to it, and reads back the response.</p><p>We use a blocking socket for the purposes of this example. This means that attempting to read data from a socket that has no data available on it to read will block (and the function will not return), until data becomes available. For example, this can happen if we have sent our request, but we are still waiting for the server&#39;s response. Similarly any attempts to write to a socket that is not able to write at the moment will block until writing is possible.</p><p>This blocking behaviour simplifies the implementation of a client because you do not have to worry about what happens if data is not yet available. The application will simply wait until it is available.</p><p>The complete source code for this example blocking TLS client is available in the <strong>demos/guide</strong> directory of the OpenSSL source distribution in the file <strong>tls-client-block.c</strong>. It is also available online at <a href=https://github.com/openssl/openssl/blob/master/demos/guide/tls-client-block.c>https://github.com/openssl/openssl/blob/master/demos/guide/tls-client-block.c</a>.</p><p>We assume that you already have OpenSSL installed on your system; that you already have some fundamental understanding of OpenSSL concepts and TLS (see <a href=../ossl-guide-libraries-introduction/ >ossl-guide-libraries-introduction(7)</a> and <a href=../ossl-guide-tls-introduction/ >ossl-guide-tls-introduction(7)</a>); and that you know how to write and build C code and link it against the libcrypto and libssl libraries that are provided by OpenSSL. It also assumes that you have a basic understanding of TCP/IP and sockets.</p><h3 id=creating-the-ssl_ctx-and-ssl-objects>Creating the SSL_CTX and SSL objects<a class=headerlink href=#creating-the-ssl_ctx-and-ssl-objects title="Permanent link">&para;</a></h3><p>The first step is to create an <strong>SSL_CTX</strong> object for our client. We use the <a href=../../man3/SSL_CTX_new/ >SSL_CTX_new(3)</a> function for this purpose. We could alternatively use <a href=../../man3/SSL_CTX_new/ >SSL_CTX_new_ex(3)</a> if we want to associate the <strong>SSL_CTX</strong> with a particular <strong>OSSL_LIB_CTX</strong> (see <a href=../ossl-guide-libraries-introduction/ >ossl-guide-libraries-introduction(7)</a> to learn about <strong>OSSL_LIB_CTX</strong>). We pass as an argument the return value of the function <a href=../../man3/SSL_CTX_new/ >TLS_client_method(3)</a>. You should use this method whenever you are writing a TLS client. This method will automatically use TLS version negotiation to select the highest version of the protocol that is mutually supported by both the client and the server.</p><div class=highlight><pre><span></span><code>/*
 * Create an SSL_CTX which we can use to create SSL objects from. We
 * want an SSL_CTX for creating clients so we use TLS_client_method()
 * here.
 */
ctx = SSL_CTX_new(TLS_client_method());
if (ctx == NULL) {
    printf(&quot;Failed to create the SSL_CTX\n&quot;);
    goto end;
}
</code></pre></div><p>Since we are writing a client we must ensure that we verify the server&#39;s certificate. We do this by calling the <a href=../../man3/SSL_CTX_set_verify/ >SSL_CTX_set_verify(3)</a> function and pass the <strong>SSL_VERIFY_PEER</strong> value to it. The final argument to this function is a callback that you can optionally supply to override the default handling for certificate verification. Most applications do not need to do this so this can safely be set to NULL to get the default handling.</p><div class=highlight><pre><span></span><code>/*
 * Configure the client to abort the handshake if certificate
 * verification fails. Virtually all clients should do this unless you
 * really know what you are doing.
 */
SSL_CTX_set_verify(ctx, SSL_VERIFY_PEER, NULL);
</code></pre></div><p>In order for certificate verification to be successful you must have configured where the trusted certificate store to be used is located (see <a href=../ossl-guide-tls-introduction/ >ossl-guide-tls-introduction(7)</a>). In most cases you just want to use the default store so we call <a href=../../man3/SSL_CTX_load_verify_locations/ >SSL_CTX_set_default_verify_paths(3)</a>.</p><div class=highlight><pre><span></span><code>/* Use the default trusted certificate store */
if (!SSL_CTX_set_default_verify_paths(ctx)) {
    printf(&quot;Failed to set the default trusted certificate store\n&quot;);
    goto end;
}
</code></pre></div><p>We would also like to restrict the TLS versions that we are willing to accept to TLSv1.2 or above. TLS protocol versions earlier than that are generally to be avoided where possible. We can do that using <a href=../../man3/SSL_CTX_set_min_proto_version/ >SSL_CTX_set_min_proto_version(3)</a>:</p><div class=highlight><pre><span></span><code>/*
 * TLSv1.1 or earlier are deprecated by IETF and are generally to be
 * avoided if possible. We require a minimum TLS version of TLSv1.2.
 */
if (!SSL_CTX_set_min_proto_version(ctx, TLS1_2_VERSION)) {
    printf(&quot;Failed to set the minimum TLS protocol version\n&quot;);
    goto end;
}
</code></pre></div><p>That is all the setup that we need to do for the <strong>SSL_CTX</strong>, so next we need to create an <strong>SSL</strong> object to represent the TLS connection. In a real application we might expect to be creating more than one TLS connection over time. In that case we would expect to reuse the <strong>SSL_CTX</strong> that we already created each time. There is no need to repeat those steps. In fact it is best not to since certain internal resources are cached in the <strong>SSL_CTX</strong>. You will get better performance by reusing an existing <strong>SSL_CTX</strong> instead of creating a new one each time.</p><p>Creating the <strong>SSL</strong> object is a simple matter of calling the <strong>SSL_new(3)</strong> function and passing the <strong>SSL_CTX</strong> we created as an argument.</p><div class=highlight><pre><span></span><code>/* Create an SSL object to represent the TLS connection */
ssl = SSL_new(ctx);
if (ssl == NULL) {
    printf(&quot;Failed to create the SSL object\n&quot;);
    goto end;
}
</code></pre></div><h3 id=creating-the-socket-and-bio>Creating the socket and BIO<a class=headerlink href=#creating-the-socket-and-bio title="Permanent link">&para;</a></h3><p>TLS data is transmitted over an underlying transport layer. Normally a TCP socket. It is the application&#39;s responsibility for ensuring that the socket is created and associated with an SSL object (via a BIO).</p><p>Socket creation for use by a client is typically a 2 step process, i.e. constructing the socket; and connecting the socket.</p><p>How to construct a socket is platform specific - but most platforms (including Windows) provide a POSIX compatible interface via the <em>socket</em> function, e.g. to create an IPv4 TCP socket:</p><div class=highlight><pre><span></span><code>int sock;

sock = socket(AF_INET, SOCK_STREAM, 0);
if (sock == -1)
    return NULL;
</code></pre></div><p>Once the socket is constructed it must be connected to the remote server. Again the details are platform specific but most platforms (including Windows) provide the POSIX compatible <em>connect</em> function. For example:</p><div class=highlight><pre><span></span><code>struct sockaddr_in serveraddr;
struct hostent *server;

server = gethostbyname(&quot;www.openssl.org&quot;);
if (server == NULL) {
    close(sock);
    return NULL;
}

memset(&amp;serveraddr, 0, sizeof(serveraddr));
serveraddr.sin_family = server-&gt;h_addrtype;
serveraddr.sin_port = htons(443);
memcpy(&amp;serveraddr.sin_addr.s_addr, server-&gt;h_addr, server-&gt;h_length);

if (connect(sock, (struct sockaddr *)&amp;serveraddr,
            sizeof(serveraddr)) == -1) {
    close(sock);
    return NULL;
}
</code></pre></div><p>OpenSSL provides portable helper functions to do these tasks which also integrate into the OpenSSL error system to log error data, e.g.</p><div class=highlight><pre><span></span><code>int sock = -1;
BIO_ADDRINFO *res;
const BIO_ADDRINFO *ai = NULL;

/*
 * Lookup IP address info for the server.
 */
if (!BIO_lookup_ex(hostname, port, BIO_LOOKUP_CLIENT, family, SOCK_STREAM, 0,
                   &amp;res))
    return NULL;

/*
 * Loop through all the possible addresses for the server and find one
 * we can connect to.
 */
for (ai = res; ai != NULL; ai = BIO_ADDRINFO_next(ai)) {
    /*
     * Create a TCP socket. We could equally use non-OpenSSL calls such
     * as &quot;socket&quot; here for this and the subsequent connect and close
     * functions. But for portability reasons and also so that we get
     * errors on the OpenSSL stack in the event of a failure we use
     * OpenSSL&#39;s versions of these functions.
     */
    sock = BIO_socket(BIO_ADDRINFO_family(ai), SOCK_STREAM, 0, 0);
    if (sock == -1)
        continue;

    /* Connect the socket to the server&#39;s address */
    if (!BIO_connect(sock, BIO_ADDRINFO_address(ai), BIO_SOCK_NODELAY)) {
        BIO_closesocket(sock);
        sock = -1;
        continue;
    }

    /* We have a connected socket so break out of the loop */
    break;
}

/* Free the address information resources we allocated earlier */
BIO_ADDRINFO_free(res);
</code></pre></div><p>See <a href=../../man3/BIO_ADDRINFO/ >BIO_lookup_ex(3)</a>, <a href=../../man3/BIO_connect/ >BIO_socket(3)</a>, <a href=../../man3/BIO_connect/ >BIO_connect(3)</a>, <a href=../../man3/BIO_connect/ >BIO_closesocket(3)</a>, <a href=../../man3/BIO_ADDRINFO/ >BIO_ADDRINFO_next(3)</a>, <a href=../../man3/BIO_ADDRINFO/ >BIO_ADDRINFO_address(3)</a> and <a href=../../man3/BIO_ADDRINFO/ >BIO_ADDRINFO_free(3)</a> for further information on the functions used here. In the above example code the <strong>hostname</strong> and <strong>port</strong> variables are strings, e.g. &quot;www.example.com&quot; and &quot;443&quot;. Note also the use of the family variable, which can take the values of AF_INET or AF_INET6 based on the command line -6 option, to allow specific connections to an ipv4 or ipv6 enabled host.</p><p>Sockets created using the methods described above will automatically be blocking sockets - which is exactly what we want for this example.</p><p>Once the socket has been created and connected we need to associate it with a BIO object:</p><div class=highlight><pre><span></span><code>BIO *bio;

/* Create a BIO to wrap the socket */
bio = BIO_new(BIO_s_socket());
if (bio == NULL) {
    BIO_closesocket(sock);
    return NULL;
}

/*
 * Associate the newly created BIO with the underlying socket. By
 * passing BIO_CLOSE here the socket will be automatically closed when
 * the BIO is freed. Alternatively you can use BIO_NOCLOSE, in which
 * case you must close the socket explicitly when it is no longer
 * needed.
 */
BIO_set_fd(bio, sock, BIO_CLOSE);
</code></pre></div><p>See <a href=../../man3/BIO_new/ >BIO_new(3)</a>, <a href=../../man3/BIO_s_socket/ >BIO_s_socket(3)</a> and <a href=../../man3/BIO_s_fd/ >BIO_set_fd(3)</a> for further information on these functions.</p><p>Finally we associate the <strong>SSL</strong> object we created earlier with the <strong>BIO</strong> using the <a href=../../man3/SSL_set_bio/ >SSL_set_bio(3)</a> function. Note that this passes ownership of the <strong>BIO</strong> object to the <strong>SSL</strong> object. Once ownership is passed the SSL object is responsible for its management and will free it automatically when the <strong>SSL</strong> is freed. So, once <a href=../../man3/SSL_set_bio/ >SSL_set_bio(3)</a> has been been called, you should not call <a href=../../man3/BIO_new/ >BIO_free(3)</a> on the <strong>BIO</strong>.</p><div class=highlight><pre><span></span><code>SSL_set_bio(ssl, bio, bio);
</code></pre></div><h3 id=setting-the-servers-hostname>Setting the server&#39;s hostname<a class=headerlink href=#setting-the-servers-hostname title="Permanent link">&para;</a></h3><p>We have already connected our underlying socket to the server, but the client still needs to know the server&#39;s hostname. It uses this information for 2 key purposes and we need to set the hostname for each one.</p><p>Firstly, the server&#39;s hostname is included in the initial ClientHello message sent by the client. This is known as the Server Name Indication (SNI). This is important because it is common for multiple hostnames to be fronted by a single server that handles requests for all of them. In other words a single server may have multiple hostnames associated with it and it is important to indicate which one we want to connect to. Without this information we may get a handshake failure, or we may get connected to the &quot;default&quot; server which may not be the one we were expecting.</p><p>To set the SNI hostname data we call the <a href=../../man3/SSL_CTX_set_tlsext_servername_callback/ >SSL_set_tlsext_host_name(3)</a> function like this:</p><div class=highlight><pre><span></span><code>/*
 * Tell the server during the handshake which hostname we are attempting
 * to connect to in case the server supports multiple hosts.
 */
if (!SSL_set_tlsext_host_name(ssl, hostname)) {
    printf(&quot;Failed to set the SNI hostname\n&quot;);
    goto end;
}
</code></pre></div><p>Here the <code>hostname</code> argument is a string representing the hostname of the server, e.g. &quot;www.example.com&quot;.</p><p>Secondly, we need to tell OpenSSL what hostname we expect to see in the certificate coming back from the server. This is almost always the same one that we asked for in the original request. This is important because, without this, we do not verify that the hostname in the certificate is what we expect it to be and any certificate is acceptable unless your application explicitly checks this itself. We do this via the <a href=../../man3/SSL_set1_host/ >SSL_set1_host(3)</a> function:</p><div class=highlight><pre><span></span><code>/*
 * Ensure we check during certificate verification that the server has
 * supplied a certificate for the hostname that we were expecting.
 * Virtually all clients should do this unless you really know what you
 * are doing.
 */
if (!SSL_set1_host(ssl, hostname)) {
    printf(&quot;Failed to set the certificate verification hostname&quot;);
    goto end;
}
</code></pre></div><p>All of the above steps must happen before we attempt to perform the handshake otherwise they will have no effect.</p><h3 id=performing-the-handshake>Performing the handshake<a class=headerlink href=#performing-the-handshake title="Permanent link">&para;</a></h3><p>Before we can start sending or receiving application data over a TLS connection the TLS handshake must be performed. We can do this explicitly via the <a href=../../man3/SSL_connect/ >SSL_connect(3)</a> function.</p><div class=highlight><pre><span></span><code>/* Do the handshake with the server */
if (SSL_connect(ssl) &lt; 1) {
    printf(&quot;Failed to connect to the server\n&quot;);
    /*
     * If the failure is due to a verification error we can get more
     * information about it from SSL_get_verify_result().
     */
    if (SSL_get_verify_result(ssl) != X509_V_OK)
        printf(&quot;Verify error: %s\n&quot;,
            X509_verify_cert_error_string(SSL_get_verify_result(ssl)));
    goto end;
}
</code></pre></div><p>The <a href=../../man3/SSL_connect/ >SSL_connect(3)</a> function can return 1, 0 or less than 0. Only a return value of 1 is considered a success. For a simple blocking client we only need to concern ourselves with whether the call was successful or not. Anything else indicates that we have failed to connect to the server.</p><p>A common cause of failures at this stage is due to a problem verifying the server&#39;s certificate. For example if the certificate has expired, or it is not signed by a CA in our trusted certificate store. We can use the <a href=../../man3/SSL_get_verify_result/ >SSL_get_verify_result(3)</a> function to find out more information about the verification failure. A return value of <strong>X509_V_OK</strong> indicates that the verification was successful (so the connection error must be due to some other cause). Otherwise we use the <a href=../../man3/X509_STORE_CTX_get_error/ >X509_verify_cert_error_string(3)</a> function to get a human readable error message.</p><h3 id=sending-and-receiving-data>Sending and receiving data<a class=headerlink href=#sending-and-receiving-data title="Permanent link">&para;</a></h3><p>Once the handshake is complete we are able to send and receive application data. Exactly what data is sent and in what order is usually controlled by some application level protocol. In this example we are using HTTP 1.0 which is a very simple request and response protocol. The client sends a request to the server. The server sends the response data and then immediately closes down the connection.</p><p>To send data to the server we use the <a href=../../man3/SSL_write/ >SSL_write_ex(3)</a> function and to receive data from the server we use the <a href=../../man3/SSL_read/ >SSL_read_ex(3)</a> function. In HTTP 1.0 the client always writes data first. Our HTTP request will include the hostname that we are connecting to. For simplicity, we write the HTTP request in three chunks. First we write the start of the request. Secondly we write the hostname we are sending the request to. Finally we send the end of the request.</p><div class=highlight><pre><span></span><code>size_t written;
const char *request_start = &quot;GET / HTTP/1.0\r\nConnection: close\r\nHost: &quot;;
const char *request_end = &quot;\r\n\r\n&quot;;

/* Write an HTTP GET request to the peer */
if (!SSL_write_ex(ssl, request_start, strlen(request_start), &amp;written)) {
    printf(&quot;Failed to write start of HTTP request\n&quot;);
    goto end;
}
if (!SSL_write_ex(ssl, hostname, strlen(hostname), &amp;written)) {
    printf(&quot;Failed to write hostname in HTTP request\n&quot;);
    goto end;
}
if (!SSL_write_ex(ssl, request_end, strlen(request_end), &amp;written)) {
    printf(&quot;Failed to write end of HTTP request\n&quot;);
    goto end;
}
</code></pre></div><p>The <a href=../../man3/SSL_write/ >SSL_write_ex(3)</a> function returns 0 if it fails and 1 if it is successful. If it is successful then we can proceed to waiting for a response from the server.</p><div class=highlight><pre><span></span><code>size_t readbytes;
char buf[160];

/*
 * Get up to sizeof(buf) bytes of the response. We keep reading until the
 * server closes the connection.
 */
while (SSL_read_ex(ssl, buf, sizeof(buf), &amp;readbytes)) {
    /*
    * OpenSSL does not guarantee that the returned data is a string or
    * that it is NUL terminated so we use fwrite() to write the exact
    * number of bytes that we read. The data could be non-printable or
    * have NUL characters in the middle of it. For this simple example
    * we&#39;re going to print it to stdout anyway.
    */
    fwrite(buf, 1, readbytes, stdout);
}
/* In case the response didn&#39;t finish with a newline we add one now */
printf(&quot;\n&quot;);
</code></pre></div><p>We use the <a href=../../man3/SSL_read/ >SSL_read_ex(3)</a> function to read the response. We don&#39;t know exactly how much data we are going to receive back so we enter a loop reading blocks of data from the server and printing each block that we receive to the screen. The loop ends as soon as <a href=../../man3/SSL_read/ >SSL_read_ex(3)</a> returns 0 - meaning that it failed to read any data.</p><p>A failure to read data could mean that there has been some error, or it could simply mean that server has sent all the data that it wants to send and has indicated that it has finished by sending a &quot;close_notify&quot; alert. This alert is a TLS protocol level message indicating that the endpoint has finished sending all of its data and it will not send any more. Both of these conditions result in a 0 return value from <a href=../../man3/SSL_read/ >SSL_read_ex(3)</a> and we need to use the function <a href=../../man3/SSL_get_error/ >SSL_get_error(3)</a> to determine the cause of the 0 return value.</p><div class=highlight><pre><span></span><code>/*
 * Check whether we finished the while loop above normally or as the
 * result of an error. The 0 argument to SSL_get_error() is the return
 * code we received from the SSL_read_ex() call. It must be 0 in order
 * to get here. Normal completion is indicated by SSL_ERROR_ZERO_RETURN.
 */
if (SSL_get_error(ssl, 0) != SSL_ERROR_ZERO_RETURN) {
    /*
     * Some error occurred other than a graceful close down by the
     * peer
     */
    printf (&quot;Failed reading remaining data\n&quot;);
    goto end;
}
</code></pre></div><p>If <a href=../../man3/SSL_get_error/ >SSL_get_error(3)</a> returns <strong>SSL_ERROR_ZERO_RETURN</strong> then we know that the server has finished sending its data. Otherwise an error has occurred.</p><h3 id=shutting-down-the-connection>Shutting down the connection<a class=headerlink href=#shutting-down-the-connection title="Permanent link">&para;</a></h3><p>Once we have finished reading data from the server then we are ready to close the connection down. We do this via the <a href=../../man3/SSL_shutdown/ >SSL_shutdown(3)</a> function which has the effect of sending a TLS protocol level message (a &quot;close_notify&quot; alert) to the server saying that we have finished writing data:</p><div class=highlight><pre><span></span><code>/*
 * The peer already shutdown gracefully (we know this because of the
 * SSL_ERROR_ZERO_RETURN above). We should do the same back.
 */
ret = SSL_shutdown(ssl);
if (ret &lt; 1) {
    /*
     * ret &lt; 0 indicates an error. ret == 0 would be unexpected here
     * because that means &quot;we&#39;ve sent a close_notify and we&#39;re waiting
     * for one back&quot;. But we already know we got one from the peer
     * because of the SSL_ERROR_ZERO_RETURN above.
     */
    printf(&quot;Error shutting down\n&quot;);
    goto end;
}
</code></pre></div><p>The <a href=../../man3/SSL_shutdown/ >SSL_shutdown(3)</a> function will either return 1, 0, or less than 0. A return value of 1 is a success, and a return value less than 0 is an error. More precisely a return value of 1 means that we have sent a &quot;close_notify&quot; alert to the server, and that we have also received one back. A return value of 0 means that we have sent a &quot;close_notify&quot; alert to the server, but we have not yet received one back. Usually in this scenario you would call <a href=../../man3/SSL_shutdown/ >SSL_shutdown(3)</a> again which (with a blocking socket) would block until the &quot;close_notify&quot; is received. However in this case we already know that the server has sent us a &quot;close_notify&quot; because of the SSL_ERROR_ZERO_RETURN that we received from the call to <a href=../../man3/SSL_read/ >SSL_read_ex(3)</a>. So this scenario should never happen in practice. We just treat it as an error in this example.</p><h3 id=final-clean-up>Final clean up<a class=headerlink href=#final-clean-up title="Permanent link">&para;</a></h3><p>Before the application exits we have to clean up some memory that we allocated. If we are exiting due to an error we might also want to display further information about that error if it is available to the user:</p><div class=highlight><pre><span></span><code>   /* Success! */
   res = EXIT_SUCCESS;
end:
   /*
    * If something bad happened then we will dump the contents of the
    * OpenSSL error stack to stderr. There might be some useful diagnostic
    * information there.
    */
   if (res == EXIT_FAILURE)
       ERR_print_errors_fp(stderr);

   /*
    * Free the resources we allocated. We do not free the BIO object here
    * because ownership of it was immediately transferred to the SSL object
    * via SSL_set_bio(). The BIO will be freed when we free the SSL object.
    */
   SSL_free(ssl);
   SSL_CTX_free(ctx);
   return res;
</code></pre></div><p>To display errors we make use of the <a href=../../man3/ERR_print_errors/ >ERR_print_errors_fp(3)</a> function which simply dumps out the contents of any errors on the OpenSSL error stack to the specified location (in this case <em>stderr</em>).</p><p>We need to free up the <strong>SSL</strong> object that we created for the connection via the <a href=../../man3/SSL_free/ >SSL_free(3)</a> function. Also, since we are not going to be creating any more TLS connections we must also free up the <strong>SSL_CTX</strong> via a call to <a href=../../man3/SSL_CTX_free/ >SSL_CTX_free(3)</a>.</p><h2 id=troubleshooting>TROUBLESHOOTING<a class=headerlink href=#troubleshooting title="Permanent link">&para;</a></h2><p>There are a number of things that might go wrong when running the demo application. This section describes some common things you might encounter.</p><h3 id=failure-to-connect-the-underlying-socket>Failure to connect the underlying socket<a class=headerlink href=#failure-to-connect-the-underlying-socket title="Permanent link">&para;</a></h3><p>This could occur for numerous reasons. For example if there is a problem in the network route between the client and the server; or a firewall is blocking the communication; or the server is not in DNS. Check the network configuration.</p><h3 id=verification-failure-of-the-server-certificate>Verification failure of the server certificate<a class=headerlink href=#verification-failure-of-the-server-certificate title="Permanent link">&para;</a></h3><p>A verification failure of the server certificate would result in a failure when running the <a href=../../man3/SSL_connect/ >SSL_connect(3)</a> function. <a href=../../man3/ERR_print_errors/ >ERR_print_errors_fp(3)</a> would display an error which would look something like this:</p><div class=highlight><pre><span></span><code>Verify error: unable to get local issuer certificate
40E74AF1F47F0000:error:0A000086:SSL routines:tls_post_process_server_certificate:certificate verify failed:ssl/statem/statem_clnt.c:2069:
</code></pre></div><p>A server certificate verification failure could be caused for a number of reasons. For example</p><ul><li><p>Failure to correctly setup the trusted certificate store</p><p>See the page <a href=../ossl-guide-tls-introduction/ >ossl-guide-tls-introduction(7)</a> and check that your trusted certificate store is correctly configured</p></li><li><p>Unrecognised CA</p><p>If the CA used by the server&#39;s certificate is not in the trusted certificate store for the client then this will cause a verification failure during connection. Often this can occur if the server is using a self-signed certificate (i.e. a test certificate that has not been signed by a CA at all).</p></li><li><p>Missing intermediate CAs</p><p>This is a server misconfiguration where the client has the relevant root CA in its trust store, but the server has not supplied all of the intermediate CA certificates between that root CA and the server&#39;s own certificate. Therefore a trust chain cannot be established.</p></li><li><p>Mismatched hostname</p><p>If for some reason the hostname of the server that the client is expecting does not match the hostname in the certificate then this will cause verification to fail.</p></li><li><p>Expired certificate</p><p>The date that the server&#39;s certificate is valid to has passed.</p></li></ul><p>The &quot;unable to get local issuer certificate&quot; we saw in the example above means that we have been unable to find the issuer of the server&#39;s certificate (or one of its intermediate CA certificates) in our trusted certificate store (e.g. because the trusted certificate store is misconfigured, or there are missing intermediate CAs, or the issuer is simply unrecognised).</p><h2 id=further-reading>FURTHER READING<a class=headerlink href=#further-reading title="Permanent link">&para;</a></h2><p>See <a href=../ossl-guide-tls-client-non-block/ >ossl-guide-tls-client-non-block(7)</a> to read a tutorial on how to modify the client developed on this page to support a nonblocking socket.</p><p>See <a href=../ossl-guide-tls-server-block/ >ossl-guide-tls-server-block(7)</a> for a tutorial on how to implement a simple TLS server handling one client at a time over a blocking socket.</p><p>See <a href=../ossl-guide-quic-client-block/ >ossl-guide-quic-client-block(7)</a> to read a tutorial on how to modify the client developed on this page to support QUIC instead of TLS.</p><h2 id=see-also>SEE ALSO<a class=headerlink href=#see-also title="Permanent link">&para;</a></h2><p><a href=../ossl-guide-introduction/ >ossl-guide-introduction(7)</a>, <a href=../ossl-guide-libraries-introduction/ >ossl-guide-libraries-introduction(7)</a>, <a href=../ossl-guide-libssl-introduction/ >ossl-guide-libssl-introduction(7)</a>, <a href=../ossl-guide-tls-introduction/ >ossl-guide-tls-introduction(7)</a>, <a href=../ossl-guide-tls-client-non-block/ >ossl-guide-tls-client-non-block(7)</a>, <a href=../ossl-guide-quic-client-block/ >ossl-guide-quic-client-block(7)</a></p><h2 id=copyright>COPYRIGHT<a class=headerlink href=#copyright title="Permanent link">&para;</a></h2><p>Copyright 2023-2024 The OpenSSL Project Authors. All Rights Reserved.</p><p>Licensed under the Apache License 2.0 (the &quot;License&quot;). You may not use this file except in compliance with the License. You can obtain a copy in the file LICENSE in the source distribution or at <a href=https://www.openssl.org/source/license.html>https://www.openssl.org/source/license.html</a>.</p></article></div><script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script></div></main><footer class=md-footer><div class="md-footer-meta md-typeset"><div class="md-footer-meta__inner md-grid"><div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a></div></div></div></footer></div><div class=md-dialog data-md-component=dialog><div class="md-dialog__inner md-typeset"></div></div><script id=__config type=application/json>{"base": "../..", "features": ["navigation.indexes", "navigation.instant", "navigation.path", "navigation.prune", "navigation.tabs", "navigation.tabs.sticky", "navigation.tracking", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "master", "provider": "mike"}}</script><script src=../../assets/javascripts/bundle.ad660dcc.min.js></script></body></html>