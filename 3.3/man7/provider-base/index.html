<!doctype html><html class=no-js lang=en><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><link href=https://docs.openssl.org/3.3/man7/provider-base/ rel=canonical><link href=../provider-asym_cipher/ rel=prev><link href=../provider-cipher/ rel=next><link href=../../images/favicon.ico rel=icon><meta content="mkdocs-1.6.0, mkdocs-material-9.5.27" name=generator><title>provider-base - OpenSSL Documentation</title><link href=../../assets/stylesheets/main.6543a935.min.css rel=stylesheet><link href=../../assets/stylesheets/palette.06af60db.min.css rel=stylesheet><link crossorigin href=https://fonts.gstatic.com rel=preconnect><link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback" rel=stylesheet><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link href=../../stylesheets/extra.css rel=stylesheet><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><body data-md-color-accent=light-blue data-md-color-primary=blue-grey data-md-color-scheme=default dir=ltr><input autocomplete=off class=md-toggle data-md-toggle=drawer id=__drawer type=checkbox><input autocomplete=off class=md-toggle data-md-toggle=search id=__search type=checkbox><label class=md-overlay for=__drawer></label><div data-md-component=skip><a class=md-skip href=#provider-base> Skip to content </a></div><div data-md-component=announce></div><div data-md-color-scheme=default data-md-component=outdated hidden></div><header class="md-header md-header--shadow md-header--lifted" data-md-component=header><nav class="md-header__inner md-grid" aria-label=Header><a aria-label="OpenSSL Documentation" class="md-header__button md-logo" title="OpenSSL Documentation" data-md-component=logo href=../..> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a><label class="md-header__button md-icon" for=__drawer><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg></label><div class=md-header__title data-md-component=header-title><div class=md-header__ellipsis><div class=md-header__topic><span class=md-ellipsis> OpenSSL Documentation </span></div><div class=md-header__topic data-md-component=header-topic><span class=md-ellipsis> provider-base </span></div></div></div><form class=md-header__option data-md-component=palette><input aria-label="Switch to dark mode" class=md-option data-md-color-accent=light-blue data-md-color-media data-md-color-primary=blue-grey data-md-color-scheme=default id=__palette_0 name=__palette type=radio><label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg></label><input aria-label="Switch to light mode" class=md-option data-md-color-accent=light-blue data-md-color-media data-md-color-primary=black data-md-color-scheme=slate id=__palette_1 name=__palette type=radio><label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg></label></form><script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script><label class="md-header__button md-icon" for=__search><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg></label><div class=md-search data-md-component=search role=dialog><label class=md-search__overlay for=__search></label><div class=md-search__inner role=search><form class=md-search__form name=search><input aria-label=Search autocapitalize=off autocomplete=off autocorrect=off class=md-search__input data-md-component=search-query name=query placeholder=Search required spellcheck=false><label class="md-search__icon md-icon" for=__search><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg></label><nav aria-label=Search class=md-search__options><button class="md-search__icon md-icon" aria-label=Clear tabindex=-1 title=Clear type=reset><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg></button></nav><div class=md-search__suggest data-md-component=search-suggest></div></form><div class=md-search__output><div class=md-search__scrollwrap data-md-scrollfix tabindex=0><div class=md-search-result data-md-component=search-result><div class=md-search-result__meta>Initializing search</div><ol class=md-search-result__list role=presentation></ol></div></div></div></div></div><div class=md-header__source><a title="Go to repository" class=md-source data-md-component=source href=https://github.com/openssl/openssl> <div class="md-source__icon md-icon"><svg viewbox="0 0 448 512" xmlns=http://www.w3.org/2000/svg><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg></div> <div class=md-source__repository>GitHub</div> </a></div></nav><nav aria-label=Tabs class=md-tabs data-md-component=tabs><div class=md-grid><ul class=md-tabs__list><li class=md-tabs__item><a class=md-tabs__link href=../..> Home </a><li class=md-tabs__item><a class=md-tabs__link href=../../fips/> FIPS-140 </a><li class=md-tabs__item><a class=md-tabs__link href=../../man1/> Commands </a><li class=md-tabs__item><a class=md-tabs__link href=../../man3/> Libraries </a><li class=md-tabs__item><a class=md-tabs__link href=../../man5/> File Formats </a><li class="md-tabs__item md-tabs__item--active"><a class=md-tabs__link href=../> Overviews </a></ul></div></nav></header><div class=md-container data-md-component=container><main class=md-main data-md-component=main><div class="md-main__inner md-grid"><div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation><div class=md-sidebar__scrollwrap><div class=md-sidebar__inner><nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0><label class=md-nav__title for=__drawer><a aria-label="OpenSSL Documentation" class="md-nav__button md-logo" title="OpenSSL Documentation" data-md-component=logo href=../..> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> OpenSSL Documentation</label><div class=md-nav__source><a title="Go to repository" class=md-source data-md-component=source href=https://github.com/openssl/openssl> <div class="md-source__icon md-icon"><svg viewbox="0 0 448 512" xmlns=http://www.w3.org/2000/svg><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg></div> <div class=md-source__repository>GitHub</div> </a></div><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item> <a class=md-nav__link href=../.. title=Home>    <span class=md-ellipsis-custom> Home </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../../fips/ title=FIPS-140>    <span class=md-ellipsis-custom> FIPS-140 </span>  </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a class=md-nav__link href=../../man1/>    <span class=md-ellipsis-custom> Commands </span>   <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a class=md-nav__link href=../../man3/>    <span class=md-ellipsis-custom> Libraries </span>   <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a class=md-nav__link href=../../man5/>    <span class=md-ellipsis-custom> File Formats </span>   <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">  <input class="md-nav__toggle md-toggle" checked id=__nav_6 type=checkbox>  <div class="md-nav__link md-nav__container"><a class=md-nav__link href=../>    <span class=md-ellipsis-custom> Overviews </span>  </a><label class=md-nav__link for=__nav_6 id=__nav_6_label><span class="md-nav__icon md-icon"></span></label></div>  <nav aria-expanded=true aria-labelledby=__nav_6_label class=md-nav data-md-level=1><label class=md-nav__title for=__nav_6><span class="md-nav__icon md-icon"></span> Overviews</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item> <a class=md-nav__link href=../EVP_ASYM_CIPHER-RSA/ title=EVP_ASYM_CIPHER-RSA>    <span class=md-ellipsis-custom> EVP_ASYM_CIPHER-RSA </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_ASYM_CIPHER-SM2/ title=EVP_ASYM_CIPHER-SM2>    <span class=md-ellipsis-custom> EVP_ASYM_CIPHER-SM2 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_CIPHER-AES/ title=EVP_CIPHER-AES>    <span class=md-ellipsis-custom> EVP_CIPHER-AES </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_CIPHER-ARIA/ title=EVP_CIPHER-ARIA>    <span class=md-ellipsis-custom> EVP_CIPHER-ARIA </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_CIPHER-BLOWFISH/ title=EVP_CIPHER-BLOWFISH>    <span class=md-ellipsis-custom> EVP_CIPHER-BLOWFISH </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_CIPHER-CAMELLIA/ title=EVP_CIPHER-CAMELLIA>    <span class=md-ellipsis-custom> EVP_CIPHER-CAMELLIA </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_CIPHER-CAST/ title=EVP_CIPHER-CAST>    <span class=md-ellipsis-custom> EVP_CIPHER-CAST </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_CIPHER-CHACHA/ title=EVP_CIPHER-CHACHA>    <span class=md-ellipsis-custom> EVP_CIPHER-CHACHA </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_CIPHER-DES/ title=EVP_CIPHER-DES>    <span class=md-ellipsis-custom> EVP_CIPHER-DES </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_CIPHER-IDEA/ title=EVP_CIPHER-IDEA>    <span class=md-ellipsis-custom> EVP_CIPHER-IDEA </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_CIPHER-NULL/ title=EVP_CIPHER-NULL>    <span class=md-ellipsis-custom> EVP_CIPHER-NULL </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_CIPHER-RC2/ title=EVP_CIPHER-RC2>    <span class=md-ellipsis-custom> EVP_CIPHER-RC2 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_CIPHER-RC4/ title=EVP_CIPHER-RC4>    <span class=md-ellipsis-custom> EVP_CIPHER-RC4 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_CIPHER-RC5/ title=EVP_CIPHER-RC5>    <span class=md-ellipsis-custom> EVP_CIPHER-RC5 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_CIPHER-SEED/ title=EVP_CIPHER-SEED>    <span class=md-ellipsis-custom> EVP_CIPHER-SEED </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_CIPHER-SM4/ title=EVP_CIPHER-SM4>    <span class=md-ellipsis-custom> EVP_CIPHER-SM4 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_KDF-ARGON2/ title=EVP_KDF-ARGON2>    <span class=md-ellipsis-custom> EVP_KDF-ARGON2 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_KDF-HKDF/ title=EVP_KDF-HKDF>    <span class=md-ellipsis-custom> EVP_KDF-HKDF </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_KDF-HMAC-DRBG/ title=EVP_KDF-HMAC-DRBG>    <span class=md-ellipsis-custom> EVP_KDF-HMAC-DRBG </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_KDF-KB/ title=EVP_KDF-KB>    <span class=md-ellipsis-custom> EVP_KDF-KB </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_KDF-KRB5KDF/ title=EVP_KDF-KRB5KDF>    <span class=md-ellipsis-custom> EVP_KDF-KRB5KDF </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_KDF-PBKDF1/ title=EVP_KDF-PBKDF1>    <span class=md-ellipsis-custom> EVP_KDF-PBKDF1 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_KDF-PBKDF2/ title=EVP_KDF-PBKDF2>    <span class=md-ellipsis-custom> EVP_KDF-PBKDF2 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_KDF-PKCS12KDF/ title=EVP_KDF-PKCS12KDF>    <span class=md-ellipsis-custom> EVP_KDF-PKCS12KDF </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_KDF-PVKKDF/ title=EVP_KDF-PVKKDF>    <span class=md-ellipsis-custom> EVP_KDF-PVKKDF </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_KDF-SCRYPT/ title=EVP_KDF-SCRYPT>    <span class=md-ellipsis-custom> EVP_KDF-SCRYPT </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_KDF-SS/ title=EVP_KDF-SS>    <span class=md-ellipsis-custom> EVP_KDF-SS </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_KDF-SSHKDF/ title=EVP_KDF-SSHKDF>    <span class=md-ellipsis-custom> EVP_KDF-SSHKDF </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_KDF-TLS13_KDF/ title=EVP_KDF-TLS13_KDF>    <span class=md-ellipsis-custom> EVP_KDF-TLS13_KDF </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_KDF-TLS1_PRF/ title=EVP_KDF-TLS1_PRF>    <span class=md-ellipsis-custom> EVP_KDF-TLS1_PRF </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_KDF-X942-ASN1/ title=EVP_KDF-X942-ASN1>    <span class=md-ellipsis-custom> EVP_KDF-X942-ASN1 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_KDF-X942-CONCAT/ title=EVP_KDF-X942-CONCAT>    <span class=md-ellipsis-custom> EVP_KDF-X942-CONCAT </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_KDF-X963/ title=EVP_KDF-X963>    <span class=md-ellipsis-custom> EVP_KDF-X963 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_KEM-EC/ title=EVP_KEM-EC>    <span class=md-ellipsis-custom> EVP_KEM-EC </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_KEM-RSA/ title=EVP_KEM-RSA>    <span class=md-ellipsis-custom> EVP_KEM-RSA </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_KEM-X25519/ title=EVP_KEM-X25519>    <span class=md-ellipsis-custom> EVP_KEM-X25519 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_KEM-X25519 title=EVP_KEM-X448>    <span class=md-ellipsis-custom> EVP_KEM-X448 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_KEYEXCH-DH/ title=EVP_KEYEXCH-DH>    <span class=md-ellipsis-custom> EVP_KEYEXCH-DH </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_KEYEXCH-ECDH/ title=EVP_KEYEXCH-ECDH>    <span class=md-ellipsis-custom> EVP_KEYEXCH-ECDH </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_KEYEXCH-X25519/ title=EVP_KEYEXCH-X25519>    <span class=md-ellipsis-custom> EVP_KEYEXCH-X25519 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_KEYEXCH-X25519 title=EVP_KEYEXCH-X448>    <span class=md-ellipsis-custom> EVP_KEYEXCH-X448 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-HMAC title=EVP_KEYMGMT-CMAC>    <span class=md-ellipsis-custom> EVP_KEYMGMT-CMAC </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-DH title=EVP_KEYMGMT-DH>    <span class=md-ellipsis-custom> EVP_KEYMGMT-DH </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-DH title=EVP_KEYMGMT-DHX>    <span class=md-ellipsis-custom> EVP_KEYMGMT-DHX </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-DSA title=EVP_KEYMGMT-DSA>    <span class=md-ellipsis-custom> EVP_KEYMGMT-DSA </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-EC title=EVP_KEYMGMT-EC>    <span class=md-ellipsis-custom> EVP_KEYMGMT-EC </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-X25519 title=EVP_KEYMGMT-ED25519>    <span class=md-ellipsis-custom> EVP_KEYMGMT-ED25519 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-X25519 title=EVP_KEYMGMT-ED448>    <span class=md-ellipsis-custom> EVP_KEYMGMT-ED448 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-HMAC title=EVP_KEYMGMT-HMAC>    <span class=md-ellipsis-custom> EVP_KEYMGMT-HMAC </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-HMAC title=EVP_KEYMGMT-Poly1305>    <span class=md-ellipsis-custom> EVP_KEYMGMT-Poly1305 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-RSA title=EVP_KEYMGMT-RSA>    <span class=md-ellipsis-custom> EVP_KEYMGMT-RSA </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-SM2 title=EVP_KEYMGMT-SM2>    <span class=md-ellipsis-custom> EVP_KEYMGMT-SM2 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-HMAC title=EVP_KEYMGMT-Siphash>    <span class=md-ellipsis-custom> EVP_KEYMGMT-Siphash </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-X25519 title=EVP_KEYMGMT-X25519>    <span class=md-ellipsis-custom> EVP_KEYMGMT-X25519 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-X25519 title=EVP_KEYMGMT-X448>    <span class=md-ellipsis-custom> EVP_KEYMGMT-X448 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_MAC-BLAKE2/ title=EVP_MAC-BLAKE2>    <span class=md-ellipsis-custom> EVP_MAC-BLAKE2 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_MAC-BLAKE2 title=EVP_MAC-BLAKE2BMAC>    <span class=md-ellipsis-custom> EVP_MAC-BLAKE2BMAC </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_MAC-BLAKE2 title=EVP_MAC-BLAKE2SMAC>    <span class=md-ellipsis-custom> EVP_MAC-BLAKE2SMAC </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_MAC-CMAC/ title=EVP_MAC-CMAC>    <span class=md-ellipsis-custom> EVP_MAC-CMAC </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_MAC-GMAC/ title=EVP_MAC-GMAC>    <span class=md-ellipsis-custom> EVP_MAC-GMAC </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_MAC-HMAC/ title=EVP_MAC-HMAC>    <span class=md-ellipsis-custom> EVP_MAC-HMAC </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_MAC-KMAC/ title=EVP_MAC-KMAC>    <span class=md-ellipsis-custom> EVP_MAC-KMAC </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_MAC-KMAC title=EVP_MAC-KMAC128>    <span class=md-ellipsis-custom> EVP_MAC-KMAC128 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_MAC-KMAC title=EVP_MAC-KMAC256>    <span class=md-ellipsis-custom> EVP_MAC-KMAC256 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_MAC-Poly1305/ title=EVP_MAC-Poly1305>    <span class=md-ellipsis-custom> EVP_MAC-Poly1305 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_MAC-Siphash/ title=EVP_MAC-Siphash>    <span class=md-ellipsis-custom> EVP_MAC-Siphash </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_MD-BLAKE2/ title=EVP_MD-BLAKE2>    <span class=md-ellipsis-custom> EVP_MD-BLAKE2 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_MD-KECCAK/ title=EVP_MD-KECCAK>    <span class=md-ellipsis-custom> EVP_MD-KECCAK </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_MD-SHAKE title=EVP_MD-KECCAK-KMAC>    <span class=md-ellipsis-custom> EVP_MD-KECCAK-KMAC </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_MD-MD2/ title=EVP_MD-MD2>    <span class=md-ellipsis-custom> EVP_MD-MD2 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_MD-MD4/ title=EVP_MD-MD4>    <span class=md-ellipsis-custom> EVP_MD-MD4 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_MD-MD5/ title=EVP_MD-MD5>    <span class=md-ellipsis-custom> EVP_MD-MD5 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_MD-MD5-SHA1/ title=EVP_MD-MD5-SHA1>    <span class=md-ellipsis-custom> EVP_MD-MD5-SHA1 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_MD-MDC2/ title=EVP_MD-MDC2>    <span class=md-ellipsis-custom> EVP_MD-MDC2 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_MD-NULL/ title=EVP_MD-NULL>    <span class=md-ellipsis-custom> EVP_MD-NULL </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_MD-RIPEMD160/ title=EVP_MD-RIPEMD160>    <span class=md-ellipsis-custom> EVP_MD-RIPEMD160 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_MD-SHA1/ title=EVP_MD-SHA1>    <span class=md-ellipsis-custom> EVP_MD-SHA1 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_MD-SHA2/ title=EVP_MD-SHA2>    <span class=md-ellipsis-custom> EVP_MD-SHA2 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_MD-SHA3/ title=EVP_MD-SHA3>    <span class=md-ellipsis-custom> EVP_MD-SHA3 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_MD-SHAKE/ title=EVP_MD-SHAKE>    <span class=md-ellipsis-custom> EVP_MD-SHAKE </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_MD-SM3/ title=EVP_MD-SM3>    <span class=md-ellipsis-custom> EVP_MD-SM3 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_MD-WHIRLPOOL/ title=EVP_MD-WHIRLPOOL>    <span class=md-ellipsis-custom> EVP_MD-WHIRLPOOL </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_MD-common/ title=EVP_MD-common>    <span class=md-ellipsis-custom> EVP_MD-common </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-HMAC title=EVP_PKEY-CMAC>    <span class=md-ellipsis-custom> EVP_PKEY-CMAC </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-DH/ title=EVP_PKEY-DH>    <span class=md-ellipsis-custom> EVP_PKEY-DH </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-DH title=EVP_PKEY-DHX>    <span class=md-ellipsis-custom> EVP_PKEY-DHX </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-DSA/ title=EVP_PKEY-DSA>    <span class=md-ellipsis-custom> EVP_PKEY-DSA </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-EC/ title=EVP_PKEY-EC>    <span class=md-ellipsis-custom> EVP_PKEY-EC </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-X25519 title=EVP_PKEY-ED25519>    <span class=md-ellipsis-custom> EVP_PKEY-ED25519 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-X25519 title=EVP_PKEY-ED448>    <span class=md-ellipsis-custom> EVP_PKEY-ED448 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-FFC/ title=EVP_PKEY-FFC>    <span class=md-ellipsis-custom> EVP_PKEY-FFC </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-HMAC/ title=EVP_PKEY-HMAC>    <span class=md-ellipsis-custom> EVP_PKEY-HMAC </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-HMAC title=EVP_PKEY-Poly1305>    <span class=md-ellipsis-custom> EVP_PKEY-Poly1305 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-RSA/ title=EVP_PKEY-RSA>    <span class=md-ellipsis-custom> EVP_PKEY-RSA </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-SM2/ title=EVP_PKEY-SM2>    <span class=md-ellipsis-custom> EVP_PKEY-SM2 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-HMAC title=EVP_PKEY-Siphash>    <span class=md-ellipsis-custom> EVP_PKEY-Siphash </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-X25519/ title=EVP_PKEY-X25519>    <span class=md-ellipsis-custom> EVP_PKEY-X25519 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-X25519 title=EVP_PKEY-X448>    <span class=md-ellipsis-custom> EVP_PKEY-X448 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_RAND/ title=EVP_RAND>    <span class=md-ellipsis-custom> EVP_RAND </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_RAND-CTR-DRBG/ title=EVP_RAND-CTR-DRBG>    <span class=md-ellipsis-custom> EVP_RAND-CTR-DRBG </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_RAND-HASH-DRBG/ title=EVP_RAND-HASH-DRBG>    <span class=md-ellipsis-custom> EVP_RAND-HASH-DRBG </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_RAND-HMAC-DRBG/ title=EVP_RAND-HMAC-DRBG>    <span class=md-ellipsis-custom> EVP_RAND-HMAC-DRBG </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_RAND-SEED-SRC/ title=EVP_RAND-SEED-SRC>    <span class=md-ellipsis-custom> EVP_RAND-SEED-SRC </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_RAND-TEST-RAND/ title=EVP_RAND-TEST-RAND>    <span class=md-ellipsis-custom> EVP_RAND-TEST-RAND </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_SIGNATURE-HMAC title=EVP_SIGNATURE-CMAC>    <span class=md-ellipsis-custom> EVP_SIGNATURE-CMAC </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_SIGNATURE-DSA/ title=EVP_SIGNATURE-DSA>    <span class=md-ellipsis-custom> EVP_SIGNATURE-DSA </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_SIGNATURE-ECDSA/ title=EVP_SIGNATURE-ECDSA>    <span class=md-ellipsis-custom> EVP_SIGNATURE-ECDSA </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_SIGNATURE-ED25519/ title=EVP_SIGNATURE-ED25519>    <span class=md-ellipsis-custom> EVP_SIGNATURE-ED25519 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_SIGNATURE-ED25519 title=EVP_SIGNATURE-ED448>    <span class=md-ellipsis-custom> EVP_SIGNATURE-ED448 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_SIGNATURE-HMAC/ title=EVP_SIGNATURE-HMAC>    <span class=md-ellipsis-custom> EVP_SIGNATURE-HMAC </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_SIGNATURE-HMAC title=EVP_SIGNATURE-Poly1305>    <span class=md-ellipsis-custom> EVP_SIGNATURE-Poly1305 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_SIGNATURE-RSA/ title=EVP_SIGNATURE-RSA>    <span class=md-ellipsis-custom> EVP_SIGNATURE-RSA </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_SIGNATURE-HMAC title=EVP_SIGNATURE-Siphash>    <span class=md-ellipsis-custom> EVP_SIGNATURE-Siphash </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_SIGNATURE-ED25519 title=Ed25519>    <span class=md-ellipsis-custom> Ed25519 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_SIGNATURE-ED25519 title=Ed448>    <span class=md-ellipsis-custom> Ed448 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl_user_macros title=OPENSSL_API_COMPAT>    <span class=md-ellipsis-custom> OPENSSL_API_COMPAT </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl_user_macros title=OPENSSL_NO_DEPRECATED>    <span class=md-ellipsis-custom> OPENSSL_NO_DEPRECATED </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../OSSL_PROVIDER-FIPS/ title=OSSL_PROVIDER-FIPS>    <span class=md-ellipsis-custom> OSSL_PROVIDER-FIPS </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../OSSL_PROVIDER-base/ title=OSSL_PROVIDER-base>    <span class=md-ellipsis-custom> OSSL_PROVIDER-base </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../OSSL_PROVIDER-default/ title=OSSL_PROVIDER-default>    <span class=md-ellipsis-custom> OSSL_PROVIDER-default </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../OSSL_PROVIDER-legacy/ title=OSSL_PROVIDER-legacy>    <span class=md-ellipsis-custom> OSSL_PROVIDER-legacy </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../OSSL_PROVIDER-null/ title=OSSL_PROVIDER-null>    <span class=md-ellipsis-custom> OSSL_PROVIDER-null </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../OSSL_STORE-winstore/ title=OSSL_STORE-winstore>    <span class=md-ellipsis-custom> OSSL_STORE-winstore </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../RAND/ title=RAND>    <span class=md-ellipsis-custom> RAND </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-RSA title=RSA>    <span class=md-ellipsis-custom> RSA </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../RSA-PSS/ title=RSA-PSS>    <span class=md-ellipsis-custom> RSA-PSS </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-SM2 title=SM2>    <span class=md-ellipsis-custom> SM2 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../X25519/ title=X25519>    <span class=md-ellipsis-custom> X25519 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../X25519 title=X448>    <span class=md-ellipsis-custom> X448 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../bio/ title=bio>    <span class=md-ellipsis-custom> bio </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../ossl-guide-libcrypto-introduction title=crypto>    <span class=md-ellipsis-custom> crypto </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../ct/ title=ct>    <span class=md-ellipsis-custom> ct </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../des_modes/ title=des_modes>    <span class=md-ellipsis-custom> des_modes </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../evp/ title=evp>    <span class=md-ellipsis-custom> evp </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../fips_module/ title=fips_module>    <span class=md-ellipsis-custom> fips_module </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../life_cycle-cipher/ title=life_cycle-cipher>    <span class=md-ellipsis-custom> life_cycle-cipher </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../life_cycle-digest/ title=life_cycle-digest>    <span class=md-ellipsis-custom> life_cycle-digest </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../life_cycle-kdf/ title=life_cycle-kdf>    <span class=md-ellipsis-custom> life_cycle-kdf </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../life_cycle-mac/ title=life_cycle-mac>    <span class=md-ellipsis-custom> life_cycle-mac </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../life_cycle-pkey/ title=life_cycle-pkey>    <span class=md-ellipsis-custom> life_cycle-pkey </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../life_cycle-rand/ title=life_cycle-rand>    <span class=md-ellipsis-custom> life_cycle-rand </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../ossl-guide-migration title=migration_guide>    <span class=md-ellipsis-custom> migration_guide </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-core.h/ title=openssl-core.h>    <span class=md-ellipsis-custom> openssl-core.h </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-core_dispatch.h/ title=openssl-core_dispatch.h>    <span class=md-ellipsis-custom> openssl-core_dispatch.h </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-core_names.h/ title=openssl-core_names.h>    <span class=md-ellipsis-custom> openssl-core_names.h </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-env/ title=openssl-env>    <span class=md-ellipsis-custom> openssl-env </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-glossary/ title=openssl-glossary>    <span class=md-ellipsis-custom> openssl-glossary </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-qlog/ title=openssl-qlog>    <span class=md-ellipsis-custom> openssl-qlog </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-quic/ title=openssl-quic>    <span class=md-ellipsis-custom> openssl-quic </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-threads/ title=openssl-threads>    <span class=md-ellipsis-custom> openssl-threads </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl_user_macros/ title=openssl_user_macros>    <span class=md-ellipsis-custom> openssl_user_macros </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../ossl-guide-introduction/ title=ossl-guide-introduction>    <span class=md-ellipsis-custom> ossl-guide-introduction </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../ossl-guide-libcrypto-introduction/ title=ossl-guide-libcrypto-introduction>    <span class=md-ellipsis-custom> ossl-guide-libcrypto-introduction </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../ossl-guide-libraries-introduction/ title=ossl-guide-libraries-introduction>    <span class=md-ellipsis-custom> ossl-guide-libraries-introduction </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../ossl-guide-libssl-introduction/ title=ossl-guide-libssl-introduction>    <span class=md-ellipsis-custom> ossl-guide-libssl-introduction </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../ossl-guide-migration/ title=ossl-guide-migration>    <span class=md-ellipsis-custom> ossl-guide-migration </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../ossl-guide-quic-client-block/ title=ossl-guide-quic-client-block>    <span class=md-ellipsis-custom> ossl-guide-quic-client-block </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../ossl-guide-quic-client-non-block/ title=ossl-guide-quic-client-non-block>    <span class=md-ellipsis-custom> ossl-guide-quic-client-non-block </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../ossl-guide-quic-introduction/ title=ossl-guide-quic-introduction>    <span class=md-ellipsis-custom> ossl-guide-quic-introduction </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../ossl-guide-quic-multi-stream/ title=ossl-guide-quic-multi-stream>    <span class=md-ellipsis-custom> ossl-guide-quic-multi-stream </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../ossl-guide-tls-client-block/ title=ossl-guide-tls-client-block>    <span class=md-ellipsis-custom> ossl-guide-tls-client-block </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../ossl-guide-tls-client-non-block/ title=ossl-guide-tls-client-non-block>    <span class=md-ellipsis-custom> ossl-guide-tls-client-non-block </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../ossl-guide-tls-introduction/ title=ossl-guide-tls-introduction>    <span class=md-ellipsis-custom> ossl-guide-tls-introduction </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../ossl_store/ title=ossl_store>    <span class=md-ellipsis-custom> ossl_store </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../ossl_store-file/ title=ossl_store-file>    <span class=md-ellipsis-custom> ossl_store-file </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../passphrase-encoding/ title=passphrase-encoding>    <span class=md-ellipsis-custom> passphrase-encoding </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../property/ title=property>    <span class=md-ellipsis-custom> property </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../provider/ title=provider>    <span class=md-ellipsis-custom> provider </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../provider-asym_cipher/ title=provider-asym_cipher>    <span class=md-ellipsis-custom> provider-asym_cipher </span>  </a><li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" id=__toc type=checkbox>   <label class="md-nav__link md-nav__link--active" for=__toc>   <span class=md-ellipsis-custom> provider-base </span>  <span class="md-nav__icon md-icon"></span></label> <a class="md-nav__link md-nav__link--active" href=./>    <span class=md-ellipsis-custom> provider-base </span>  </a>  <nav aria-label="Table of contents" class="md-nav md-nav--secondary"><label class=md-nav__title for=__toc><span class="md-nav__icon md-icon"></span> Table of contents</label><ul class=md-nav__list data-md-component=toc data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=#name> <span class=md-ellipsis> NAME </span> </a><li class=md-nav__item><a class=md-nav__link href=#synopsis> <span class=md-ellipsis> SYNOPSIS </span> </a><li class=md-nav__item><a class=md-nav__link href=#description> <span class=md-ellipsis> DESCRIPTION </span> </a> <nav aria-label=DESCRIPTION class=md-nav><ul class=md-nav__list><li class=md-nav__item><a class=md-nav__link href=#core-functions> <span class=md-ellipsis> Core functions </span> </a><li class=md-nav__item><a class=md-nav__link href=#provider-functions> <span class=md-ellipsis> Provider functions </span> </a><li class=md-nav__item><a class=md-nav__link href=#provider-parameters> <span class=md-ellipsis> Provider parameters </span> </a><li class=md-nav__item><a class=md-nav__link href=#core-parameters> <span class=md-ellipsis> Core parameters </span> </a></ul></nav><li class=md-nav__item><a class=md-nav__link href=#capabilities> <span class=md-ellipsis> CAPABILITIES </span> </a> <nav aria-label=CAPABILITIES class=md-nav><ul class=md-nav__list><li class=md-nav__item><a class=md-nav__link href=#tls-group-capability> <span class=md-ellipsis> "TLS-GROUP" Capability </span> </a><li class=md-nav__item><a class=md-nav__link href=#tls-sigalg-capability> <span class=md-ellipsis> "TLS-SIGALG" Capability </span> </a></ul></nav><li class=md-nav__item><a class=md-nav__link href=#notes> <span class=md-ellipsis> NOTES </span> </a><li class=md-nav__item><a class=md-nav__link href=#examples> <span class=md-ellipsis> EXAMPLES </span> </a><li class=md-nav__item><a class=md-nav__link href=#see-also> <span class=md-ellipsis> SEE ALSO </span> </a><li class=md-nav__item><a class=md-nav__link href=#history> <span class=md-ellipsis> HISTORY </span> </a><li class=md-nav__item><a class=md-nav__link href=#copyright> <span class=md-ellipsis> COPYRIGHT </span> </a></ul></nav><li class=md-nav__item> <a class=md-nav__link href=../provider-cipher/ title=provider-cipher>    <span class=md-ellipsis-custom> provider-cipher </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../provider-decoder/ title=provider-decoder>    <span class=md-ellipsis-custom> provider-decoder </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../provider-digest/ title=provider-digest>    <span class=md-ellipsis-custom> provider-digest </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../provider-encoder/ title=provider-encoder>    <span class=md-ellipsis-custom> provider-encoder </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../provider-kdf/ title=provider-kdf>    <span class=md-ellipsis-custom> provider-kdf </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../provider-kem/ title=provider-kem>    <span class=md-ellipsis-custom> provider-kem </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../provider-keyexch/ title=provider-keyexch>    <span class=md-ellipsis-custom> provider-keyexch </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../provider-keymgmt/ title=provider-keymgmt>    <span class=md-ellipsis-custom> provider-keymgmt </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../provider-mac/ title=provider-mac>    <span class=md-ellipsis-custom> provider-mac </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../provider-object/ title=provider-object>    <span class=md-ellipsis-custom> provider-object </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../provider-rand/ title=provider-rand>    <span class=md-ellipsis-custom> provider-rand </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../provider-signature/ title=provider-signature>    <span class=md-ellipsis-custom> provider-signature </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../provider-storemgmt/ title=provider-storemgmt>    <span class=md-ellipsis-custom> provider-storemgmt </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../proxy-certificates/ title=proxy-certificates>    <span class=md-ellipsis-custom> proxy-certificates </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../ossl-guide-libssl-introduction title=ssl>    <span class=md-ellipsis-custom> ssl </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../x509/ title=x509>    <span class=md-ellipsis-custom> x509 </span>  </a></ul></nav> </ul></nav></div></div></div><div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc><div class=md-sidebar__scrollwrap><div class=md-sidebar__inner><nav aria-label="Table of contents" class="md-nav md-nav--secondary"><label class=md-nav__title for=__toc><span class="md-nav__icon md-icon"></span> Table of contents</label><ul class=md-nav__list data-md-component=toc data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=#name> <span class=md-ellipsis> NAME </span> </a><li class=md-nav__item><a class=md-nav__link href=#synopsis> <span class=md-ellipsis> SYNOPSIS </span> </a><li class=md-nav__item><a class=md-nav__link href=#description> <span class=md-ellipsis> DESCRIPTION </span> </a> <nav aria-label=DESCRIPTION class=md-nav><ul class=md-nav__list><li class=md-nav__item><a class=md-nav__link href=#core-functions> <span class=md-ellipsis> Core functions </span> </a><li class=md-nav__item><a class=md-nav__link href=#provider-functions> <span class=md-ellipsis> Provider functions </span> </a><li class=md-nav__item><a class=md-nav__link href=#provider-parameters> <span class=md-ellipsis> Provider parameters </span> </a><li class=md-nav__item><a class=md-nav__link href=#core-parameters> <span class=md-ellipsis> Core parameters </span> </a></ul></nav><li class=md-nav__item><a class=md-nav__link href=#capabilities> <span class=md-ellipsis> CAPABILITIES </span> </a> <nav aria-label=CAPABILITIES class=md-nav><ul class=md-nav__list><li class=md-nav__item><a class=md-nav__link href=#tls-group-capability> <span class=md-ellipsis> "TLS-GROUP" Capability </span> </a><li class=md-nav__item><a class=md-nav__link href=#tls-sigalg-capability> <span class=md-ellipsis> "TLS-SIGALG" Capability </span> </a></ul></nav><li class=md-nav__item><a class=md-nav__link href=#notes> <span class=md-ellipsis> NOTES </span> </a><li class=md-nav__item><a class=md-nav__link href=#examples> <span class=md-ellipsis> EXAMPLES </span> </a><li class=md-nav__item><a class=md-nav__link href=#see-also> <span class=md-ellipsis> SEE ALSO </span> </a><li class=md-nav__item><a class=md-nav__link href=#history> <span class=md-ellipsis> HISTORY </span> </a><li class=md-nav__item><a class=md-nav__link href=#copyright> <span class=md-ellipsis> COPYRIGHT </span> </a></ul></nav></div></div></div><div class=md-content data-md-component=content><article class="md-content__inner md-typeset"><h1 id=provider-base>provider-base<a title="Permanent link" class=headerlink href=#provider-base>¶</a></h1><h2 id=name>NAME<a title="Permanent link" class=headerlink href=#name>¶</a></h2><p>provider-base - The basic OpenSSL library &LT-> provider functions<h2 id=synopsis>SYNOPSIS<a title="Permanent link" class=headerlink href=#synopsis>¶</a></h2><div class=highlight><pre><span></span><code>#include &LTopenssl/core_dispatch.h>

/*
 * None of these are actual functions, but are displayed like this for
 * the function signatures for functions that are offered as function
 * pointers in OSSL_DISPATCH arrays.
 */

/* Functions offered by libcrypto to the providers */
const OSSL_ITEM *core_gettable_params(const OSSL_CORE_HANDLE *handle);
int core_get_params(const OSSL_CORE_HANDLE *handle, OSSL_PARAM params[]);

typedef void (*OSSL_thread_stop_handler_fn)(void *arg);
int core_thread_start(const OSSL_CORE_HANDLE *handle,
                      OSSL_thread_stop_handler_fn handfn,
                      void *arg);

OPENSSL_CORE_CTX *core_get_libctx(const OSSL_CORE_HANDLE *handle);
void core_new_error(const OSSL_CORE_HANDLE *handle);
void core_set_error_debug(const OSSL_CORE_HANDLE *handle,
                          const char *file, int line, const char *func);
void core_vset_error(const OSSL_CORE_HANDLE *handle,
                     uint32_t reason, const char *fmt, va_list args);

int core_obj_add_sigid(const OSSL_CORE_HANDLE *prov, const char  *sign_name,
                       const char *digest_name, const char *pkey_name);
int core_obj_create(const OSSL_CORE_HANDLE *handle, const char *oid,
                    const char *sn, const char *ln);

/*
 * Some OpenSSL functionality is directly offered to providers via
 * dispatch
 */
void *CRYPTO_malloc(size_t num, const char *file, int line);
void *CRYPTO_zalloc(size_t num, const char *file, int line);
void CRYPTO_free(void *ptr, const char *file, int line);
void CRYPTO_clear_free(void *ptr, size_t num,
                       const char *file, int line);
void *CRYPTO_realloc(void *addr, size_t num,
                     const char *file, int line);
void *CRYPTO_clear_realloc(void *addr, size_t old_num, size_t num,
                           const char *file, int line);
void *CRYPTO_secure_malloc(size_t num, const char *file, int line);
void *CRYPTO_secure_zalloc(size_t num, const char *file, int line);
void CRYPTO_secure_free(void *ptr, const char *file, int line);
void CRYPTO_secure_clear_free(void *ptr, size_t num,
                              const char *file, int line);
int CRYPTO_secure_allocated(const void *ptr);
void OPENSSL_cleanse(void *ptr, size_t len);

unsigned char *OPENSSL_hexstr2buf(const char *str, long *buflen);

OSSL_CORE_BIO *BIO_new_file(const char *filename, const char *mode);
OSSL_CORE_BIO *BIO_new_membuf(const void *buf, int len);
int BIO_read_ex(OSSL_CORE_BIO *bio, void *data, size_t data_len,
                size_t *bytes_read);
int BIO_write_ex(OSSL_CORE_BIO *bio, const void *data, size_t data_len,
                 size_t *written);
int BIO_up_ref(OSSL_CORE_BIO *bio);
int BIO_free(OSSL_CORE_BIO *bio);
int BIO_vprintf(OSSL_CORE_BIO *bio, const char *format, va_list args);
int BIO_vsnprintf(char *buf, size_t n, const char *fmt, va_list args);

void OSSL_SELF_TEST_set_callback(OSSL_LIB_CTX *libctx, OSSL_CALLBACK *cb,
                                 void *cbarg);

size_t get_entropy(const OSSL_CORE_HANDLE *handle,
                   unsigned char **pout, int entropy,
                   size_t min_len, size_t max_len);
size_t get_user_entropy(const OSSL_CORE_HANDLE *handle,
                        unsigned char **pout, int entropy,
                        size_t min_len, size_t max_len);
void cleanup_entropy(const OSSL_CORE_HANDLE *handle,
                     unsigned char *buf, size_t len);
void cleanup_user_entropy(const OSSL_CORE_HANDLE *handle,
                          unsigned char *buf, size_t len);
size_t get_nonce(const OSSL_CORE_HANDLE *handle,
                 unsigned char **pout, size_t min_len, size_t max_len,
                 const void *salt, size_t salt_len);
size_t get_user_nonce(const OSSL_CORE_HANDLE *handle,
                      unsigned char **pout, size_t min_len, size_t max_len,
                      const void *salt, size_t salt_len);
void cleanup_nonce(const OSSL_CORE_HANDLE *handle,
                   unsigned char *buf, size_t len);
void cleanup_user_nonce(const OSSL_CORE_HANDLE *handle,
                        unsigned char *buf, size_t len);

/* Functions for querying the providers in the application library context */
int provider_register_child_cb(const OSSL_CORE_HANDLE *handle,
                    int (*create_cb)(const OSSL_CORE_HANDLE *provider,
                                     void *cbdata),
                    int (*remove_cb)(const OSSL_CORE_HANDLE *provider,
                                     void *cbdata),
                    int (*global_props_cb)(const char *props, void *cbdata),
                    void *cbdata);
void provider_deregister_child_cb(const OSSL_CORE_HANDLE *handle);
const char *provider_name(const OSSL_CORE_HANDLE *prov);
void *provider_get0_provider_ctx(const OSSL_CORE_HANDLE *prov);
const OSSL_DISPATCH *provider_get0_dispatch(const OSSL_CORE_HANDLE *prov);
int provider_up_ref(const OSSL_CORE_HANDLE *prov, int activate);
int provider_free(const OSSL_CORE_HANDLE *prov, int deactivate);

/* Functions offered by the provider to libcrypto */
void provider_teardown(void *provctx);
const OSSL_ITEM *provider_gettable_params(void *provctx);
int provider_get_params(void *provctx, OSSL_PARAM params[]);
const OSSL_ALGORITHM *provider_query_operation(void *provctx,
                                               int operation_id,
                                               const int *no_store);
void provider_unquery_operation(void *provctx, int operation_id,
                                const OSSL_ALGORITHM *algs);
const OSSL_ITEM *provider_get_reason_strings(void *provctx);
int provider_get_capabilities(void *provctx, const char *capability,
                              OSSL_CALLBACK *cb, void *arg);
int provider_self_test(void *provctx);
</code></pre></div><h2 id=description>DESCRIPTION<a title="Permanent link" class=headerlink href=#description>¶</a></h2><p>All "functions" mentioned here are passed as function pointers between <code>libcrypto</code> and the provider in <a href=../../man3/OSSL_DISPATCH/>OSSL_DISPATCH(3)</a> arrays, in the call of the provider initialization function. See <a href=../provider/>"Provider" in provider(7)</a> for a description of the initialization function. They are known as "upcalls".<p>All these "functions" have a corresponding function type definition named <strong>OSSL_FUNC_{name}_fn</strong>, and a helper function to retrieve the function pointer from a <a href=../../man3/OSSL_DISPATCH/>OSSL_DISPATCH(3)</a> element named <strong>OSSL_FUNC_{name}</strong>. For example, the "function" core_gettable_params() has these:<div class=highlight><pre><span></span><code>typedef OSSL_PARAM *
    (OSSL_FUNC_core_gettable_params_fn)(const OSSL_CORE_HANDLE *handle);
static ossl_inline OSSL_NAME_core_gettable_params_fn
    OSSL_FUNC_core_gettable_params(const OSSL_DISPATCH *opf);
</code></pre></div><p><a href=../../man3/OSSL_DISPATCH/>OSSL_DISPATCH(3)</a> arrays are indexed by numbers that are provided as macros in <a href=../openssl-core_dispatch.h/>openssl-core_dispatch.h(7)</a>, as follows:<p>For <em>in</em> (the <a href=../../man3/OSSL_DISPATCH/>OSSL_DISPATCH(3)</a> array passed from <code>libcrypto</code> to the provider):<div class=highlight><pre><span></span><code>core_gettable_params           OSSL_FUNC_CORE_GETTABLE_PARAMS
core_get_params                OSSL_FUNC_CORE_GET_PARAMS
core_thread_start              OSSL_FUNC_CORE_THREAD_START
core_get_libctx                OSSL_FUNC_CORE_GET_LIBCTX
core_new_error                 OSSL_FUNC_CORE_NEW_ERROR
core_set_error_debug           OSSL_FUNC_CORE_SET_ERROR_DEBUG
core_vset_error                OSSL_FUNC_CORE_VSET_ERROR
core_obj_add_sigid             OSSL_FUNC_CORE_OBJ_ADD_SIGID
core_obj_create                OSSL_FUNC_CORE_OBJ_CREATE
CRYPTO_malloc                  OSSL_FUNC_CRYPTO_MALLOC
CRYPTO_zalloc                  OSSL_FUNC_CRYPTO_ZALLOC
CRYPTO_free                    OSSL_FUNC_CRYPTO_FREE
CRYPTO_clear_free              OSSL_FUNC_CRYPTO_CLEAR_FREE
CRYPTO_realloc                 OSSL_FUNC_CRYPTO_REALLOC
CRYPTO_clear_realloc           OSSL_FUNC_CRYPTO_CLEAR_REALLOC
CRYPTO_secure_malloc           OSSL_FUNC_CRYPTO_SECURE_MALLOC
CRYPTO_secure_zalloc           OSSL_FUNC_CRYPTO_SECURE_ZALLOC
CRYPTO_secure_free             OSSL_FUNC_CRYPTO_SECURE_FREE
CRYPTO_secure_clear_free       OSSL_FUNC_CRYPTO_SECURE_CLEAR_FREE
CRYPTO_secure_allocated        OSSL_FUNC_CRYPTO_SECURE_ALLOCATED
BIO_new_file                   OSSL_FUNC_BIO_NEW_FILE
BIO_new_mem_buf                OSSL_FUNC_BIO_NEW_MEMBUF
BIO_read_ex                    OSSL_FUNC_BIO_READ_EX
BIO_write_ex                   OSSL_FUNC_BIO_WRITE_EX
BIO_up_ref                     OSSL_FUNC_BIO_UP_REF
BIO_free                       OSSL_FUNC_BIO_FREE
BIO_vprintf                    OSSL_FUNC_BIO_VPRINTF
BIO_vsnprintf                  OSSL_FUNC_BIO_VSNPRINTF
BIO_puts                       OSSL_FUNC_BIO_PUTS
BIO_gets                       OSSL_FUNC_BIO_GETS
BIO_ctrl                       OSSL_FUNC_BIO_CTRL
OPENSSL_cleanse                OSSL_FUNC_OPENSSL_CLEANSE
OSSL_SELF_TEST_set_callback    OSSL_FUNC_SELF_TEST_CB
ossl_rand_get_entropy          OSSL_FUNC_GET_ENTROPY
ossl_rand_get_user_entropy     OSSL_FUNC_GET_USER_ENTROPY
ossl_rand_cleanup_entropy      OSSL_FUNC_CLEANUP_ENTROPY
ossl_rand_cleanup_user_entropy OSSL_FUNC_CLEANUP_USER_ENTROPY
ossl_rand_get_nonce            OSSL_FUNC_GET_NONCE
ossl_rand_get_user_nonce       OSSL_FUNC_GET_USER_NONCE
ossl_rand_cleanup_nonce        OSSL_FUNC_CLEANUP_NONCE
ossl_rand_cleanup_user_nonce   OSSL_FUNC_CLEANUP_USER_NONCE
provider_register_child_cb     OSSL_FUNC_PROVIDER_REGISTER_CHILD_CB
provider_deregister_child_cb   OSSL_FUNC_PROVIDER_DEREGISTER_CHILD_CB
provider_name                  OSSL_FUNC_PROVIDER_NAME
provider_get0_provider_ctx     OSSL_FUNC_PROVIDER_GET0_PROVIDER_CTX
provider_get0_dispatch         OSSL_FUNC_PROVIDER_GET0_DISPATCH
provider_up_ref                OSSL_FUNC_PROVIDER_UP_REF
provider_free                  OSSL_FUNC_PROVIDER_FREE
</code></pre></div><p>For <em>*out</em> (the <a href=../../man3/OSSL_DISPATCH/>OSSL_DISPATCH(3)</a> array passed from the provider to <code>libcrypto</code>):<div class=highlight><pre><span></span><code>provider_teardown              OSSL_FUNC_PROVIDER_TEARDOWN
provider_gettable_params       OSSL_FUNC_PROVIDER_GETTABLE_PARAMS
provider_get_params            OSSL_FUNC_PROVIDER_GET_PARAMS
provider_query_operation       OSSL_FUNC_PROVIDER_QUERY_OPERATION
provider_unquery_operation     OSSL_FUNC_PROVIDER_UNQUERY_OPERATION
provider_get_reason_strings    OSSL_FUNC_PROVIDER_GET_REASON_STRINGS
provider_get_capabilities      OSSL_FUNC_PROVIDER_GET_CAPABILITIES
provider_self_test             OSSL_FUNC_PROVIDER_SELF_TEST
</code></pre></div><h3 id=core-functions>Core functions<a title="Permanent link" class=headerlink href=#core-functions>¶</a></h3><p>core_gettable_params() returns a constant array of descriptor <a href=../../man3/OSSL_PARAM/>OSSL_PARAM(3)</a>, for parameters that core_get_params() can handle.<p>core_get_params() retrieves parameters from the core for the given <em>handle</em>. See <a href=#core-parameters>"Core parameters"</a> below for a description of currently known parameters.<p>The core_thread_start() function informs the core that the provider has stated an interest in the current thread. The core will inform the provider when the thread eventually stops. It must be passed the <em>handle</em> for this provider, as well as a callback <em>handfn</em> which will be called when the thread stops. The callback will subsequently be called, with the supplied argument <em>arg</em>, from the thread that is stopping and gets passed the provider context as an argument. This may be useful to perform thread specific clean up such as freeing thread local variables.<p>core_get_libctx() retrieves the core context in which the library object for the current provider is stored, accessible through the <em>handle</em>. This function is useful only for built-in providers such as the default provider. Never cast this to OSSL_LIB_CTX in a provider that is not built-in as the OSSL_LIB_CTX of the library loading the provider might be a completely different structure than the OSSL_LIB_CTX of the library the provider is linked to. Use <a href=../../man3/OSSL_LIB_CTX/>OSSL_LIB_CTX_new_child(3)</a> instead to obtain a proper library context that is linked to the application library context.<p>core_new_error(), core_set_error_debug() and core_vset_error() are building blocks for reporting an error back to the core, with reference to the <em>handle</em>.<ul><li><p>core_new_error()</p> <p>allocates a new thread specific error record.</p> <p>This corresponds to the OpenSSL function <a href=../../man3/ERR_new/>ERR_new(3)</a>.</p><li><p>core_set_error_debug()</p> <p>sets debugging information in the current thread specific error record. The debugging information includes the name of the file <em>file</em>, the line <em>line</em> and the function name <em>func</em> where the error occurred.</p> <p>This corresponds to the OpenSSL function <a href=../../man3/ERR_new/>ERR_set_debug(3)</a>.</p><li><p>core_vset_error()</p> <p>sets the <em>reason</em> for the error, along with any addition data. The <em>reason</em> is a number defined by the provider and used to index the reason strings table that's returned by provider_get_reason_strings(). The additional data is given as a format string <em>fmt</em> and a set of arguments <em>args</em>, which are treated in the same manner as with BIO_vsnprintf(). <em>file</em> and <em>line</em> may also be passed to indicate exactly where the error occurred or was reported.</p> <p>This corresponds to the OpenSSL function <a href=../../man3/ERR_new/>ERR_vset_error(3)</a>.</p></ul><p>The core_obj_create() function registers a new OID and associated short name <em>sn</em> and long name <em>ln</em> for the given <em>handle</em>. It is similar to the OpenSSL function <a href=../../man3/OBJ_nid2obj/>OBJ_create(3)</a> except that it returns 1 on success or 0 on failure. It will treat as success the case where the OID already exists (even if the short name <em>sn</em> or long name <em>ln</em> provided as arguments differ from those associated with the existing OID, in which case the new names are not associated).<p>The core_obj_add_sigid() function registers a new composite signature algorithm (<em>sign_name</em>) consisting of an underlying signature algorithm (<em>pkey_name</em>) and digest algorithm (<em>digest_name</em>) for the given <em>handle</em>. It assumes that the OIDs for the composite signature algorithm as well as for the underlying signature and digest algorithms are either already known to OpenSSL or have been registered via a call to core_obj_create(). It corresponds to the OpenSSL function <a href=../../man3/OBJ_nid2obj/>OBJ_add_sigid(3)</a>, except that the objects are identified by name rather than a numeric NID. Any name (OID, short name or long name) can be used to identify the object. It will treat as success the case where the composite signature algorithm already exists (even if registered against a different underlying signature or digest algorithm). For <em>digest_name</em>, NULL or an empty string is permissible for signature algorithms that do not need a digest to operate correctly. The function returns 1 on success or 0 on failure.<p>CRYPTO_malloc(), CRYPTO_zalloc(), CRYPTO_free(), CRYPTO_clear_free(), CRYPTO_realloc(), CRYPTO_clear_realloc(), CRYPTO_secure_malloc(), CRYPTO_secure_zalloc(), CRYPTO_secure_free(), CRYPTO_secure_clear_free(), CRYPTO_secure_allocated(), BIO_new_file(), BIO_new_mem_buf(), BIO_read_ex(), BIO_write_ex(), BIO_up_ref(), BIO_free(), BIO_vprintf(), BIO_vsnprintf(), BIO_gets(), BIO_puts(), BIO_ctrl(), OPENSSL_cleanse() and OPENSSL_hexstr2buf() correspond exactly to the public functions with the same name. As a matter of fact, the pointers in the <a href=../../man3/OSSL_DISPATCH/>OSSL_DISPATCH(3)</a> array are typically direct pointers to those public functions. Note that the BIO functions take an <strong>OSSL_CORE_BIO</strong> type rather than the standard <strong>BIO</strong> type. This is to ensure that a provider does not mix BIOs from the core with BIOs used on the provider side (the two are not compatible). OSSL_SELF_TEST_set_callback() is used to set an optional callback that can be passed into a provider. This may be ignored by a provider.<p>get_entropy() retrieves seeding material from the operating system. The seeding material will have at least <em>entropy</em> bytes of randomness and the output will have at least <em>min_len</em> and at most <em>max_len</em> bytes. The buffer address is stored in <em>*pout</em> and the buffer length is returned to the caller. On error, zero is returned.<p>get_user_entropy() is the same as get_entropy() except that it will attempt to gather seed material via the seed source specified by a call to <a href=../../man3/RAND_set_DRBG_type/>RAND_set_seed_source_type(3)</a> or via <a href=../../man5/config/>"Random Configuration" in config(5)</a>.<p>cleanup_entropy() is used to clean up and free the buffer returned by get_entropy(). The entropy pointer returned by get_entropy() is passed in <strong>buf</strong> and its length in <strong>len</strong>.<p>cleanup_user_entropy() is used to clean up and free the buffer returned by get_user_entropy(). The entropy pointer returned by get_user_entropy() is passed in <strong>buf</strong> and its length in <strong>len</strong>.<p>get_nonce() retrieves a nonce using the passed <em>salt</em> parameter of length <em>salt_len</em> and operating system specific information. The <em>salt</em> should contain uniquely identifying information and this is included, in an unspecified manner, as part of the output. The output is stored in a buffer which contains at least <em>min_len</em> and at most <em>max_len</em> bytes. The buffer address is stored in <em>*pout</em> and the buffer length returned to the caller. On error, zero is returned.<p>get_user_nonce() is the same as get_nonce() except that it will attempt to gather seed material via the seed source specified by a call to <a href=../../man3/RAND_set_DRBG_type/>RAND_set_seed_source_type(3)</a> or via <a href=../../man5/config/>"Random Configuration" in config(5)</a>.<p>cleanup_nonce() is used to clean up and free the buffer returned by get_nonce(). The nonce pointer returned by get_nonce() is passed in <strong>buf</strong> and its length in <strong>len</strong>.<p>cleanup_user_nonce() is used to clean up and free the buffer returned by get_user_nonce(). The nonce pointer returned by get_user_nonce() is passed in <strong>buf</strong> and its length in <strong>len</strong>.<p>provider_register_child_cb() registers callbacks for being informed about the loading and unloading of providers in the application's library context. <em>handle</em> is this provider's handle and <em>cbdata</em> is this provider's data that will be passed back to the callbacks. It returns 1 on success or 0 otherwise. These callbacks may be called while holding locks in libcrypto. In order to avoid deadlocks the callback implementation must not be long running and must not call other OpenSSL API functions or upcalls.<p><em>create_cb</em> is a callback that will be called when a new provider is loaded into the application's library context. It is also called for any providers that are already loaded at the point that this callback is registered. The callback is passed the handle being used for the new provider being loadded and this provider's data in <em>cbdata</em>. It should return 1 on success or 0 on failure.<p><em>remove_cb</em> is a callback that will be called when a new provider is unloaded from the application's library context. It is passed the handle being used for the provider being unloaded and this provider's data in <em>cbdata</em>. It should return 1 on success or 0 on failure.<p><em>global_props_cb</em> is a callback that will be called when the global properties from the parent library context are changed. It should return 1 on success or 0 on failure.<p>provider_deregister_child_cb() unregisters callbacks previously registered via provider_register_child_cb(). If provider_register_child_cb() has been called then provider_deregister_child_cb() should be called at or before the point that this provider's teardown function is called.<p>provider_name() returns a string giving the name of the provider identified by <em>handle</em>.<p>provider_get0_provider_ctx() returns the provider context that is associated with the provider identified by <em>prov</em>.<p>provider_get0_dispatch() gets the dispatch table registered by the provider identified by <em>prov</em> when it initialised.<p>provider_up_ref() increments the reference count on the provider <em>prov</em>. If <em>activate</em> is nonzero then the provider is also loaded if it is not already loaded. It returns 1 on success or 0 on failure.<p>provider_free() decrements the reference count on the provider <em>prov</em>. If <em>deactivate</em> is nonzero then the provider is also unloaded if it is not already loaded. It returns 1 on success or 0 on failure.<h3 id=provider-functions>Provider functions<a title="Permanent link" class=headerlink href=#provider-functions>¶</a></h3><p>provider_teardown() is called when a provider is shut down and removed from the core's provider store. It must free the passed <em>provctx</em>.<p>provider_gettable_params() should return a constant array of descriptor <a href=../../man3/OSSL_PARAM/>OSSL_PARAM(3)</a>, for parameters that provider_get_params() can handle.<p>provider_get_params() should process the <a href=../../man3/OSSL_PARAM/>OSSL_PARAM(3)</a> array <em>params</em>, setting the values of the parameters it understands.<p>provider_query_operation() should return a constant <a href=../../man3/OSSL_ALGORITHM/>OSSL_ALGORITHM(3)</a> that corresponds to the given <em>operation_id</em>. It should indicate if the core may store a reference to this array by setting <em>*no_store</em> to 0 (core may store a reference) or 1 (core may not store a reference).<p>provider_unquery_operation() informs the provider that the result of a provider_query_operation() is no longer directly required and that the function pointers have been copied. The <em>operation_id</em> should match that passed to provider_query_operation() and <em>algs</em> should be its return value.<p>provider_get_reason_strings() should return a constant <a href=../../man3/OSSL_ITEM/>OSSL_ITEM(3)</a> array that provides reason strings for reason codes the provider may use when reporting errors using core_put_error().<p>The provider_get_capabilities() function should call the callback <em>cb</em> passing it a set of <a href=../../man3/OSSL_PARAM/>OSSL_PARAM(3)</a>s and the caller supplied argument <em>arg</em>. The <a href=../../man3/OSSL_PARAM/>OSSL_PARAM(3)</a>s should provide details about the capability with the name given in the <em>capability</em> argument relevant for the provider context <em>provctx</em>. If a provider supports multiple capabilities with the given name then it may call the callback multiple times (one for each capability). Capabilities can be useful for describing the services that a provider can offer. For further details see the <a href=#capabilities>"CAPABILITIES"</a> section below. It should return 1 on success or 0 on error.<p>The provider_self_test() function should perform known answer tests on a subset of the algorithms that it uses, and may also verify the integrity of the provider module. It should return 1 on success or 0 on error. It will return 1 if this function is not used.<p>None of these functions are mandatory, but a provider is fairly useless without at least provider_query_operation(), and provider_gettable_params() is fairly useless if not accompanied by provider_get_params().<h3 id=provider-parameters>Provider parameters<a title="Permanent link" class=headerlink href=#provider-parameters>¶</a></h3><p>provider_get_params() can return the following provider parameters to the core:<ul><li><p>"name" (<strong>OSSL_PROV_PARAM_NAME</strong>) <utf8 ptr> <p>This points to a string that should give a unique name for the provider.</p> <li><p>"version" (<strong>OSSL_PROV_PARAM_VERSION</strong>) <utf8 ptr> <p>This points to a string that is a version number associated with this provider. OpenSSL in-built providers use OPENSSL_VERSION_STR, but this may be different for any third party provider. This string is for informational purposes only.</p> <li><p>"buildinfo" (<strong>OSSL_PROV_PARAM_BUILDINFO</strong>) <utf8 ptr> <p>This points to a string that is a build information associated with this provider. OpenSSL in-built providers use OPENSSL_FULL_VERSION_STR, but this may be different for any third party provider.</p> <li><p>"status" (<strong>OSSL_PROV_PARAM_STATUS</strong>) &LTunsigned integer></p> <p>This returns 0 if the provider has entered an error state, otherwise it returns 1.</p></li> <p>provider_gettable_params() should return the above parameters.</p> <h3 id=core-parameters>Core parameters<a title="Permanent link" class=headerlink href=#core-parameters>¶</a></h3> <p>core_get_params() can retrieve the following core parameters for each provider:</p> <ul><li><p>"openssl-version" (<strong>OSSL_PROV_PARAM_CORE_VERSION</strong>) <utf8 ptr string> <p>This points to the OpenSSL libraries' full version string, i.e. the string expanded from the macro <strong>OPENSSL_VERSION_STR</strong>.</p> <li><p>"provider-name" (<strong>OSSL_PROV_PARAM_CORE_PROV_NAME</strong>) <utf8 ptr string> <p>This points to the OpenSSL libraries' idea of what the calling provider is named.</p> <li><p>"module-filename" (<strong>OSSL_PROV_PARAM_CORE_MODULE_FILENAME</strong>) <utf8 ptr string> <p>This points to a string containing the full filename of the providers module file.</p> <p>Additionally, provider specific configuration parameters from the config file are available, in dotted name form. The dotted name form is a concatenation of section names and final config command name separated by periods.</p> <p>For example, let's say we have the following config example:</p> <div class=highlight><pre><span></span><code>config_diagnostics = 1
openssl_conf = openssl_init

[openssl_init]
providers = providers_sect

[providers_sect]
foo = foo_sect

[foo_sect]
activate = 1
data1 = 2
data2 = str
more = foo_more

[foo_more]
data3 = foo,bar
</code></pre></div> <p>The provider will have these additional parameters available:</p> <ul><li><p>"activate"</p> <p>pointing at the string "1"</p><li><p>"data1"</p> <p>pointing at the string "2"</p><li><p>"data2"</p> <p>pointing at the string "str"</p><li><p>"more.data3"</p> <p>pointing at the string "foo,bar"</p></ul> <p>For more information on handling parameters, see <a href=../../man3/OSSL_PARAM/>OSSL_PARAM(3)</a> as <a href=../../man3/OSSL_PARAM_int/>OSSL_PARAM_int(3)</a>.</p> <h2 id=capabilities>CAPABILITIES<a title="Permanent link" class=headerlink href=#capabilities>¶</a></h2> <p>Capabilities describe some of the services that a provider can offer. Applications can query the capabilities to discover those services.</p> <h4 id=tls-group-capability>"TLS-GROUP" Capability<a title="Permanent link" class=headerlink href=#tls-group-capability>¶</a></h4> <p>The "TLS-GROUP" capability can be queried by libssl to discover the list of TLS groups that a provider can support. Each group supported can be used for <em>key exchange</em> (KEX) or <em>key encapsulation method</em> (KEM) during a TLS handshake. TLS clients can advertise the list of TLS groups they support in the supported_groups extension, and TLS servers can select a group from the offered list that they also support. In this way a provider can add to the list of groups that libssl already supports with additional ones.</p> <p>Each TLS group that a provider supports should be described via the callback passed in through the provider_get_capabilities function. Each group should have the following details supplied (all are mandatory, except <strong>OSSL_CAPABILITY_TLS_GROUP_IS_KEM</strong>):</p> <ul><li><p>"tls-group-name" (<strong>OSSL_CAPABILITY_TLS_GROUP_NAME</strong>) <utf8 string> <p>The name of the group as given in the IANA TLS Supported Groups registry <a href=https://www.iana.org/assignments/tls-parameters/tls-parameters.xhtml#tls-parameters-8>https://www.iana.org/assignments/tls-parameters/tls-parameters.xhtml#tls-parameters-8</a>.</p> <li><p>"tls-group-name-internal" (<strong>OSSL_CAPABILITY_TLS_GROUP_NAME_INTERNAL</strong>) <utf8 string> <p>The name of the group as known by the provider. This could be the same as the "tls-group-name", but does not have to be.</p> <li><p>"tls-group-id" (<strong>OSSL_CAPABILITY_TLS_GROUP_ID</strong>) &LTunsigned integer></p> <p>The TLS group id value as given in the IANA TLS Supported Groups registry.</p></li> <li><p>"tls-group-alg" (<strong>OSSL_CAPABILITY_TLS_GROUP_ALG</strong>) <utf8 string> <p>The name of a Key Management algorithm that the provider offers and that should be used with this group. Keys created should be able to support <em>key exchange</em> or <em>key encapsulation method</em> (KEM), as implied by the optional <strong>OSSL_CAPABILITY_TLS_GROUP_IS_KEM</strong> flag. The algorithm must support key and parameter generation as well as the key/parameter generation parameter, <strong>OSSL_PKEY_PARAM_GROUP_NAME</strong>. The group name given via "tls-group-name-internal" above will be passed via <strong>OSSL_PKEY_PARAM_GROUP_NAME</strong> when libssl wishes to generate keys/parameters.</p> <li><p>"tls-group-sec-bits" (<strong>OSSL_CAPABILITY_TLS_GROUP_SECURITY_BITS</strong>) &LTunsigned integer></p> <p>The number of bits of security offered by keys in this group. The number of bits should be comparable with the ones given in table 2 and 3 of the NIST SP800-57 document.</p></li> <li><p>"tls-group-is-kem" (<strong>OSSL_CAPABILITY_TLS_GROUP_IS_KEM</strong>) &LTunsigned integer></p> <p>Boolean flag to describe if the group should be used in <em>key exchange</em> (KEX) mode (0, default) or in <em>key encapsulation method</em> (KEM) mode (1).</p> <p>This parameter is optional: if not specified, KEX mode is assumed as the default mode for the group.</p> <p>In KEX mode, in a typical Diffie-Hellman fashion, both sides execute <em>keygen</em> then <em>derive</em> against the peer public key. To operate in KEX mode, the group implementation must support the provider functions as described in <a href=../provider-keyexch/>provider-keyexch(7)</a>.</p> <p>In KEM mode, the client executes <em>keygen</em> and sends its public key, the server executes <em>encapsulate</em> using the client's public key and sends back the resulting <em>ciphertext</em>, finally the client executes <em>decapsulate</em> to retrieve the same <em>shared secret</em> generated by the server's <em>encapsulate</em>. To operate in KEM mode, the group implementation must support the provider functions as described in <a href=../provider-kem/>provider-kem(7)</a>.</p> <p>Both in KEX and KEM mode, the resulting <em>shared secret</em> is then used according to the protocol specification.</p></li> <li><p>"tls-min-tls" (<strong>OSSL_CAPABILITY_TLS_GROUP_MIN_TLS</strong>) &LTinteger></p></li> <li>"tls-max-tls" (<strong>OSSL_CAPABILITY_TLS_GROUP_MAX_TLS</strong>) &LTinteger></li> <li>"tls-min-dtls" (<strong>OSSL_CAPABILITY_TLS_GROUP_MIN_DTLS</strong>) &LTinteger></li> <li><p>"tls-max-dtls" (<strong>OSSL_CAPABILITY_TLS_GROUP_MAX_DTLS</strong>) &LTinteger></p> <p>These parameters can be used to describe the minimum and maximum TLS and DTLS versions supported by the group. The values equate to the on-the-wire encoding of the various TLS versions. For example TLSv1.3 is 0x0304 (772 decimal), and TLSv1.2 is 0x0303 (771 decimal). A 0 indicates that there is no defined minimum or maximum. A -1 indicates that the group should not be used in that protocol.</p></li> <h4 id=tls-sigalg-capability>"TLS-SIGALG" Capability<a title="Permanent link" class=headerlink href=#tls-sigalg-capability>¶</a></h4> <p>The "TLS-SIGALG" capability can be queried by libssl to discover the list of TLS signature algorithms that a provider can support. Each signature supported can be used for client- or server-authentication in addition to the built-in signature algorithms. TLS1.3 clients can advertise the list of TLS signature algorithms they support in the signature_algorithms extension, and TLS servers can select an algorithm from the offered list that they also support. In this way a provider can add to the list of signature algorithms that libssl already supports with additional ones.</p> <p>Each TLS signature algorithm that a provider supports should be described via the callback passed in through the provider_get_capabilities function. Each algorithm can have the following details supplied:</p> <ul><li><p>"iana-name" (<strong>OSSL_CAPABILITY_TLS_SIGALG_IANA_NAME</strong>) <utf8 string> <p>The name of the signature algorithm as given in the IANA TLS Signature Scheme registry as "Description": <a href=https://www.iana.org/assignments/tls-parameters/tls-parameters.xhtml#tls-signaturescheme>https://www.iana.org/assignments/tls-parameters/tls-parameters.xhtml#tls-signaturescheme</a>. This value must be supplied.</p> <li><p>"iana-code-point" (<strong>OSSL_CAPABILITY_TLS_SIGALG_CODE_POINT</strong>) &LTunsigned integer></p> <p>The TLS algorithm ID value as given in the IANA TLS SignatureScheme registry. This value must be supplied.</p></li> <li><p>"sigalg-name" (<strong>OSSL_CAPABILITY_TLS_SIGALG_NAME</strong>) <utf8 string> <p>A name for the full (possibly composite hash-and-signature) signature algorithm. The provider may, but is not obligated to, provide a signature implementation with this name; if it doesn't, this is assumed to be a composite of a pure signature algorithm and a hash algorithm, which must be given with the parameters "sig-name" and "hash-name". This value must be supplied.</p> <li><p>"sigalg-oid" (<strong>OSSL_CAPABILITY_TLS_SIGALG_OID</strong>) <utf8 string> <p>The OID of the "sigalg-name" algorithm in canonical numeric text form. If this parameter is given, OBJ_create() will be used to create an OBJ and a NID for this OID, using the "sigalg-name" parameter for its (short) name. Otherwise, it's assumed to already exist in the object database, possibly done by the provider with the core_obj_create() upcall. This value is optional.</p> <li><p>"sig-name" (<strong>OSSL_CAPABILITY_TLS_SIGALG_SIG_NAME</strong>) <utf8 string> <p>The name of the pure signature algorithm that is part of a composite "sigalg-name". If "sigalg-name" is implemented by the provider, this parameter is redundant and must not be given. This value is optional.</p> <li><p>"sig-oid" (<strong>OSSL_CAPABILITY_TLS_SIGALG_SIG_OID</strong>) <utf8 string> <p>The OID of the "sig-name" algorithm in canonical numeric text form. If this parameter is given, OBJ_create() will be used to create an OBJ and a NID for this OID, using the "sig-name" parameter for its (short) name. Otherwise, it is assumed to already exist in the object database. This can be done by the provider using the core_obj_create() upcall. This value is optional.</p> <li><p>"hash-name" (<strong>OSSL_CAPABILITY_TLS_SIGALG_HASH_NAME</strong>) <utf8 string> <p>The name of the hash algorithm that is part of a composite "sigalg-name". If "sigalg-name" is implemented by the provider, this parameter is redundant and must not be given. This value is optional.</p> <li><p>"hash-oid" (<strong>OSSL_CAPABILITY_TLS_SIGALG_HASH_OID</strong>) <utf8 string> <p>The OID of the "hash-name" algorithm in canonical numeric text form. If this parameter is given, OBJ_create() will be used to create an OBJ and a NID for this OID, using the "hash-name" parameter for its (short) name. Otherwise, it's assumed to already exist in the object database, possibly done by the provider with the core_obj_create() upcall. This value is optional.</p> <li><p>"key-type" (<strong>OSSL_CAPABILITY_TLS_SIGALG_KEYTYPE</strong>) <utf8 string> <p>The key type of the public key of applicable certificates. If this parameter isn't present, it's assumed to be the same as "sig-name" if that's present, otherwise "sigalg-name". This value is optional.</p> <li><p>"key-type-oid" (<strong>OSSL_CAPABILITY_TLS_SIGALG_KEYTYPE_OID</strong>) <utf8 string> <p>The OID of the "key-type" in canonical numeric text form. If this parameter is given, OBJ_create() will be used to create an OBJ and a NID for this OID, using the "key-type" parameter for its (short) name. Otherwise, it's assumed to already exist in the object database, possibly done by the provider with the core_obj_create() upcall. This value is optional.</p> <li><p>"sec-bits" (<strong>OSSL_CAPABILITY_TLS_SIGALG_SECURITY_BITS</strong>) &LTunsigned integer></p> <p>The number of bits of security offered by keys of this algorithm. The number of bits should be comparable with the ones given in table 2 and 3 of the NIST SP800-57 document. This number is used to determine the security strength of the algorithm if no digest algorithm has been registered that otherwise defines the security strength. If the signature algorithm implements its own digest internally, this value needs to be set to properly reflect the overall security strength. This value must be supplied.</p></li> <li><p>"tls-min-tls" (<strong>OSSL_CAPABILITY_TLS_SIGALG_MIN_TLS</strong>) &LTinteger></p></li> <li><p>"tls-max-tls" (<strong>OSSL_CAPABILITY_TLS_SIGALG_MAX_TLS</strong>) &LTinteger></p> <p>These parameters can be used to describe the minimum and maximum TLS versions supported by the signature algorithm. The values equate to the on-the-wire encoding of the various TLS versions. For example TLSv1.3 is 0x0304 (772 decimal), and TLSv1.2 is 0x0303 (771 decimal). A 0 indicates that there is no defined minimum or maximum. A -1 indicates that the signature algorithm should not be used in that protocol. Presently values representing anything other than TLS1.3 mean that the complete algorithm is ignored.</p></li> <h2 id=notes>NOTES<a title="Permanent link" class=headerlink href=#notes>¶</a></h2> <p>The core_obj_create() and core_obj_add_sigid() functions were not thread safe in OpenSSL 3.0.</p> <h2 id=examples>EXAMPLES<a title="Permanent link" class=headerlink href=#examples>¶</a></h2> <p>This is an example of a simple provider made available as a dynamically loadable module. It implements the fictitious algorithm <code>FOO</code> for the fictitious operation <code>BAR</code>.</p> <div class=highlight><pre><span></span><code>#include &LTmalloc.h>
#include &LTopenssl/core.h>
#include &LTopenssl/core_dispatch.h>

/* Errors used in this provider */
#define E_MALLOC       1

static const OSSL_ITEM reasons[] = {
    { E_MALLOC, "memory allocation failure" }.
    OSSL_DISPATCH_END
};

/*
 * To ensure we get the function signature right, forward declare
 * them using function types provided by openssl/core_dispatch.h
 */
OSSL_FUNC_bar_newctx_fn foo_newctx;
OSSL_FUNC_bar_freectx_fn foo_freectx;
OSSL_FUNC_bar_init_fn foo_init;
OSSL_FUNC_bar_update_fn foo_update;
OSSL_FUNC_bar_final_fn foo_final;

OSSL_FUNC_provider_query_operation_fn p_query;
OSSL_FUNC_provider_get_reason_strings_fn p_reasons;
OSSL_FUNC_provider_teardown_fn p_teardown;

OSSL_provider_init_fn OSSL_provider_init;

OSSL_FUNC_core_put_error *c_put_error = NULL;

/* Provider context */
struct prov_ctx_st {
    OSSL_CORE_HANDLE *handle;
}

/* operation context for the algorithm FOO */
struct foo_ctx_st {
    struct prov_ctx_st *provctx;
    int b;
};

static void *foo_newctx(void *provctx)
{
    struct foo_ctx_st *fooctx = malloc(sizeof(*fooctx));

    if (fooctx != NULL)
        fooctx->provctx = provctx;
    else
        c_put_error(provctx->handle, E_MALLOC, __FILE__, __LINE__);
    return fooctx;
}

static void foo_freectx(void *fooctx)
{
    free(fooctx);
}

static int foo_init(void *vfooctx)
{
    struct foo_ctx_st *fooctx = vfooctx;

    fooctx->b = 0x33;
}

static int foo_update(void *vfooctx, unsigned char *in, size_t inl)
{
    struct foo_ctx_st *fooctx = vfooctx;

    /* did you expect something serious? */
    if (inl == 0)
        return 1;
    for (; inl-- > 0; in++)
        *in ^= fooctx->b;
    return 1;
}

static int foo_final(void *vfooctx)
{
    struct foo_ctx_st *fooctx = vfooctx;

    fooctx->b = 0x66;
}

static const OSSL_DISPATCH foo_fns[] = {
    { OSSL_FUNC_BAR_NEWCTX, (void (*)(void))foo_newctx },
    { OSSL_FUNC_BAR_FREECTX, (void (*)(void))foo_freectx },
    { OSSL_FUNC_BAR_INIT, (void (*)(void))foo_init },
    { OSSL_FUNC_BAR_UPDATE, (void (*)(void))foo_update },
    { OSSL_FUNC_BAR_FINAL, (void (*)(void))foo_final },
    OSSL_DISPATCH_END
};

static const OSSL_ALGORITHM bars[] = {
    { "FOO", "provider=chumbawamba", foo_fns },
    { NULL, NULL, NULL }
};

static const OSSL_ALGORITHM *p_query(void *provctx, int operation_id,
                                     int *no_store)
{
    switch (operation_id) {
    case OSSL_OP_BAR:
        return bars;
    }
    return NULL;
}

static const OSSL_ITEM *p_reasons(void *provctx)
{
    return reasons;
}

static void p_teardown(void *provctx)
{
    free(provctx);
}

static const OSSL_DISPATCH prov_fns[] = {
    { OSSL_FUNC_PROVIDER_TEARDOWN, (void (*)(void))p_teardown },
    { OSSL_FUNC_PROVIDER_QUERY_OPERATION, (void (*)(void))p_query },
    { OSSL_FUNC_PROVIDER_GET_REASON_STRINGS, (void (*)(void))p_reasons },
    OSSL_DISPATCH_END
};

int OSSL_provider_init(const OSSL_CORE_HANDLE *handle,
                       const OSSL_DISPATCH *in,
                       const OSSL_DISPATCH **out,
                       void **provctx)
{
    struct prov_ctx_st *pctx = NULL;

    for (; in->function_id != 0; in++)
        switch (in->function_id) {
        case OSSL_FUNC_CORE_PUT_ERROR:
            c_put_error = OSSL_FUNC_core_put_error(in);
            break;
        }

    *out = prov_fns;

    if ((pctx = malloc(sizeof(*pctx))) == NULL) {
        /*
         * ALEA IACTA EST, if the core retrieves the reason table
         * regardless, that string will be displayed, otherwise not.
         */
        c_put_error(handle, E_MALLOC, __FILE__, __LINE__);
        return 0;
    }
    pctx->handle = handle;
    return 1;
}
</code></pre></div> <p>This relies on a few things existing in <code>openssl/core_dispatch.h</code>:</p> <div class=highlight><pre><span></span><code>#define OSSL_OP_BAR            4711

#define OSSL_FUNC_BAR_NEWCTX      1
typedef void *(OSSL_FUNC_bar_newctx_fn)(void *provctx);
static ossl_inline OSSL_FUNC_bar_newctx(const OSSL_DISPATCH *opf)
{ return (OSSL_FUNC_bar_newctx_fn *)opf->function; }

#define OSSL_FUNC_BAR_FREECTX     2
typedef void (OSSL_FUNC_bar_freectx_fn)(void *ctx);
static ossl_inline OSSL_FUNC_bar_freectx(const OSSL_DISPATCH *opf)
{ return (OSSL_FUNC_bar_freectx_fn *)opf->function; }

#define OSSL_FUNC_BAR_INIT        3
typedef void *(OSSL_FUNC_bar_init_fn)(void *ctx);
static ossl_inline OSSL_FUNC_bar_init(const OSSL_DISPATCH *opf)
{ return (OSSL_FUNC_bar_init_fn *)opf->function; }

#define OSSL_FUNC_BAR_UPDATE      4
typedef void *(OSSL_FUNC_bar_update_fn)(void *ctx,
                                      unsigned char *in, size_t inl);
static ossl_inline OSSL_FUNC_bar_update(const OSSL_DISPATCH *opf)
{ return (OSSL_FUNC_bar_update_fn *)opf->function; }

#define OSSL_FUNC_BAR_FINAL       5
typedef void *(OSSL_FUNC_bar_final_fn)(void *ctx);
static ossl_inline OSSL_FUNC_bar_final(const OSSL_DISPATCH *opf)
{ return (OSSL_FUNC_bar_final_fn *)opf->function; }
</code></pre></div> <h2 id=see-also>SEE ALSO<a title="Permanent link" class=headerlink href=#see-also>¶</a></h2> <p><a href=../provider/>provider(7)</a></p> <h2 id=history>HISTORY<a title="Permanent link" class=headerlink href=#history>¶</a></h2> <p>The concept of providers and everything surrounding them was introduced in OpenSSL 3.0.</p> <h2 id=copyright>COPYRIGHT<a title="Permanent link" class=headerlink href=#copyright>¶</a></h2> <p>Copyright 2019-2023 The OpenSSL Project Authors. All Rights Reserved.</p> <p>Licensed under the Apache License 2.0 (the "License"). You may not use this file except in compliance with the License. You can obtain a copy in the file LICENSE in the source distribution or at <a href=https://www.openssl.org/source/license.html>https://www.openssl.org/source/license.html</a>.</p> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> <footer class=md-footer><div class="md-footer-meta md-typeset"><div class="md-footer-meta__inner md-grid"><div class=md-copyright>Made with <a href=https://squidfunk.github.io/mkdocs-material/ rel=noopener target=_blank> Material for MkDocs </a></div></div></div></footer> <div class=md-dialog data-md-component=dialog><div class="md-dialog__inner md-typeset"></div></div> <script id=__config type=application/json>{"base": "../..", "features": ["navigation.indexes", "navigation.instant", "navigation.path", "navigation.prune", "navigation.tabs", "navigation.tabs.sticky", "navigation.tracking", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "master", "provider": "mike"}}</script> <script src=../../assets/javascripts/bundle.ad660dcc.min.js></script> 