<!doctype html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link href=https://docs.openssl.org/3.4/man1/openssl-pkeyutl/ rel=canonical><link href=../openssl-pkeyparam/ rel=prev><link href=../openssl-prime/ rel=next><link rel=icon href=../../images/favicon.ico><meta name=generator content="mkdocs-1.6.0, mkdocs-material-9.5.27"><title>openssl-pkeyutl - OpenSSL Documentation</title><link rel=stylesheet href=../../assets/stylesheets/main.6543a935.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../stylesheets/extra.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>
  function __md_analytics() {

    var script = document.createElement("script")
    script.async = true
    script.src = "https://api.transpond.io/tracker?am=MzgyOTE%3D"

    var container = document.getElementById("__analytics")
    container.insertAdjacentElement("afterEnd", script)

  }
</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script></head><body dir=ltr data-md-color-scheme=openssl data-md-color-primary=indigo data-md-color-accent=indigo><input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off><input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off><label class=md-overlay for=__drawer></label><div data-md-component=skip><a href=#openssl-pkeyutl class=md-skip> Skip to content </a></div><div data-md-component=announce></div><div data-md-color-scheme=default data-md-component=outdated hidden></div><header class="md-header md-header--shadow md-header--lifted" data-md-component=header><nav class="md-header__inner md-grid" aria-label=Header><a href=../.. title="OpenSSL Documentation" class="md-header__button md-logo" aria-label="OpenSSL Documentation" data-md-component=logo><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg></a><label class="md-header__button md-icon" for=__drawer><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg></label><div class=md-header__title data-md-component=header-title><div class=md-header__ellipsis><div class=md-header__topic><span class=md-ellipsis> OpenSSL Documentation </span></div><div class=md-header__topic data-md-component=header-topic><span class=md-ellipsis> openssl-pkeyutl </span></div></div></div><form class=md-header__option data-md-component=palette><input class=md-option data-md-color-media data-md-color-scheme=openssl data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0><label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg></label><input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=black data-md-color-accent=light-blue aria-label="Switch to light mode" type=radio name=__palette id=__palette_1><label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg></label></form><script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script><label class="md-header__button md-icon" for=__search><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg></label><div class=md-search data-md-component=search role=dialog><label class=md-search__overlay for=__search></label><div class=md-search__inner role=search><form class=md-search__form name=search><input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required><label class="md-search__icon md-icon" for=__search><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg></label><nav class=md-search__options aria-label=Search><button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg></button></nav><div class=md-search__suggest data-md-component=search-suggest></div></form><div class=md-search__output><div class=md-search__scrollwrap tabindex=0 data-md-scrollfix><div class=md-search-result data-md-component=search-result><div class=md-search-result__meta> Initializing search </div><ol class=md-search-result__list role=presentation></ol></div></div></div></div></div><div class=md-header__source><a href=https://github.com/openssl/openssl title="Go to repository" class=md-source data-md-component=source><div class="md-source__icon md-icon"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg></div><div class=md-source__repository> GitHub </div></a></div></nav><nav class=md-tabs aria-label=Tabs data-md-component=tabs><div class=md-grid><ul class=md-tabs__list><li class=md-tabs__item><a href=../.. class=md-tabs__link> Home </a></li><li class=md-tabs__item><a href=../../fips/ class=md-tabs__link> FIPS-140 </a></li><li class="md-tabs__item md-tabs__item--active"><a href=../ class=md-tabs__link> Commands </a></li><li class=md-tabs__item><a href=../../man3/ class=md-tabs__link> Libraries </a></li><li class=md-tabs__item><a href=../../man5/ class=md-tabs__link> File Formats </a></li><li class=md-tabs__item><a href=../../man7/ class=md-tabs__link> Overviews </a></li></ul></div></nav></header><div class=md-container data-md-component=container><main class=md-main data-md-component=main><div class="md-main__inner md-grid"><div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation><div class=md-sidebar__scrollwrap><div class=md-sidebar__inner><nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0><label class=md-nav__title for=__drawer><a href=../.. title="OpenSSL Documentation" class="md-nav__button md-logo" aria-label="OpenSSL Documentation" data-md-component=logo><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg></a> OpenSSL Documentation </label><div class=md-nav__source><a href=https://github.com/openssl/openssl title="Go to repository" class=md-source data-md-component=source><div class="md-source__icon md-icon"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg></div><div class=md-source__repository> GitHub </div></a></div><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a href=../.. class=md-nav__link title=Home><span class=md-ellipsis-custom> Home </span></a></li><li class=md-nav__item><a href=../../fips/ class=md-nav__link title=FIPS-140><span class=md-ellipsis-custom> FIPS-140 </span></a></li><li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3 checked><div class="md-nav__link md-nav__container"><a href=../ class="md-nav__link "><span class=md-ellipsis-custom> Commands </span></a><label class="md-nav__link " for=__nav_3 id=__nav_3_label tabindex><span class="md-nav__icon md-icon"></span></label></div><nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=true><label class=md-nav__title for=__nav_3><span class="md-nav__icon md-icon"></span> Commands </label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a href=../CA.pl/ class=md-nav__link title=CA.pl><span class=md-ellipsis-custom> CA.pl </span></a></li><li class=md-nav__item><a href=../openssl-cmds class=md-nav__link title=asn1parse><span class=md-ellipsis-custom> asn1parse </span></a></li><li class=md-nav__item><a href=../openssl-rehash class=md-nav__link title=c_rehash><span class=md-ellipsis-custom> c_rehash </span></a></li><li class=md-nav__item><a href=../openssl-cmds class=md-nav__link title=ca><span class=md-ellipsis-custom> ca </span></a></li><li class=md-nav__item><a href=../openssl-cmds class=md-nav__link title=ciphers><span class=md-ellipsis-custom> ciphers </span></a></li><li class=md-nav__item><a href=../openssl-cmds class=md-nav__link title=cmp><span class=md-ellipsis-custom> cmp </span></a></li><li class=md-nav__item><a href=../openssl-cmds class=md-nav__link title=cms><span class=md-ellipsis-custom> cms </span></a></li><li class=md-nav__item><a href=../openssl-cmds class=md-nav__link title=crl><span class=md-ellipsis-custom> crl </span></a></li><li class=md-nav__item><a href=../openssl-cmds class=md-nav__link title=crl2pkcs7><span class=md-ellipsis-custom> crl2pkcs7 </span></a></li><li class=md-nav__item><a href=../openssl-cmds class=md-nav__link title=dgst><span class=md-ellipsis-custom> dgst </span></a></li><li class=md-nav__item><a href=../openssl-cmds class=md-nav__link title=dhparam><span class=md-ellipsis-custom> dhparam </span></a></li><li class=md-nav__item><a href=../openssl-cmds class=md-nav__link title=dsa><span class=md-ellipsis-custom> dsa </span></a></li><li class=md-nav__item><a href=../openssl-cmds class=md-nav__link title=dsaparam><span class=md-ellipsis-custom> dsaparam </span></a></li><li class=md-nav__item><a href=../openssl-cmds class=md-nav__link title=ec><span class=md-ellipsis-custom> ec </span></a></li><li class=md-nav__item><a href=../openssl-cmds class=md-nav__link title=ecparam><span class=md-ellipsis-custom> ecparam </span></a></li><li class=md-nav__item><a href=../openssl-cmds class=md-nav__link title=enc><span class=md-ellipsis-custom> enc </span></a></li><li class=md-nav__item><a href=../openssl-cmds class=md-nav__link title=engine><span class=md-ellipsis-custom> engine </span></a></li><li class=md-nav__item><a href=../openssl-cmds class=md-nav__link title=errstr><span class=md-ellipsis-custom> errstr </span></a></li><li class=md-nav__item><a href=../openssl-cmds class=md-nav__link title=gendsa><span class=md-ellipsis-custom> gendsa </span></a></li><li class=md-nav__item><a href=../openssl-cmds class=md-nav__link title=genpkey><span class=md-ellipsis-custom> genpkey </span></a></li><li class=md-nav__item><a href=../openssl-cmds class=md-nav__link title=genrsa><span class=md-ellipsis-custom> genrsa </span></a></li><li class=md-nav__item><a href=../openssl-cmds class=md-nav__link title=info><span class=md-ellipsis-custom> info </span></a></li><li class=md-nav__item><a href=../openssl-cmds class=md-nav__link title=kdf><span class=md-ellipsis-custom> kdf </span></a></li><li class=md-nav__item><a href=../openssl-cmds class=md-nav__link title=mac><span class=md-ellipsis-custom> mac </span></a></li><li class=md-nav__item><a href=../openssl-cmds class=md-nav__link title=nseq><span class=md-ellipsis-custom> nseq </span></a></li><li class=md-nav__item><a href=../openssl-cmds class=md-nav__link title=ocsp><span class=md-ellipsis-custom> ocsp </span></a></li><li class=md-nav__item><a href=../openssl/ class=md-nav__link title=openssl><span class=md-ellipsis-custom> openssl </span></a></li><li class=md-nav__item><a href=../openssl-asn1parse/ class=md-nav__link title=openssl-asn1parse><span class=md-ellipsis-custom> openssl-asn1parse </span></a></li><li class=md-nav__item><a href=../openssl-ca/ class=md-nav__link title=openssl-ca><span class=md-ellipsis-custom> openssl-ca </span></a></li><li class=md-nav__item><a href=../openssl-ciphers/ class=md-nav__link title=openssl-ciphers><span class=md-ellipsis-custom> openssl-ciphers </span></a></li><li class=md-nav__item><a href=../openssl-cmds/ class=md-nav__link title=openssl-cmds><span class=md-ellipsis-custom> openssl-cmds </span></a></li><li class=md-nav__item><a href=../openssl-cmp/ class=md-nav__link title=openssl-cmp><span class=md-ellipsis-custom> openssl-cmp </span></a></li><li class=md-nav__item><a href=../openssl-cms/ class=md-nav__link title=openssl-cms><span class=md-ellipsis-custom> openssl-cms </span></a></li><li class=md-nav__item><a href=../openssl-crl/ class=md-nav__link title=openssl-crl><span class=md-ellipsis-custom> openssl-crl </span></a></li><li class=md-nav__item><a href=../openssl-crl2pkcs7/ class=md-nav__link title=openssl-crl2pkcs7><span class=md-ellipsis-custom> openssl-crl2pkcs7 </span></a></li><li class=md-nav__item><a href=../openssl-dgst/ class=md-nav__link title=openssl-dgst><span class=md-ellipsis-custom> openssl-dgst </span></a></li><li class=md-nav__item><a href=../openssl-dhparam/ class=md-nav__link title=openssl-dhparam><span class=md-ellipsis-custom> openssl-dhparam </span></a></li><li class=md-nav__item><a href=../openssl-dsa/ class=md-nav__link title=openssl-dsa><span class=md-ellipsis-custom> openssl-dsa </span></a></li><li class=md-nav__item><a href=../openssl-dsaparam/ class=md-nav__link title=openssl-dsaparam><span class=md-ellipsis-custom> openssl-dsaparam </span></a></li><li class=md-nav__item><a href=../openssl-ec/ class=md-nav__link title=openssl-ec><span class=md-ellipsis-custom> openssl-ec </span></a></li><li class=md-nav__item><a href=../openssl-ecparam/ class=md-nav__link title=openssl-ecparam><span class=md-ellipsis-custom> openssl-ecparam </span></a></li><li class=md-nav__item><a href=../openssl-enc/ class=md-nav__link title=openssl-enc><span class=md-ellipsis-custom> openssl-enc </span></a></li><li class=md-nav__item><a href=../openssl-engine/ class=md-nav__link title=openssl-engine><span class=md-ellipsis-custom> openssl-engine </span></a></li><li class=md-nav__item><a href=../openssl-errstr/ class=md-nav__link title=openssl-errstr><span class=md-ellipsis-custom> openssl-errstr </span></a></li><li class=md-nav__item><a href=../openssl-fipsinstall/ class=md-nav__link title=openssl-fipsinstall><span class=md-ellipsis-custom> openssl-fipsinstall </span></a></li><li class=md-nav__item><a href=../openssl-format-options/ class=md-nav__link title=openssl-format-options><span class=md-ellipsis-custom> openssl-format-options </span></a></li><li class=md-nav__item><a href=../openssl-gendsa/ class=md-nav__link title=openssl-gendsa><span class=md-ellipsis-custom> openssl-gendsa </span></a></li><li class=md-nav__item><a href=../openssl-genpkey/ class=md-nav__link title=openssl-genpkey><span class=md-ellipsis-custom> openssl-genpkey </span></a></li><li class=md-nav__item><a href=../openssl-genrsa/ class=md-nav__link title=openssl-genrsa><span class=md-ellipsis-custom> openssl-genrsa </span></a></li><li class=md-nav__item><a href=../openssl-info/ class=md-nav__link title=openssl-info><span class=md-ellipsis-custom> openssl-info </span></a></li><li class=md-nav__item><a href=../openssl-kdf/ class=md-nav__link title=openssl-kdf><span class=md-ellipsis-custom> openssl-kdf </span></a></li><li class=md-nav__item><a href=../openssl-list/ class=md-nav__link title=openssl-list><span class=md-ellipsis-custom> openssl-list </span></a></li><li class=md-nav__item><a href=../openssl-mac/ class=md-nav__link title=openssl-mac><span class=md-ellipsis-custom> openssl-mac </span></a></li><li class=md-nav__item><a href=../openssl-namedisplay-options/ class=md-nav__link title=openssl-namedisplay-options><span class=md-ellipsis-custom> openssl-namedisplay-options </span></a></li><li class=md-nav__item><a href=../openssl-nseq/ class=md-nav__link title=openssl-nseq><span class=md-ellipsis-custom> openssl-nseq </span></a></li><li class=md-nav__item><a href=../openssl-ocsp/ class=md-nav__link title=openssl-ocsp><span class=md-ellipsis-custom> openssl-ocsp </span></a></li><li class=md-nav__item><a href=../openssl-passphrase-options/ class=md-nav__link title=openssl-passphrase-options><span class=md-ellipsis-custom> openssl-passphrase-options </span></a></li><li class=md-nav__item><a href=../openssl-passwd/ class=md-nav__link title=openssl-passwd><span class=md-ellipsis-custom> openssl-passwd </span></a></li><li class=md-nav__item><a href=../openssl-pkcs12/ class=md-nav__link title=openssl-pkcs12><span class=md-ellipsis-custom> openssl-pkcs12 </span></a></li><li class=md-nav__item><a href=../openssl-pkcs7/ class=md-nav__link title=openssl-pkcs7><span class=md-ellipsis-custom> openssl-pkcs7 </span></a></li><li class=md-nav__item><a href=../openssl-pkcs8/ class=md-nav__link title=openssl-pkcs8><span class=md-ellipsis-custom> openssl-pkcs8 </span></a></li><li class=md-nav__item><a href=../openssl-pkey/ class=md-nav__link title=openssl-pkey><span class=md-ellipsis-custom> openssl-pkey </span></a></li><li class=md-nav__item><a href=../openssl-pkeyparam/ class=md-nav__link title=openssl-pkeyparam><span class=md-ellipsis-custom> openssl-pkeyparam </span></a></li><li class="md-nav__item md-nav__item--active"><input class="md-nav__toggle md-toggle" type=checkbox id=__toc><label class="md-nav__link md-nav__link--active" for=__toc><span class=md-ellipsis-custom> openssl-pkeyutl </span><span class="md-nav__icon md-icon"></span></label><a href=./ class="md-nav__link md-nav__link--active"><span class=md-ellipsis-custom> openssl-pkeyutl </span></a><nav class="md-nav md-nav--secondary" aria-label="Table of contents"><label class=md-nav__title for=__toc><span class="md-nav__icon md-icon"></span> Table of contents </label><ul class=md-nav__list data-md-component=toc data-md-scrollfix><li class=md-nav__item><a href=#name class=md-nav__link><span class=md-ellipsis> NAME </span></a></li><li class=md-nav__item><a href=#synopsis class=md-nav__link><span class=md-ellipsis> SYNOPSIS </span></a></li><li class=md-nav__item><a href=#description class=md-nav__link><span class=md-ellipsis> DESCRIPTION </span></a></li><li class=md-nav__item><a href=#options class=md-nav__link><span class=md-ellipsis> OPTIONS </span></a></li><li class=md-nav__item><a href=#notes class=md-nav__link><span class=md-ellipsis> NOTES </span></a></li><li class=md-nav__item><a href=#rsa-algorithm class=md-nav__link><span class=md-ellipsis> RSA ALGORITHM </span></a></li><li class=md-nav__item><a href=#rsa-pss-algorithm class=md-nav__link><span class=md-ellipsis> RSA-PSS ALGORITHM </span></a></li><li class=md-nav__item><a href=#dsa-algorithm class=md-nav__link><span class=md-ellipsis> DSA ALGORITHM </span></a></li><li class=md-nav__item><a href=#dh-algorithm class=md-nav__link><span class=md-ellipsis> DH ALGORITHM </span></a></li><li class=md-nav__item><a href=#ec-algorithm class=md-nav__link><span class=md-ellipsis> EC ALGORITHM </span></a></li><li class=md-nav__item><a href=#x25519-and-x448-algorithms class=md-nav__link><span class=md-ellipsis> X25519 AND X448 ALGORITHMS </span></a></li><li class=md-nav__item><a href=#ed25519-and-ed448-algorithms class=md-nav__link><span class=md-ellipsis> ED25519 AND ED448 ALGORITHMS </span></a></li><li class=md-nav__item><a href=#sm2 class=md-nav__link><span class=md-ellipsis> SM2 </span></a></li><li class=md-nav__item><a href=#examples class=md-nav__link><span class=md-ellipsis> EXAMPLES </span></a></li><li class=md-nav__item><a href=#see-also class=md-nav__link><span class=md-ellipsis> SEE ALSO </span></a></li><li class=md-nav__item><a href=#history class=md-nav__link><span class=md-ellipsis> HISTORY </span></a></li><li class=md-nav__item><a href=#copyright class=md-nav__link><span class=md-ellipsis> COPYRIGHT </span></a></li></ul></nav></li><li class=md-nav__item><a href=../openssl-prime/ class=md-nav__link title=openssl-prime><span class=md-ellipsis-custom> openssl-prime </span></a></li><li class=md-nav__item><a href=../openssl-rand/ class=md-nav__link title=openssl-rand><span class=md-ellipsis-custom> openssl-rand </span></a></li><li class=md-nav__item><a href=../openssl-rehash/ class=md-nav__link title=openssl-rehash><span class=md-ellipsis-custom> openssl-rehash </span></a></li><li class=md-nav__item><a href=../openssl-req/ class=md-nav__link title=openssl-req><span class=md-ellipsis-custom> openssl-req </span></a></li><li class=md-nav__item><a href=../openssl-rsa/ class=md-nav__link title=openssl-rsa><span class=md-ellipsis-custom> openssl-rsa </span></a></li><li class=md-nav__item><a href=../openssl-rsautl/ class=md-nav__link title=openssl-rsautl><span class=md-ellipsis-custom> openssl-rsautl </span></a></li><li class=md-nav__item><a href=../openssl-s_client/ class=md-nav__link title=openssl-s_client><span class=md-ellipsis-custom> openssl-s_client </span></a></li><li class=md-nav__item><a href=../openssl-s_server/ class=md-nav__link title=openssl-s_server><span class=md-ellipsis-custom> openssl-s_server </span></a></li><li class=md-nav__item><a href=../openssl-s_time/ class=md-nav__link title=openssl-s_time><span class=md-ellipsis-custom> openssl-s_time </span></a></li><li class=md-nav__item><a href=../openssl-sess_id/ class=md-nav__link title=openssl-sess_id><span class=md-ellipsis-custom> openssl-sess_id </span></a></li><li class=md-nav__item><a href=../openssl-smime/ class=md-nav__link title=openssl-smime><span class=md-ellipsis-custom> openssl-smime </span></a></li><li class=md-nav__item><a href=../openssl-speed/ class=md-nav__link title=openssl-speed><span class=md-ellipsis-custom> openssl-speed </span></a></li><li class=md-nav__item><a href=../openssl-spkac/ class=md-nav__link title=openssl-spkac><span class=md-ellipsis-custom> openssl-spkac </span></a></li><li class=md-nav__item><a href=../openssl-srp/ class=md-nav__link title=openssl-srp><span class=md-ellipsis-custom> openssl-srp </span></a></li><li class=md-nav__item><a href=../openssl-storeutl/ class=md-nav__link title=openssl-storeutl><span class=md-ellipsis-custom> openssl-storeutl </span></a></li><li class=md-nav__item><a href=../openssl-ts/ class=md-nav__link title=openssl-ts><span class=md-ellipsis-custom> openssl-ts </span></a></li><li class=md-nav__item><a href=../openssl-verification-options/ class=md-nav__link title=openssl-verification-options><span class=md-ellipsis-custom> openssl-verification-options </span></a></li><li class=md-nav__item><a href=../openssl-verify/ class=md-nav__link title=openssl-verify><span class=md-ellipsis-custom> openssl-verify </span></a></li><li class=md-nav__item><a href=../openssl-version/ class=md-nav__link title=openssl-version><span class=md-ellipsis-custom> openssl-version </span></a></li><li class=md-nav__item><a href=../openssl-x509/ class=md-nav__link title=openssl-x509><span class=md-ellipsis-custom> openssl-x509 </span></a></li><li class=md-nav__item><a href=../openssl-cmds class=md-nav__link title=passwd><span class=md-ellipsis-custom> passwd </span></a></li><li class=md-nav__item><a href=../openssl-cmds class=md-nav__link title=pkcs12><span class=md-ellipsis-custom> pkcs12 </span></a></li><li class=md-nav__item><a href=../openssl-cmds class=md-nav__link title=pkcs7><span class=md-ellipsis-custom> pkcs7 </span></a></li><li class=md-nav__item><a href=../openssl-cmds class=md-nav__link title=pkcs8><span class=md-ellipsis-custom> pkcs8 </span></a></li><li class=md-nav__item><a href=../openssl-cmds class=md-nav__link title=pkey><span class=md-ellipsis-custom> pkey </span></a></li><li class=md-nav__item><a href=../openssl-cmds class=md-nav__link title=pkeyparam><span class=md-ellipsis-custom> pkeyparam </span></a></li><li class=md-nav__item><a href=../openssl-cmds class=md-nav__link title=pkeyutl><span class=md-ellipsis-custom> pkeyutl </span></a></li><li class=md-nav__item><a href=../openssl-cmds class=md-nav__link title=prime><span class=md-ellipsis-custom> prime </span></a></li><li class=md-nav__item><a href=../openssl-cmds class=md-nav__link title=rand><span class=md-ellipsis-custom> rand </span></a></li><li class=md-nav__item><a href=../openssl-cmds class=md-nav__link title=rehash><span class=md-ellipsis-custom> rehash </span></a></li><li class=md-nav__item><a href=../openssl-cmds class=md-nav__link title=req><span class=md-ellipsis-custom> req </span></a></li><li class=md-nav__item><a href=../openssl-cmds class=md-nav__link title=rsa><span class=md-ellipsis-custom> rsa </span></a></li><li class=md-nav__item><a href=../openssl-cmds class=md-nav__link title=rsautl><span class=md-ellipsis-custom> rsautl </span></a></li><li class=md-nav__item><a href=../openssl-cmds class=md-nav__link title=s_client><span class=md-ellipsis-custom> s_client </span></a></li><li class=md-nav__item><a href=../openssl-cmds class=md-nav__link title=s_server><span class=md-ellipsis-custom> s_server </span></a></li><li class=md-nav__item><a href=../openssl-cmds class=md-nav__link title=s_time><span class=md-ellipsis-custom> s_time </span></a></li><li class=md-nav__item><a href=../openssl-cmds class=md-nav__link title=sess_id><span class=md-ellipsis-custom> sess_id </span></a></li><li class=md-nav__item><a href=../openssl-cmds class=md-nav__link title=smime><span class=md-ellipsis-custom> smime </span></a></li><li class=md-nav__item><a href=../openssl-cmds class=md-nav__link title=speed><span class=md-ellipsis-custom> speed </span></a></li><li class=md-nav__item><a href=../openssl-cmds class=md-nav__link title=spkac><span class=md-ellipsis-custom> spkac </span></a></li><li class=md-nav__item><a href=../openssl-cmds class=md-nav__link title=srp><span class=md-ellipsis-custom> srp </span></a></li><li class=md-nav__item><a href=../openssl-cmds class=md-nav__link title=storeutl><span class=md-ellipsis-custom> storeutl </span></a></li><li class=md-nav__item><a href=../openssl-cmds class=md-nav__link title=ts><span class=md-ellipsis-custom> ts </span></a></li><li class=md-nav__item><a href=../tsget/ class=md-nav__link title=tsget><span class=md-ellipsis-custom> tsget </span></a></li><li class=md-nav__item><a href=../openssl-cmds class=md-nav__link title=verify><span class=md-ellipsis-custom> verify </span></a></li><li class=md-nav__item><a href=../openssl-cmds class=md-nav__link title=version><span class=md-ellipsis-custom> version </span></a></li><li class=md-nav__item><a href=../openssl-cmds class=md-nav__link title=x509><span class=md-ellipsis-custom> x509 </span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a href=../../man3/ class=md-nav__link><span class=md-ellipsis-custom> Libraries </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a href=../../man5/ class=md-nav__link><span class=md-ellipsis-custom> File Formats </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a href=../../man7/ class=md-nav__link><span class=md-ellipsis-custom> Overviews </span><span class="md-nav__icon md-icon"></span></a></li></ul></nav></div></div></div><div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc><div class=md-sidebar__scrollwrap><div class=md-sidebar__inner><nav class="md-nav md-nav--secondary" aria-label="Table of contents"><label class=md-nav__title for=__toc><span class="md-nav__icon md-icon"></span> Table of contents </label><ul class=md-nav__list data-md-component=toc data-md-scrollfix><li class=md-nav__item><a href=#name class=md-nav__link><span class=md-ellipsis> NAME </span></a></li><li class=md-nav__item><a href=#synopsis class=md-nav__link><span class=md-ellipsis> SYNOPSIS </span></a></li><li class=md-nav__item><a href=#description class=md-nav__link><span class=md-ellipsis> DESCRIPTION </span></a></li><li class=md-nav__item><a href=#options class=md-nav__link><span class=md-ellipsis> OPTIONS </span></a></li><li class=md-nav__item><a href=#notes class=md-nav__link><span class=md-ellipsis> NOTES </span></a></li><li class=md-nav__item><a href=#rsa-algorithm class=md-nav__link><span class=md-ellipsis> RSA ALGORITHM </span></a></li><li class=md-nav__item><a href=#rsa-pss-algorithm class=md-nav__link><span class=md-ellipsis> RSA-PSS ALGORITHM </span></a></li><li class=md-nav__item><a href=#dsa-algorithm class=md-nav__link><span class=md-ellipsis> DSA ALGORITHM </span></a></li><li class=md-nav__item><a href=#dh-algorithm class=md-nav__link><span class=md-ellipsis> DH ALGORITHM </span></a></li><li class=md-nav__item><a href=#ec-algorithm class=md-nav__link><span class=md-ellipsis> EC ALGORITHM </span></a></li><li class=md-nav__item><a href=#x25519-and-x448-algorithms class=md-nav__link><span class=md-ellipsis> X25519 AND X448 ALGORITHMS </span></a></li><li class=md-nav__item><a href=#ed25519-and-ed448-algorithms class=md-nav__link><span class=md-ellipsis> ED25519 AND ED448 ALGORITHMS </span></a></li><li class=md-nav__item><a href=#sm2 class=md-nav__link><span class=md-ellipsis> SM2 </span></a></li><li class=md-nav__item><a href=#examples class=md-nav__link><span class=md-ellipsis> EXAMPLES </span></a></li><li class=md-nav__item><a href=#see-also class=md-nav__link><span class=md-ellipsis> SEE ALSO </span></a></li><li class=md-nav__item><a href=#history class=md-nav__link><span class=md-ellipsis> HISTORY </span></a></li><li class=md-nav__item><a href=#copyright class=md-nav__link><span class=md-ellipsis> COPYRIGHT </span></a></li></ul></nav></div></div></div><div class=md-content data-md-component=content><article class="md-content__inner md-typeset"><h1 id=openssl-pkeyutl>openssl-pkeyutl<a class=headerlink href=#openssl-pkeyutl title="Permanent link">&para;</a></h1><h2 id=name>NAME<a class=headerlink href=#name title="Permanent link">&para;</a></h2><p>openssl-pkeyutl - asymmetric key command</p><h2 id=synopsis>SYNOPSIS<a class=headerlink href=#synopsis title="Permanent link">&para;</a></h2><p><strong>openssl</strong> <strong>pkeyutl</strong> [<strong>-help</strong>] [<strong>-in</strong> <em>file</em>] [<strong>-rawin</strong>] [<strong>-digest</strong> <em>algorithm</em>] [<strong>-out</strong> <em>file</em>] [<strong>-secret</strong> <em>file</em>] [<strong>-sigfile</strong> <em>file</em>] [<strong>-inkey</strong> <em>filename</em>|<em>uri</em>] [<strong>-keyform</strong> <strong>DER</strong>|<strong>PEM</strong>|<strong>P12</strong>|<strong>ENGINE</strong>] [<strong>-passin</strong> <em>arg</em>] [<strong>-pubin</strong>] [<strong>-certin</strong>] [<strong>-rev</strong>] [<strong>-sign</strong>] [<strong>-verify</strong>] [<strong>-verifyrecover</strong>] [<strong>-encrypt</strong>] [<strong>-decrypt</strong>] [<strong>-derive</strong>] [<strong>-peerkey</strong> <em>file</em>] [<strong>-peerform</strong> <strong>DER</strong>|<strong>PEM</strong>|<strong>P12</strong>|<strong>ENGINE</strong>] [<strong>-encap</strong>] [<strong>-decap</strong>] [<strong>-kdf</strong> <em>algorithm</em>] [<strong>-kdflen</strong> <em>length</em>] [<strong>-kemop</strong> <em>operation</em>] [<strong>-pkeyopt</strong> <em>opt</em>:<em>value</em>] [<strong>-pkeyopt_passin</strong> <em>opt</em>[:<em>passarg</em>]] [<strong>-hexdump</strong>] [<strong>-asn1parse</strong>] [<strong>-engine</strong> <em>id</em>] [<strong>-engine_impl</strong>] [<strong>-rand</strong> <em>files</em>] [<strong>-writerand</strong> <em>file</em>] [<strong>-provider</strong> <em>name</em>] [<strong>-provider-path</strong> <em>path</em>] [<strong>-propquery</strong> <em>propq</em>] [<strong>-config</strong> <em>configfile</em>]</p><h2 id=description>DESCRIPTION<a class=headerlink href=#description title="Permanent link">&para;</a></h2><p>This command can be used to perform low-level operations on asymmetric (public or private) keys using any supported algorithm.</p><p>By default the signing operation (see <strong>-sign</strong> option) is assumed.</p><h2 id=options>OPTIONS<a class=headerlink href=#options title="Permanent link">&para;</a></h2><ul><li><p><strong>-help</strong></p><p>Print out a usage message.</p></li><li><p><strong>-in</strong> <em>filename</em></p><p>This specifies the input filename to read data from or standard input if this option is not specified.</p></li><li><p><strong>-rawin</strong></p><p>This indicates that the signature or verification input data is raw data, which is not hashed by any message digest algorithm. Except with EdDSA, the user can specify a digest algorithm by using the <strong>-digest</strong> option. For signature algorithms like RSA, DSA and ECDSA, the default digest algorithm is SHA256. For SM2, it is SM3.</p><p>This option can only be used with <strong>-sign</strong> and <strong>-verify</strong>. For EdDSA (the Ed25519 and Ed448 algorithms) this option is required.</p></li><li><p><strong>-digest</strong> <em>algorithm</em></p><p>This option can only be used with <strong>-sign</strong> and <strong>-verify</strong>. It specifies the digest algorithm that is used to hash the input data before signing or verifying it with the input key. This option could be omitted if the signature algorithm does not require preprocessing the input through a pluggable hash function before signing (for instance, EdDSA). If this option is omitted but the signature algorithm requires one and the <strong>-rawin</strong> option is given, a default value will be used (see <strong>-rawin</strong> for details). If this option is present, then the <strong>-rawin</strong> option is required.</p><p>At this time, HashEdDSA (the ph or &quot;prehash&quot; variant of EdDSA) is not supported, so the <strong>-digest</strong> option cannot be used with EdDSA.</p></li><li><p><strong>-out</strong> <em>filename</em></p><p>Specifies the output filename to write to or standard output by default.</p></li><li><p><strong>-secret</strong> <em>filename</em></p><p>Specifies the output filename to write the secret to on <em>-encap</em>.</p></li><li><p><strong>-sigfile</strong> <em>file</em></p><p>Signature file, required and allowed for <strong>-verify</strong> operations only.</p></li><li><p><strong>-inkey</strong> <em>filename</em>|<em>uri</em></p><p>The input key, by default it should be a private key.</p></li><li><p><strong>-keyform</strong> <strong>DER</strong>|<strong>PEM</strong>|<strong>P12</strong>|<strong>ENGINE</strong></p><p>The key format; unspecified by default. See <a href=../openssl-format-options/ >openssl-format-options(1)</a> for details.</p></li><li><p><strong>-passin</strong> <em>arg</em></p><p>The input key password source. For more information about the format of <em>arg</em> see <a href=../openssl-passphrase-options/ >openssl-passphrase-options(1)</a>.</p></li><li><p><strong>-pubin</strong></p><p>By default a private key is read from the key input. With this option a public key is read instead. If the input contains no public key but a private key, its public part is used.</p></li><li><p><strong>-certin</strong></p><p>The input is a certificate containing a public key.</p></li><li><p><strong>-rev</strong></p><p>Reverse the order of the input buffer. This is useful for some libraries (such as CryptoAPI) which represent the buffer in little-endian format. This cannot be used in conjunction with <strong>-rawin</strong>.</p></li><li><p><strong>-sign</strong></p><p>Sign the input data and output the signed result. This requires a private key. Using a message digest operation along with this is recommended, when applicable, see the <strong>-rawin</strong> and <strong>-digest</strong> options for details. Otherwise, the input data given with the <strong>-in</strong> option is assumed to already be a digest, but this may then require an additional <strong>-pkeyopt</strong> <code>digest:</code><em>md</em> in some cases (e.g., RSA with the default PKCS#1 padding mode). Even for other algorithms like ECDSA, where the additional <strong>-pkeyopt</strong> option does not affect signature output, it is recommended, as it enables checking that the input length is consistent with the intended digest.</p></li><li><p><strong>-verify</strong></p><p>Verify the input data against the signature given with the <strong>-sigfile</strong> option and indicate if the verification succeeded or failed. The input data given with the <strong>-in</strong> option is assumed to be a hash value unless the <strong>-rawin</strong> option is specified or implied. With raw data, when a digest algorithm is applicable, though it may be inferred from the signature or take a default value, it should also be specified.</p></li><li><p><strong>-verifyrecover</strong></p><p>Verify the given signature and output the recovered data (signature payload). For example, in case of RSA PKCS#1 the recovered data is the <strong>EMSA-PKCS-v1_5</strong> DER encoding of the digest algorithm OID and value as specified in <a href=https://datatracker.ietf.org/doc/html/rfc8017#section-9.2>RFC8017 Section 9.2</a>.</p><p>Note that here the input given with the <strong>-in</strong> option is not a signature input (as with the <strong>-sign</strong> and <strong>-verify</strong> options) but a signature output value, typically produced using the <strong>-sign</strong> option.</p><p>This option is available only for use with RSA keys.</p></li><li><p><strong>-encrypt</strong></p><p>Encrypt the input data using a public key.</p></li><li><p><strong>-decrypt</strong></p><p>Decrypt the input data using a private key.</p></li><li><p><strong>-derive</strong></p><p>Derive a shared secret using own private (EC)DH key and peer key.</p></li><li><p><strong>-peerkey</strong> <em>file</em></p><p>File containing the peer public or private (EC)DH key to use with the key derivation (agreement) operation. Its type must match the type of the own private key given with <strong>-inkey</strong>.</p></li><li><p><strong>-peerform</strong> <strong>DER</strong>|<strong>PEM</strong>|<strong>P12</strong>|<strong>ENGINE</strong></p><p>The peer key format; unspecified by default. See <a href=../openssl-format-options/ >openssl-format-options(1)</a> for details.</p></li><li><p><strong>-encap</strong></p><p>Encapsulate a generated secret using a private key. The encapsulated result (binary data) is written to standard output by default, or else to the file specified with <em>-out</em>. The <em>-secret</em> option must also be provided to specify the output file for the secret value generated in the encapsulation process.</p></li><li><p><strong>-decap</strong></p><p>Decapsulate the secret using a private key. The result (binary data) is written to standard output by default, or else to the file specified with <em>-out</em>.</p></li><li><p><strong>-kemop</strong> <em>operation</em></p><p>This option is used for <em>-encap</em>/<em>-decap</em> commands and specifies the KEM operation specific for the key algorithm when there is no default KEM operation. If the algorithm has the default KEM operation, this option can be omitted.</p><p>See <a href=../../man3/EVP_PKEY_CTX_ctrl/ >EVP_PKEY_CTX_set_kem_op(3)</a> and algorithm-specific KEM documentation e.g. <a href=../../man7/EVP_KEM-RSA/ >EVP_KEM-RSA(7)</a>, <a href=../../man7/EVP_KEM-EC/ >EVP_KEM-EC(7)</a>, <a href=../../man7/EVP_KEM-X25519/ >EVP_KEM-X25519(7)</a>, and <a href=../../man7/EVP_KEM-X25519/ >EVP_KEM-X448(7)</a>.</p></li><li><p><strong>-kdf</strong> <em>algorithm</em></p><p>Use key derivation function <em>algorithm</em>. The supported algorithms are at present <strong>TLS1-PRF</strong> and <strong>HKDF</strong>. Note: additional parameters and the KDF output length will normally have to be set for this to work. See <a href=../../man3/EVP_PKEY_CTX_set_hkdf_md/ >EVP_PKEY_CTX_set_hkdf_md(3)</a> and <a href=../../man3/EVP_PKEY_CTX_set_tls1_prf_md/ >EVP_PKEY_CTX_set_tls1_prf_md(3)</a> for the supported string parameters of each algorithm.</p></li><li><p><strong>-kdflen</strong> <em>length</em></p><p>Set the output length for KDF.</p></li><li><p><strong>-pkeyopt</strong> <em>opt</em>:<em>value</em></p><p>Public key options specified as opt:value. See NOTES below for more details.</p></li><li><p><strong>-pkeyopt_passin</strong> <em>opt</em>[:<em>passarg</em>]</p><p>Allows reading a public key option <em>opt</em> from stdin or a password source. If only <em>opt</em> is specified, the user will be prompted to enter a password on stdin. Alternatively, <em>passarg</em> can be specified which can be any value supported by <a href=../openssl-passphrase-options/ >openssl-passphrase-options(1)</a>.</p></li><li><p><strong>-hexdump</strong></p><p>hex dump the output data.</p></li><li><p><strong>-asn1parse</strong></p><p>Parse the ASN.1 output data to check its DER encoding and print any errors. When combined with the <strong>-verifyrecover</strong> option, this may be useful in case an ASN.1 DER-encoded structure had been signed directly (without hashing it) and when checking a signature in PKCS#1 v1.5 format, which has a DER encoding.</p></li><li><p><strong>-engine</strong> <em>id</em></p><p>See <a href=../openssl/ >&quot;Engine Options&quot; in openssl(1)</a>. This option is deprecated.</p></li><li><p><strong>-engine_impl</strong></p><p>When used with the <strong>-engine</strong> option, it specifies to also use engine <em>id</em> for crypto operations.</p></li><li><p><strong>-rand</strong> <em>files</em>, <strong>-writerand</strong> <em>file</em></p><p>See <a href=../openssl/ >&quot;Random State Options&quot; in openssl(1)</a> for details.</p></li><li><p><strong>-provider</strong> <em>name</em></p></li><li><strong>-provider-path</strong> <em>path</em></li><li><p><strong>-propquery</strong> <em>propq</em></p><p>See <a href=../openssl/ >&quot;Provider Options&quot; in openssl(1)</a>, <a href=../../man7/provider/ >provider(7)</a>, and <a href=../../man7/property/ >property(7)</a>.</p></li><li><p><strong>-config</strong> <em>configfile</em></p><p>See <a href=../openssl/ >&quot;Configuration Option&quot; in openssl(1)</a>.</p></li></ul><h2 id=notes>NOTES<a class=headerlink href=#notes title="Permanent link">&para;</a></h2><p>The operations and options supported vary according to the key algorithm and its implementation. The OpenSSL operations and options are indicated below.</p><p>Unless otherwise mentioned, the <strong>-pkeyopt</strong> option supports for all public-key types the <code>digest:</code><em>alg</em> argument, which specifies the digest in use for the signing and verification operations. The value <em>alg</em> should represent a digest name as used in the EVP_get_digestbyname() function for example <strong>sha256</strong>. This value is not used to hash the input data. It is used (by some algorithms) for sanity-checking the lengths of data passed in and for creating the structures that make up the signature (e.g., <strong>DigestInfo</strong> in RSASSA PKCS#1 v1.5 signatures).</p><p>For instance, if the value of the <strong>-pkeyopt</strong> option <code>digest</code> argument is <strong>sha256</strong>, the signature or verification input should be the 32 bytes long binary value of the SHA256 hash function output.</p><p>Unless <strong>-rawin</strong> is used or implied, this command does not hash the input data but rather it will use the data directly as input to the signature algorithm. Depending on the key type, signature type, and mode of padding, the maximum sensible lengths of input data differ. With RSA the signed data cannot be longer than the key modulus. In case of ECDSA and DSA the data should not be longer than the field size, otherwise it will be silently truncated to the field size. In any event the input size must not be larger than the largest supported digest output size <strong>EVP_MAX_MD_SIZE</strong>, which currently is 64 bytes.</p><h2 id=rsa-algorithm>RSA ALGORITHM<a class=headerlink href=#rsa-algorithm title="Permanent link">&para;</a></h2><p>The RSA algorithm generally supports the encrypt, decrypt, sign, verify and verifyrecover operations. However, some padding modes support only a subset of these operations. The following additional <strong>pkeyopt</strong> values are supported:</p><ul><li><p><strong>rsa_padding_mode:</strong><em>mode</em></p><p>This sets the RSA padding mode. Acceptable values for <em>mode</em> are <strong>pkcs1</strong> for PKCS#1 padding, <strong>none</strong> for no padding, <strong>oaep</strong> for <strong>OAEP</strong> mode, <strong>x931</strong> for X9.31 mode and <strong>pss</strong> for PSS.</p><p>In PKCS#1 padding, if the message digest is not set, then the supplied data is signed or verified directly instead of using a <strong>DigestInfo</strong> structure. If a digest is set, then the <strong>DigestInfo</strong> structure is used and its length must correspond to the digest type.</p><p>Note, for <strong>pkcs1</strong> padding, as a protection against the Bleichenbacher attack, the decryption will not fail in case of padding check failures. Use <strong>none</strong> and manual inspection of the decrypted message to verify if the decrypted value has correct PKCS#1 v1.5 padding.</p><p>For <strong>oaep</strong> mode only encryption and decryption is supported.</p><p>For <strong>x931</strong> if the digest type is set it is used to format the block data otherwise the first byte is used to specify the X9.31 digest ID. Sign, verify and verifyrecover are can be performed in this mode.</p><p>For <strong>pss</strong> mode only sign and verify are supported and the digest type must be specified.</p></li><li><p><strong>rsa_pss_saltlen:</strong><em>len</em></p><p>For <strong>pss</strong> mode only this option specifies the salt length. Three special values are supported: <strong>digest</strong> sets the salt length to the digest length, <strong>max</strong> sets the salt length to the maximum permissible value. When verifying <strong>auto</strong> causes the salt length to be automatically determined based on the <strong>PSS</strong> block structure.</p></li><li><p><strong>rsa_mgf1_md:</strong><em>digest</em></p><p>For PSS and OAEP padding sets the MGF1 digest. If the MGF1 digest is not explicitly set in PSS mode then the signing digest is used.</p></li><li><p><strong>rsa_oaep_md:</strong><em>digest</em></p><p>Sets the digest used for the OAEP hash function. If not explicitly set then SHA256 is used.</p></li><li><p><strong>rsa_pkcs1_implicit_rejection:</strong><em>flag</em></p><p>Disables (when set to 0) or enables (when set to 1) the use of implicit rejection with PKCS#1 v1.5 decryption. When enabled (the default), as a protection against Bleichenbacher attack, the library will generate a deterministic random plaintext that it will return to the caller in case of padding check failure. When disabled, it&#39;s the callers&#39; responsibility to handle the returned errors in a side-channel free manner.</p></li></ul><h2 id=rsa-pss-algorithm>RSA-PSS ALGORITHM<a class=headerlink href=#rsa-pss-algorithm title="Permanent link">&para;</a></h2><p>The RSA-PSS algorithm is a restricted version of the RSA algorithm which only supports the sign and verify operations with PSS padding. The following additional <strong>-pkeyopt</strong> values are supported:</p><ul><li><p><strong>rsa_padding_mode:</strong><em>mode</em>, <strong>rsa_pss_saltlen:</strong><em>len</em>, <strong>rsa_mgf1_md:</strong><em>digest</em></p><p>These have the same meaning as the <strong>RSA</strong> algorithm with some additional restrictions. The padding mode can only be set to <strong>pss</strong> which is the default value.</p><p>If the key has parameter restrictions then the digest, MGF1 digest and salt length are set to the values specified in the parameters. The digest and MG cannot be changed and the salt length cannot be set to a value less than the minimum restriction.</p></li></ul><h2 id=dsa-algorithm>DSA ALGORITHM<a class=headerlink href=#dsa-algorithm title="Permanent link">&para;</a></h2><p>The DSA algorithm supports signing and verification operations only. Currently there are no additional <strong>-pkeyopt</strong> options other than <strong>digest</strong>. The SHA256 digest is assumed by default.</p><h2 id=dh-algorithm>DH ALGORITHM<a class=headerlink href=#dh-algorithm title="Permanent link">&para;</a></h2><p>The DH algorithm only supports the derivation operation and no additional <strong>-pkeyopt</strong> options.</p><h2 id=ec-algorithm>EC ALGORITHM<a class=headerlink href=#ec-algorithm title="Permanent link">&para;</a></h2><p>The EC algorithm supports sign, verify and derive operations. The sign and verify operations use ECDSA and derive uses ECDH. SHA256 is assumed by default for the <strong>-pkeyopt</strong> <strong>digest</strong> option.</p><h2 id=x25519-and-x448-algorithms>X25519 AND X448 ALGORITHMS<a class=headerlink href=#x25519-and-x448-algorithms title="Permanent link">&para;</a></h2><p>The X25519 and X448 algorithms support key derivation only. Currently there are no additional options.</p><h2 id=ed25519-and-ed448-algorithms>ED25519 AND ED448 ALGORITHMS<a class=headerlink href=#ed25519-and-ed448-algorithms title="Permanent link">&para;</a></h2><p>These algorithms only support signing and verifying. OpenSSL only implements the &quot;pure&quot; variants of these algorithms so raw data can be passed directly to them without hashing them first. OpenSSL only supports &quot;oneshot&quot; operation with these algorithms. This means that the entire file to be signed/verified must be read into memory before processing it. Signing or Verifying very large files should be avoided. Additionally the size of the file must be known for this to work. If the size of the file cannot be determined (for example if the input is stdin) then the sign or verify operation will fail.</p><h2 id=sm2>SM2<a class=headerlink href=#sm2 title="Permanent link">&para;</a></h2><p>The SM2 algorithm supports sign, verify, encrypt and decrypt operations. For the sign and verify operations, SM2 requires an Distinguishing ID string to be passed in. The following <strong>-pkeyopt</strong> value is supported:</p><ul><li><p><strong>distid:</strong><em>string</em></p><p>This sets the ID string used in SM2 sign or verify operations. While verifying an SM2 signature, the ID string must be the same one used when signing the data. Otherwise the verification will fail.</p></li><li><p><strong>hexdistid:</strong><em>hex_string</em></p><p>This sets the ID string used in SM2 sign or verify operations. While verifying an SM2 signature, the ID string must be the same one used when signing the data. Otherwise the verification will fail. The ID string provided with this option should be a valid hexadecimal value.</p></li></ul><h2 id=examples>EXAMPLES<a class=headerlink href=#examples title="Permanent link">&para;</a></h2><p>Sign some data using a private key:</p><div class=highlight><pre><span></span><code>openssl pkeyutl -sign -in file -inkey key.pem -out sig
</code></pre></div><p>Recover the signed data (e.g. if an RSA key is used):</p><div class=highlight><pre><span></span><code>openssl pkeyutl -verifyrecover -in sig -inkey key.pem
</code></pre></div><p>Verify the signature (e.g. a DSA key):</p><div class=highlight><pre><span></span><code>openssl pkeyutl -verify -in file -sigfile sig -inkey key.pem
</code></pre></div><p>Sign data using a message digest value (this is currently only valid for RSA):</p><div class=highlight><pre><span></span><code>openssl pkeyutl -sign -in file -inkey key.pem -out sig -pkeyopt digest:sha256
</code></pre></div><p>Derive a shared secret value:</p><div class=highlight><pre><span></span><code>openssl pkeyutl -derive -inkey key.pem -peerkey pubkey.pem -out secret
</code></pre></div><p>Hexdump 48 bytes of TLS1 PRF using digest <strong>SHA256</strong> and shared secret and seed consisting of the single byte 0xFF:</p><div class=highlight><pre><span></span><code>openssl pkeyutl -kdf TLS1-PRF -kdflen 48 -pkeyopt md:SHA256 \
   -pkeyopt hexsecret:ff -pkeyopt hexseed:ff -hexdump
</code></pre></div><p>Derive a key using <strong>scrypt</strong> where the password is read from command line:</p><div class=highlight><pre><span></span><code>openssl pkeyutl -kdf scrypt -kdflen 16 -pkeyopt_passin pass \
   -pkeyopt hexsalt:aabbcc -pkeyopt N:16384 -pkeyopt r:8 -pkeyopt p:1
</code></pre></div><p>Derive using the same algorithm, but read key from environment variable MYPASS:</p><div class=highlight><pre><span></span><code>openssl pkeyutl -kdf scrypt -kdflen 16 -pkeyopt_passin pass:env:MYPASS \
   -pkeyopt hexsalt:aabbcc -pkeyopt N:16384 -pkeyopt r:8 -pkeyopt p:1
</code></pre></div><p>Sign some data using an <a href=../../man7/EVP_PKEY-SM2/ >SM2(7)</a> private key and a specific ID:</p><div class=highlight><pre><span></span><code>openssl pkeyutl -sign -in file -inkey sm2.key -out sig -rawin -digest sm3 \
   -pkeyopt distid:someid
</code></pre></div><p>Verify some data using an <a href=../../man7/EVP_PKEY-SM2/ >SM2(7)</a> certificate and a specific ID:</p><div class=highlight><pre><span></span><code>openssl pkeyutl -verify -certin -in file -inkey sm2.cert -sigfile sig \
   -rawin -digest sm3 -pkeyopt distid:someid
</code></pre></div><p>Decrypt some data using a private key with OAEP padding using SHA256:</p><div class=highlight><pre><span></span><code>openssl pkeyutl -decrypt -in file -inkey key.pem -out secret \
   -pkeyopt rsa_padding_mode:oaep -pkeyopt rsa_oaep_md:sha256
</code></pre></div><h2 id=see-also>SEE ALSO<a class=headerlink href=#see-also title="Permanent link">&para;</a></h2><p><a href=../openssl/ >openssl(1)</a>, <a href=../openssl-genpkey/ >openssl-genpkey(1)</a>, <a href=../openssl-pkey/ >openssl-pkey(1)</a>, <a href=../openssl-rsautl/ >openssl-rsautl(1)</a><a href=../openssl-dgst/ >openssl-dgst(1)</a>, <a href=../openssl-rsa/ >openssl-rsa(1)</a>, <a href=../openssl-genrsa/ >openssl-genrsa(1)</a>, <a href=../openssl-kdf/ >openssl-kdf(1)</a><a href=../../man3/EVP_PKEY_CTX_set_hkdf_md/ >EVP_PKEY_CTX_set_hkdf_md(3)</a>, <a href=../../man3/EVP_PKEY_CTX_set_tls1_prf_md/ >EVP_PKEY_CTX_set_tls1_prf_md(3)</a>,</p><h2 id=history>HISTORY<a class=headerlink href=#history title="Permanent link">&para;</a></h2><p>The <strong>-engine</strong> option was deprecated in OpenSSL 3.0.</p><h2 id=copyright>COPYRIGHT<a class=headerlink href=#copyright title="Permanent link">&para;</a></h2><p>Copyright 2006-2025 The OpenSSL Project Authors. All Rights Reserved.</p><p>Licensed under the Apache License 2.0 (the &quot;License&quot;). You may not use this file except in compliance with the License. You can obtain a copy in the file LICENSE in the source distribution or at <a href=https://www.openssl.org/source/license.html>https://www.openssl.org/source/license.html</a>.</p></article></div><script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script></div></main><footer class=md-footer><div class="md-footer-meta md-typeset"><div class="md-footer-meta__inner md-grid"><div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a></div></div></div></footer></div><div class=md-dialog data-md-component=dialog><div class="md-dialog__inner md-typeset"></div></div><script id=__config type=application/json>{"base": "../..", "features": ["navigation.indexes", "navigation.instant", "navigation.path", "navigation.prune", "navigation.tabs", "navigation.tabs.sticky", "navigation.tracking", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "master", "provider": "mike"}}</script><script src=../../assets/javascripts/bundle.ad660dcc.min.js></script></body></html>